<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API reference - Ghidralib</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API reference";
        var mkdocs_page_input_path = "reference.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Ghidralib
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Ghidralib</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../compatibility/">Compatibility</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">API reference</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Ghidralib</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API reference</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-reference">API reference</h1>


<div class="doc doc-object doc-module">



<h1 id="ghidralib" class="doc doc-heading">
            <code>ghidralib</code>


</h1>

    <div class="doc doc-contents first">

        <p>This library is an attempt to provide a Pythonic standard library for Ghidra.</p>
<p>The main goal is to make writing quick&amp;dirty scripts actually quick, and not that dirty.</p>
<p>There is no equivalent of FlatProgramAPI from GHidra. You are expected to start
by getting an object of interest by calling instance methods, for example</p>
<pre><code>&gt;&gt;&gt; Function("main")
main
</code></pre>
<p>to get a function called "main". When you want to do something this library
doesn't support (yet), you can always excape back to Ghidra's wrapped Java
types, by getting a <code>.raw</code> property, for example:</p>
<pre><code>&gt;&gt;&gt; Function("main").raw.UNKNOWN_STACK_DEPTH_CHANGE
2147483647
</code></pre>
<p>For more details, see the documentation at https://msm-code.github.io/ghidralib/.</p>








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.Addr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Addr</span> <span class="o">=</span> <span class="n">GenericAddress</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.DataT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DataT</span> <span class="o">=</span> <span class="n">GhidraWrapper</span> <span class="o">|</span> <span class="n">JavaObject</span> <span class="o">|</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.HIGHLIGHT_COLOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">HIGHLIGHT_COLOR</span> <span class="o">=</span> <span class="n">SearchConstants</span><span class="o">.</span><span class="n">SEARCH_HIGHLIGHT_COLOR</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.Reg" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Reg</span> <span class="o">=</span> <span class="n">GhRegister</span> <span class="o">|</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.Str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Str</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.T" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.__version__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.2.0&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">bytes</span> <span class="o">=</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.interpreter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interpreter</span> <span class="o">=</span> <span class="n">get_current_interpreter</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ghidralib.long" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">long</span> <span class="o">=</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="ghidralib.AddressRange" class="doc doc-heading">
            <code>AddressRange</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra AddressRange object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AddressRange</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra AddressRange object.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the addresses in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddresses</span><span class="p">(</span><span class="kc">True</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Iterator[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the addresses in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first address in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMinAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last address in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMaxAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLength</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.</span>

<span class="sd">        :param addr: address to check&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.</span>
<span class="sd">        :param addr: address to check&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this range is empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this range is not empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressRange) -&gt; AddressRange</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersection of this range and the given range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressRange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressRange.addresses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">addresses</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the addresses in this range.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressRange.end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the last address in this range.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressRange.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this range is empty.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressRange.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this range.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressRange.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the first address in this range.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.__and__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__and__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the intersection of this range and the given range.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressRange) -&gt; AddressRange</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection of this range and the given range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressRange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the given address is in this range.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>address to check</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.</span>
<span class="sd">    :param addr: address to check&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over the addresses in this range.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Iterator[int]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the addresses in this range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this range.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the length of this range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.__nonzero__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__nonzero__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this range is not empty.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if this range is not empty.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressRange.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the given address is in this range.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>address to check</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.</span>

<span class="sd">    :param addr: address to check&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.AddressSet" class="doc doc-heading">
            <code>AddressSet</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra AddressSetView object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AddressSet</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra AddressSetView object.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">empty</span><span class="p">():</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new empty address set&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">GhAddressSet</span><span class="p">())</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new AddressSet with given address and length.&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">GhAddressSet</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the addresses in this set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddresses</span><span class="p">(</span><span class="kc">True</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ranges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[AddressRange]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">AddressRange</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">iterator</span><span class="p">(</span><span class="kc">True</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Iterator[int]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this range is empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this range is not empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersection of this set and the given set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Subtract the given set from this set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the symmetric difference of this set and the given set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the union of this set and the given set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__get_highlighter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Any</span>
        <span class="n">tool</span> <span class="o">=</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">getTool</span><span class="p">()</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">ColorizingService</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot highlight without the ColorizingService&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">service</span>

    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
        <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_highlighter</span><span class="p">()</span>
        <span class="n">service</span><span class="o">.</span><span class="n">setBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unhighlight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
        <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_highlighter</span><span class="p">()</span>
        <span class="n">service</span><span class="o">.</span><span class="n">clearBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressSet.addresses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">addresses</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the addresses in this set.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressSet.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this range is empty.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.AddressSet.ranges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ranges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__and__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__and__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the intersection of this set and the given set.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection of this set and the given set.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the given address is in this range.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__get_highlighter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__get_highlighter</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__get_highlighter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Any</span>
    <span class="n">tool</span> <span class="o">=</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">getTool</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">ColorizingService</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot highlight without the ColorizingService&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">service</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1908</span>
<span class="normal">1909</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Iterator[int]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__nonzero__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__nonzero__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this range is not empty.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if this range is not empty.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__or__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__or__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the union of this set and the given set.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the union of this set and the given set.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__sub__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__sub__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Subtract the given set from this set.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Subtract the given set from this set.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.__xor__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__xor__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the symmetric difference of this set and the given set.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (AddressSet) -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the symmetric difference of this set and the given set.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the given address is in this range.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given address is in this range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new AddressSet with given address and length.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new AddressSet with given address and length.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">GhAddressSet</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">empty</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new empty address set</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">empty</span><span class="p">():</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new empty address set&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">GhAddressSet</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.highlight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">highlight</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
    <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_highlighter</span><span class="p">()</span>
    <span class="n">service</span><span class="o">.</span><span class="n">setBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.AddressSet.unhighlight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unhighlight</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unhighlight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
    <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_highlighter</span><span class="p">()</span>
    <span class="n">service</span><span class="o">.</span><span class="n">clearBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.BasicBlock" class="doc doc-heading">
            <code>BasicBlock</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.AddressSet" href="#ghidralib.AddressSet">AddressSet</a></code>, <code><a class="autorefs autorefs-internal" title="ghidralib.BodyTrait" href="#ghidralib.BodyTrait">BodyTrait</a></code></p>


        <p>Wraps a Ghidra CodeBlock object</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BasicBlock</span><span class="p">(</span><span class="n">AddressSet</span><span class="p">,</span> <span class="n">BodyTrait</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra CodeBlock object&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_model</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; Callable[[JavaObject], JavaObject]</span>
        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;basic&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BasicBlockModel</span>
        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SimpleBlockModel</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported model type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">model</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
        <span class="n">raw_or_address</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span>
    <span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr, str) -&gt; BasicBlock|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a BasicBlock object containing the given address, or return None.</span>

<span class="sd">        This function is tolerant and will accept different types of arguments:</span>
<span class="sd">        * address as int</span>
<span class="sd">        * Address object</span>
<span class="sd">        * symbol as string (will be resolved)</span>
<span class="sd">        * BasicBlock object (wrapped or unwrapped)</span>

<span class="sd">        :param raw_or_address: find basicblock that contains the given address.</span>
<span class="sd">        :param model: Ghidra supports different types of basic block &quot;models&quot;.</span>
<span class="sd">        Supported options are &quot;basic&quot; and &quot;simple&quot;.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">raw_or_address</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">raw_or_address</span><span class="p">):</span>
            <span class="n">block_model</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">model</span><span class="p">)(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">raw_or_address</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">block_model</span><span class="o">.</span><span class="n">getFirstCodeBlockContaining</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">raw_or_address</span>
        <span class="k">return</span> <span class="n">BasicBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; list[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of all basic blocks in the program.&quot;&quot;&quot;</span>
        <span class="n">block_model</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">model</span><span class="p">)(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">BasicBlock</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">block_model</span><span class="o">.</span><span class="n">getCodeBlocks</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of this basic block.</span>

<span class="sd">        Return the symbol at the start of this basic block, if any. Otherwise,</span>
<span class="sd">        return the address of the first instruction as string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of the first instruction in this basic block.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_address</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of the first instruction in this basic block.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMinAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">end_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of the last byte in this basic block.</span>

<span class="sd">        Note: this is not the address of the last instruction.</span>
<span class="sd">        Note: end_address - start_address is equal to length - 1. For example,</span>
<span class="sd">        for one-byte basic block, start_address == end_address.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMaxAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this basic block in bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_address</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_address</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bytes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bytes of this basic block.</span>

<span class="sd">        :return: bytes of this basic block.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">read_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of instructions in this basic block.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">instruction</span> <span class="o">=</span> <span class="n">getInstructionAt</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_address</span><span class="p">))</span>
        <span class="k">while</span> <span class="n">instruction</span> <span class="ow">and</span> <span class="n">instruction</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_address</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Instruction</span><span class="p">(</span><span class="n">instruction</span><span class="p">))</span>
            <span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span><span class="o">.</span><span class="n">getNext</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of Pcode operations that this basic block was parsed to&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructions</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">pcode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of basic blocks that this basic block jumps to&quot;&quot;&quot;</span>
        <span class="n">raw_refs</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDestinations</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">BasicBlock</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">getDestinationBlock</span><span class="p">())</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_refs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of basic blocks that jump to this basic block&quot;&quot;&quot;</span>
        <span class="n">raw_refs</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSources</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">BasicBlock</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">getSourceBlock</span><span class="p">())</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_refs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address set of this basic block</span>

<span class="sd">        Technically BasicBlock (CodeBlock) is is already an AddressSet,</span>
<span class="sd">        but I think this is a useful distinction to keep.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flow_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; FlowType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the flow type of this basic block.</span>

<span class="sd">        In other words, if any weird things with control flow are happening</span>
<span class="sd">        in this node.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FlowType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFlowType</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare two basic blocks for equality.</span>

<span class="sd">        Apparently Ghidra doesn&#39;t know how to do this&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasicBlock</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># This is not fully correct, but more correct than the default.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">address</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of the first instruction in this basic block.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address set of this basic block</p>
<p>Technically BasicBlock (CodeBlock) is is already an AddressSet,
but I think this is a useful distinction to keep.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">bytes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the bytes of this basic block.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>bytes of this basic block.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.destinations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destinations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of basic blocks that this basic block jumps to</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.end_address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of the last byte in this basic block.</p>
<p>Note: this is not the address of the last instruction.
Note: end_address - start_address is equal to length - 1. For example,
for one-byte basic block, start_address == end_address.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.flow_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flow_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the flow type of this basic block.</p>
<p>In other words, if any weird things with control flow are happening
in this node.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instructions</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of instructions in this basic block.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this basic block in bytes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of this basic block.</p>
<p>Return the symbol at the start of this basic block, if any. Otherwise,
return the address of the first instruction as string.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of Pcode operations that this basic block was parsed to</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.sources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sources</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of basic blocks that jump to this basic block</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BasicBlock.start_address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of the first instruction in this basic block.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.BasicBlock.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compare two basic blocks for equality.</p>
<p>Apparently Ghidra doesn't know how to do this</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two basic blocks for equality.</span>

<span class="sd">    Apparently Ghidra doesn&#39;t know how to do this&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasicBlock</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># This is not fully correct, but more correct than the default.</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">address</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.BasicBlock.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of all basic blocks in the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; list[BasicBlock]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of all basic blocks in the program.&quot;&quot;&quot;</span>
    <span class="n">block_model</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">model</span><span class="p">)(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">BasicBlock</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">block_model</span><span class="o">.</span><span class="n">getCodeBlocks</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.BasicBlock.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">raw_or_address</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a BasicBlock object containing the given address, or return None.</p>
<p>This function is tolerant and will accept different types of arguments:
* address as int
* Address object
* symbol as string (will be resolved)
* BasicBlock object (wrapped or unwrapped)</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>raw_or_address</code></b>
              –
              <div class="doc-md-description">
                <p>find basicblock that contains the given address.</p>
              </div>
            </li>
            <li>
              <b><code>model</code></b>
              –
              <div class="doc-md-description">
                <p>Ghidra supports different types of basic block "models". Supported options are "basic" and "simple".</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="n">raw_or_address</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span>
<span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr, str) -&gt; BasicBlock|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a BasicBlock object containing the given address, or return None.</span>

<span class="sd">    This function is tolerant and will accept different types of arguments:</span>
<span class="sd">    * address as int</span>
<span class="sd">    * Address object</span>
<span class="sd">    * symbol as string (will be resolved)</span>
<span class="sd">    * BasicBlock object (wrapped or unwrapped)</span>

<span class="sd">    :param raw_or_address: find basicblock that contains the given address.</span>
<span class="sd">    :param model: Ghidra supports different types of basic block &quot;models&quot;.</span>
<span class="sd">    Supported options are &quot;basic&quot; and &quot;simple&quot;.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">raw_or_address</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">raw_or_address</span><span class="p">):</span>
        <span class="n">block_model</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">model</span><span class="p">)(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">raw_or_address</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">block_model</span><span class="o">.</span><span class="n">getFirstCodeBlockContaining</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">raw_or_address</span>
    <span class="k">return</span> <span class="n">BasicBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.BlockGraph" class="doc doc-heading">
            <code>BlockGraph</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.PcodeBlock" href="#ghidralib.PcodeBlock">PcodeBlock</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BlockGraph</span><span class="p">(</span><span class="n">PcodeBlock</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeBlock]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">_pcode_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBlock</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">())]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BlockGraph.blocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">blocks</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.BodyTrait" class="doc doc-heading">
            <code>BodyTrait</code>


</h2>


    <div class="doc doc-contents ">


        <p>A trait for objects that have a body.</p>
<p>It provides generic methods that work with anything that has a body
(an assigned set of addresses in the program), such as highlighting.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BodyTrait</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A trait for objects that have a body.</span>

<span class="sd">    It provides generic methods that work with anything that has a body</span>
<span class="sd">    (an assigned set of addresses in the program), such as highlighting.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The body of this object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Highlight this instruction in the listing.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unhighlight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the highlight from this instruction.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">unhighlight</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.BodyTrait.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The body of this object</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.BodyTrait.highlight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">highlight</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Highlight this instruction in the listing.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">HIGHLIGHT_COLOR</span><span class="p">):</span>  <span class="c1"># type: (Color) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Highlight this instruction in the listing.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.BodyTrait.unhighlight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unhighlight</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Clear the highlight from this instruction.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unhighlight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the highlight from this instruction.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">unhighlight</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.ClangTokenGroup" class="doc doc-heading">
            <code>ClangTokenGroup</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Represents a group of clang tokens from a decompiler.</p>
<p>Warning: Currently this class is experimental, and should not be relied upon,
except to get the Java object (with .raw) or maybe dump (.dump()).</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ClangTokenGroup</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a group of clang tokens from a decompiler.</span>

<span class="sd">    Warning: Currently this class is experimental, and should not be relied upon,</span>
<span class="sd">    except to get the Java object (with .raw) or maybe dump (.dump()).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; JavaObject</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">GhClangTokenGroup</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">Parent</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">iterator</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="p">(</span><span class="n">ClangCommentToken</span><span class="p">,</span> <span class="n">ClangBreak</span><span class="p">)):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">ClangSyntaxToken</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">GhClangTokenGroup</span><span class="p">):</span>
                <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="n">new</span><span class="o">.</span><span class="n">AddTokenGroup</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cleaned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; ClangTokenGroup</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all whitespace and comments from this token group, recursively.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ClangTokenGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>  <span class="c1"># type: (JavaObject, int) -&gt; None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">GhClangTokenGroup</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">[group]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indent</span> <span class="o">*</span> <span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">iterator</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">indent</span> <span class="o">*</span> <span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.ClangTokenGroup.cleaned" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cleaned</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Remove all whitespace and comments from this token group, recursively.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.ClangTokenGroup.dump" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dump</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2408</span>
<span class="normal">2409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.DataType" class="doc doc-heading">
            <code>DataType</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DataType</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">):</span>  <span class="c1"># type: (DataT) -&gt; DataType|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a data type by name, or returns None if not found.</span>

<span class="sd">        Warning: this method is relatively slow, since it scans</span>
<span class="sd">        all data types in all data type managers.</span>

<span class="sd">            &gt;&gt;&gt; DataType.get(&quot;int&quot;)</span>
<span class="sd">            int</span>

<span class="sd">        :param name_or_raw: the name of the data type</span>
<span class="sd">        :return: the data type, or None if not found&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">DataType</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">datatype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name_or_raw</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="n">only_local</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; list[DataType]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all data types</span>

<span class="sd">        :param only_local: if True, return only local data types. Otherwise,</span>
<span class="sd">          will scan all data types in all data type managers.&quot;&quot;&quot;</span>
        <span class="n">datatypes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getDataTypeManager</span><span class="p">()</span><span class="o">.</span><span class="n">getAllDataTypes</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">only_local</span><span class="p">:</span>
            <span class="n">managers</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">getState</span><span class="p">()</span>
                <span class="o">.</span><span class="n">getTool</span><span class="p">()</span>
                <span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">DataTypeManagerService</span><span class="p">)</span>
                <span class="o">.</span><span class="n">getDataTypeManagers</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">manager</span> <span class="ow">in</span> <span class="n">managers</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">getAllDataTypes</span><span class="p">():</span>
                    <span class="n">datatypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">DataType</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">datatypes</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a name of this data type</span>

<span class="sd">            &gt;&gt;&gt; DataType(&#39;int&#39;).name</span>
<span class="sd">            &#39;int&#39;</span>
<span class="sd">        .</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (int) -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If this data type is an enum, get the name of the value.</span>

<span class="sd">        :param value: the value to get the name of&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this data type in bytes</span>

<span class="sd">            &gt;&gt;&gt; DataType(&#39;int&#39;).length()</span>
<span class="sd">            4</span>
<span class="sd">        .</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLength</span><span class="p">()</span>

    <span class="fm">__len__</span> <span class="o">=</span> <span class="n">length</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_c</span><span class="p">(</span><span class="n">c_code</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># type: (str, bool) -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse C structure definition and return the parsed DataType.</span>

<span class="sd">        If insert (true by default), add it to current program.</span>
<span class="sd">        Example of a valid c_code is `typedef void* HINTERNET;`</span>

<span class="sd">            &gt;&gt;&gt; DataType.from_c(&#39;typedef void* HINTERNET;&#39;)</span>
<span class="sd">            HINTERNET</span>
<span class="sd">            &gt;&gt;&gt; DataType.from_c(&quot;struct test { short a; short b; short c;};&quot;)</span>
<span class="sd">            pack()</span>
<span class="sd">            Structure test {</span>
<span class="sd">            0   short   2   a   &quot;&quot;</span>
<span class="sd">            2   short   2   b   &quot;&quot;</span>
<span class="sd">            4   short   2   c   &quot;&quot;</span>
<span class="sd">            }</span>
<span class="sd">            Length: 6 Alignment: 2</span>

<span class="sd">        :param c_code: the C structure definition</span>
<span class="sd">        :param insert: if True, add the data type to the current program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dtm</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getDataTypeManager</span><span class="p">()</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">CParser</span><span class="p">(</span><span class="n">dtm</span><span class="p">)</span>

        <span class="n">new_dt</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">c_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">insert</span><span class="p">:</span>
            <span class="n">transaction</span> <span class="o">=</span> <span class="n">dtm</span><span class="o">.</span><span class="n">startTransaction</span><span class="p">(</span><span class="s2">&quot;Adding new data&quot;</span><span class="p">)</span>
            <span class="n">dtm</span><span class="o">.</span><span class="n">addDataType</span><span class="p">(</span><span class="n">new_dt</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">dtm</span><span class="o">.</span><span class="n">endTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_dt</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.DataType.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span> <span class="o">=</span> <span class="n">length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.DataType.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a name of this data type</p>
<pre><code>&gt;&gt;&gt; DataType('int').name
'int'
</code></pre>
<p>.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.DataType.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">(</span><span class="n">only_local</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all data types</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>only_local</code></b>
              –
              <div class="doc-md-description">
                <p>if True, return only local data types. Otherwise, will scan all data types in all data type managers.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="n">only_local</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; list[DataType]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all data types</span>

<span class="sd">    :param only_local: if True, return only local data types. Otherwise,</span>
<span class="sd">      will scan all data types in all data type managers.&quot;&quot;&quot;</span>
    <span class="n">datatypes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getDataTypeManager</span><span class="p">()</span><span class="o">.</span><span class="n">getAllDataTypes</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">only_local</span><span class="p">:</span>
        <span class="n">managers</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">getState</span><span class="p">()</span>
            <span class="o">.</span><span class="n">getTool</span><span class="p">()</span>
            <span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">DataTypeManagerService</span><span class="p">)</span>
            <span class="o">.</span><span class="n">getDataTypeManagers</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">manager</span> <span class="ow">in</span> <span class="n">managers</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">getAllDataTypes</span><span class="p">():</span>
                <span class="n">datatypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">DataType</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">datatypes</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.DataType.from_c" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_c</span><span class="p">(</span><span class="n">c_code</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Parse C structure definition and return the parsed DataType.</p>
<p>If insert (true by default), add it to current program.
Example of a valid c_code is <code>typedef void* HINTERNET;</code></p>
<pre><code>&gt;&gt;&gt; DataType.from_c('typedef void* HINTERNET;')
HINTERNET
&gt;&gt;&gt; DataType.from_c("struct test { short a; short b; short c;};")
pack()
Structure test {
0   short   2   a   ""
2   short   2   b   ""
4   short   2   c   ""
}
Length: 6 Alignment: 2
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>c_code</code></b>
              –
              <div class="doc-md-description">
                <p>the C structure definition</p>
              </div>
            </li>
            <li>
              <b><code>insert</code></b>
              –
              <div class="doc-md-description">
                <p>if True, add the data type to the current program</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_c</span><span class="p">(</span><span class="n">c_code</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># type: (str, bool) -&gt; DataType</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse C structure definition and return the parsed DataType.</span>

<span class="sd">    If insert (true by default), add it to current program.</span>
<span class="sd">    Example of a valid c_code is `typedef void* HINTERNET;`</span>

<span class="sd">        &gt;&gt;&gt; DataType.from_c(&#39;typedef void* HINTERNET;&#39;)</span>
<span class="sd">        HINTERNET</span>
<span class="sd">        &gt;&gt;&gt; DataType.from_c(&quot;struct test { short a; short b; short c;};&quot;)</span>
<span class="sd">        pack()</span>
<span class="sd">        Structure test {</span>
<span class="sd">        0   short   2   a   &quot;&quot;</span>
<span class="sd">        2   short   2   b   &quot;&quot;</span>
<span class="sd">        4   short   2   c   &quot;&quot;</span>
<span class="sd">        }</span>
<span class="sd">        Length: 6 Alignment: 2</span>

<span class="sd">    :param c_code: the C structure definition</span>
<span class="sd">    :param insert: if True, add the data type to the current program</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dtm</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getDataTypeManager</span><span class="p">()</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">CParser</span><span class="p">(</span><span class="n">dtm</span><span class="p">)</span>

    <span class="n">new_dt</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">c_code</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">insert</span><span class="p">:</span>
        <span class="n">transaction</span> <span class="o">=</span> <span class="n">dtm</span><span class="o">.</span><span class="n">startTransaction</span><span class="p">(</span><span class="s2">&quot;Adding new data&quot;</span><span class="p">)</span>
        <span class="n">dtm</span><span class="o">.</span><span class="n">addDataType</span><span class="p">(</span><span class="n">new_dt</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">dtm</span><span class="o">.</span><span class="n">endTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_dt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.DataType.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets a data type by name, or returns None if not found.</p>
<p>Warning: this method is relatively slow, since it scans
all data types in all data type managers.</p>
<pre><code>&gt;&gt;&gt; DataType.get("int")
int
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name_or_raw</code></b>
              –
              <div class="doc-md-description">
                <p>the name of the data type</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the data type, or None if not found</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">):</span>  <span class="c1"># type: (DataT) -&gt; DataType|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets a data type by name, or returns None if not found.</span>

<span class="sd">    Warning: this method is relatively slow, since it scans</span>
<span class="sd">    all data types in all data type managers.</span>

<span class="sd">        &gt;&gt;&gt; DataType.get(&quot;int&quot;)</span>
<span class="sd">        int</span>

<span class="sd">    :param name_or_raw: the name of the data type</span>
<span class="sd">    :return: the data type, or None if not found&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="n">name_or_raw</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">DataType</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">datatype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name_or_raw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.DataType.get_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_name</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>If this data type is an enum, get the name of the value.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>the value to get the name of</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (int) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If this data type is an enum, get the name of the value.</span>

<span class="sd">    :param value: the value to get the name of&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.DataType.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this data type in bytes</p>
<pre><code>&gt;&gt;&gt; DataType('int').length()
4
</code></pre>
<p>.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the length of this data type in bytes</span>

<span class="sd">        &gt;&gt;&gt; DataType(&#39;int&#39;).length()</span>
<span class="sd">        4</span>
<span class="sd">    .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLength</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Emulator" class="doc doc-heading">
            <code>Emulator</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra EmulatorHelper object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Emulator</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra EmulatorHelper object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Emulator object.&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">EmulatorHelper</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="n">GhidraWrapper</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>

        <span class="c1"># Use max_addr/2-0x8000 as stack pointer - this is 0x7fff8000 on 32-bit CPU.</span>
        <span class="n">max_pointer</span> <span class="o">=</span> <span class="n">toAddr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAddressSpace</span><span class="p">()</span><span class="o">.</span><span class="n">getMaxAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="n">max_pointer</span> <span class="o">=</span> <span class="n">max_pointer</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span>  <span class="c1"># Java signed ints everywhere strike again.</span>
        <span class="n">stack_off</span> <span class="o">=</span> <span class="p">((</span><span class="n">max_pointer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x8000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStackPointerRegister</span><span class="p">(),</span> <span class="n">stack_off</span><span class="p">)</span>

        <span class="c1"># TODO: add a simple allocation manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: dict[int, Callable[[Emulator], bool]]</span>

    <span class="k">def</span> <span class="nf">add_hook</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">hook</span>
    <span class="p">):</span>  <span class="c1"># type: (Addr, Callable[[Emulator], bool]) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a hook at a specified address.</span>

<span class="sd">        Hook is a function that gets emulator as parameter, and returns a</span>
<span class="sd">        &quot;should_continue&quot; bool.</span>

<span class="sd">        Note: multiple hooks at the same address are not currently supported.&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multiple hooks at the same address are not supported&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">hook</span>

    <span class="k">def</span> <span class="nf">has_hook_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="k">def</span> <span class="nf">delete_hook_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the program counter of the emulated program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getExecutionAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@pc</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the program counter of the emulated program.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_pc</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_pc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the program counter of the emulated program.&quot;&quot;&quot;</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPCRegister</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sp_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the stack pointer register name for the emulated architecture.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStackPointerRegister</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current stack pointer register value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_register</span><span class="p">)</span>

    <span class="nd">@sp</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current stack pointer register value.</span>

<span class="sd">        :param value: new stack pointer value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_sp</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current stack pointer register value.</span>

<span class="sd">        :param value: new stack pointer value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_register</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>  <span class="c1"># type: (Reg|int) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the register of the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1337)</span>
<span class="sd">            &gt;&gt;&gt; emulator[&quot;eax&quot;]</span>
<span class="sd">            1337</span>

<span class="sd">        :param reg: the register or address to read from&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_register</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Reg, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write to the register of the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator[&quot;eax&quot;] = 1234</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">            1337</span>

<span class="sd">        :param reg: the register to write to</span>
<span class="sd">        :param value: the value to write&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_register</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>  <span class="c1"># type: (Reg) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read from the register of the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1337)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">            1337</span>

<span class="sd">        :param reg: the register to read from.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_python_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; bytes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read `length` bytes at `address` from the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_bytes(0x1000, &quot;1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_bytes(0x1000, 1)</span>
<span class="sd">            &#39;1&#39;</span>

<span class="sd">        :param address: the address to read from</span>
<span class="sd">        :param length: the length to read&quot;&quot;&quot;</span>
        <span class="n">bytelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readMemory</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span><span class="n">bytelist</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_u8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a byte from the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u8(0x1000, 13)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u8(0x1000)</span>
<span class="sd">            13</span>

<span class="sd">        :param address: the address to read from&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_u16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a 16bit unsigned integer from the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u16(0x1000, 123)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u16(0x1000)</span>
<span class="sd">            123</span>

<span class="sd">        :param address: the address to read from&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_u32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a 32bit unsigned integer from the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u32(0x1000, 123)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u32(0x1000)</span>
<span class="sd">            123</span>

<span class="sd">        :param address: the address to read from&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_u64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a 64bit unsigned integer from the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u64(0x1000, 123)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u64(0x1000)</span>
<span class="sd">            123</span>

<span class="sd">        :param address: the address to read from&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_cstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a null-terminated string from the emulated program.</span>

<span class="sd">        This function reads bytes until a nullbyte is encountered.</span>

<span class="sd">            &gt;&gt;&gt; emu.read_cstring(0x1000)</span>
<span class="sd">            &#39;Hello, world!&#39;</span>

<span class="sd">        :param address: address from which to start reading.&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_u8</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">read_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a null-terminated utf-16 string from the emulated program.</span>

<span class="sd">        This function reads bytes until a null character is encountered.</span>

<span class="sd">            &gt;&gt;&gt; emu.read_unicode(0x1000)</span>
<span class="sd">            &#39;Hello, world!&#39;</span>

<span class="sd">        :param address: address from which to start reading.&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_u16</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">read_varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varnode</span><span class="p">):</span>  <span class="c1"># type: (Varnode) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read from the varnode from the emulated program.</span>

<span class="sd">        This method can&#39;t read hash varnodes.</span>

<span class="sd">            &gt;&gt;&gt; fnc = Function(&quot;AddNumbers&quot;)</span>
<span class="sd">            &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">            &gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)</span>
<span class="sd">            &gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)</span>
<span class="sd">            &gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)</span>
<span class="sd">            &gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)</span>
<span class="sd">            4</span>

<span class="sd">        :param varnode: the varnode to read from.&quot;&quot;&quot;</span>
        <span class="n">varnode</span> <span class="o">=</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">varnode</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_address</span><span class="p">:</span>
            <span class="n">rawnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">rawnum</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
            <span class="n">space</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getAddressFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getUniqueSpace</span><span class="p">()</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">rawnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">rawnum</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_stack</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readStackValue</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_register</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
            <span class="n">reg</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_register</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unsupported varnode type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Reg, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write to the register of the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">            1</span>

<span class="sd">        :param reg: the register to write to</span>
<span class="sd">        :param value: the value to write&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, bytes) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write to the memory of the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_bytes(0x1000, &quot;1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_bytes(0x1000, 1)</span>
<span class="sd">            &#39;1&#39;</span>

<span class="sd">        :param address: the address to write to</span>
<span class="sd">        :param value: the value to write&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeMemory</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_u8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a byte to the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u8(0x1000, 13)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u8(0x1000)</span>
<span class="sd">            13</span>

<span class="sd">        :param address: the address to write to&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_u16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a 16bit unsigned integer to the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u16(0x1000, 13)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u16(0x1000)</span>
<span class="sd">            13</span>

<span class="sd">        :param address: the address to write to&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_u32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a 32bit unsigned integer to the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u32(0x1000, 13)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u32(0x1000)</span>
<span class="sd">            13</span>

<span class="sd">        :param address: the address to write to&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_u64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a 64bit unsigned integer to the emulated program.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_u64(0x1000, 13)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_u64(0x1000)</span>
<span class="sd">            13</span>

<span class="sd">        :param address: the address to write to&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varnode</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Varnode, int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a varnode value in the emulated context.</span>

<span class="sd">        This method can&#39;t set hash and constant varnodes.</span>

<span class="sd">            &gt;&gt;&gt; fnc = Function(&quot;AddNumbers&quot;)</span>
<span class="sd">            &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">            &gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)</span>
<span class="sd">            &gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)</span>
<span class="sd">            &gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)</span>
<span class="sd">            &gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)</span>
<span class="sd">            4</span>

<span class="sd">        :param varnode: the varnode to read from.&quot;&quot;&quot;</span>
        <span class="n">varnode</span> <span class="o">=</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set value of a constant varnodes&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_address</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
            <span class="n">space</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getAddressFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getUniqueSpace</span><span class="p">()</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_stack</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeStackValue</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_register</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
            <span class="n">reg</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unsupported varnode type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__run_with_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the Ghidra emulator, and transparently handle all hooks.</span>

<span class="sd">        :return: true if emulator stopped at a (non-hook) breakpoint, or if</span>
<span class="sd">          a hook asked emulator to stop (by returning False).&quot;&quot;&quot;</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">getMonitor</span><span class="p">()</span><span class="o">.</span><span class="n">isCancelled</span><span class="p">():</span>
            <span class="n">is_breakpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">is_breakpoint</span>

            <span class="n">continue_execution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">continue_execution</span><span class="p">:</span>
                <span class="c1"># We return True to signal that no emulation error occured.</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">emulate_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">ends</span><span class="p">):</span>  <span class="c1"># type: (Addr, Addr|list[Addr]) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emulate from start to end address, using Ghidra for fast emulation.</span>

<span class="sd">        The main loop of this function is in Java, which makes it faster, but makes</span>
<span class="sd">        some features (like callbacks) impossible. This function stops on error,</span>
<span class="sd">        when PC reaches one of the ends, and will also call hooks.</span>

<span class="sd">        This method will set a breakpoint at the end address, and clear it after</span>
<span class="sd">        the emulation is done.</span>

<span class="sd">            &gt;&gt;&gt; emulator.write_bytes(0x2000, &quot;1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; emulator.emulate_fast(0x1000, 0x1005)</span>
<span class="sd">            &gt;&gt;&gt; emulator.read_bytes(0x2000, 1)</span>
<span class="sd">            &#39;0&#39;</span>

<span class="sd">        :param start: the start address to emulate</span>
<span class="sd">        :param ends: one or many end address&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_pc</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ends</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">ends</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setBreakpoint</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>

        <span class="n">is_breakpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run_with_hooks</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">clearBreakpoint</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_breakpoint</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLastError</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error when running: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">single_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Do a single emulation step. This will step into calls.</span>

<span class="sd">        Note: This method *will* call hooks.</span>

<span class="sd">        :return: True if the emulation stopped at a breakpoint, False otherwise.&quot;&quot;&quot;</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLastError</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error at </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_at_breakpoint</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">emulate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">,</span>
        <span class="n">ends</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stop_when</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">maxsteps</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">48</span><span class="p">,</span>
    <span class="p">):</span>  <span class="c1"># type: (Addr, Addr|list[Addr], Callable[[int], str|None], Callable[[int], bool], int) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emulate from start to end address, with callback for each executed address.</span>

<span class="sd">            &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">            &gt;&gt;&gt; def callback(addr):</span>
<span class="sd">            &gt;&gt;&gt;     print(addr)</span>
<span class="sd">            &gt;&gt;&gt;     return True</span>
<span class="sd">            &gt;&gt;&gt; emu.trace(Function(&quot;main&quot;).entrypoint, callback=callback, maxsteps=3)</span>
<span class="sd">            SUB ESP,0x2d4</span>
<span class="sd">            PUSH EBX</span>
<span class="sd">            PUSH EBP</span>

<span class="sd">        Callback should return one of:</span>

<span class="sd">        * &#39;continue&#39; or None, to continue execution normally</span>
<span class="sd">        * &#39;break&#39; to stop execution</span>
<span class="sd">        * &#39;skip&#39; to skip the next instruction</span>
<span class="sd">        * &#39;retry&#39; like continue, but call the callback again (useful after pc change)</span>
<span class="sd">        * &#39;continue_then_break&#39; to execute one last instruction before stopping</span>

<span class="sd">        Returning another value will cause an exception</span>

<span class="sd">        Callback is executed before stop_when is checked.</span>

<span class="sd">        This method is very flexible, but because of that it may be slower than</span>
<span class="sd">        pure Ghidra implementation. Consider .emulate_fast() when this method is too</span>
<span class="sd">        slow for you.</span>

<span class="sd">        :param start: the start address to emulate</span>
<span class="sd">        :param end: the end address to emulate</span>
<span class="sd">        :param callback: the callback to call before each executed instruction.</span>
<span class="sd">          Return one of the predefined constants here (see the docs for more info).</span>
<span class="sd">        :param stop_when: the callback to call before each executed instruction.</span>
<span class="sd">          Return True here to stop emulation.</span>
<span class="sd">        :param maxsteps: the maximum number of steps to execute&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_pc</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ends</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">ends</span><span class="p">]</span>
        <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">resolve</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">current</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ends</span> <span class="ow">and</span> <span class="n">maxsteps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">maxsteps</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;continue&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;break&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">address</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">current</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;retry&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;continue_then_break&quot;</span><span class="p">:</span>
                <span class="n">maxsteps</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown callback result: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">stop_when</span><span class="p">(</span><span class="n">current</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_step</span><span class="p">():</span>
                <span class="k">return</span>

            <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getExecutionAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_at_breakpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the emulator is at a breakpoint&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEmulator</span><span class="p">()</span><span class="o">.</span><span class="n">isAtBreakpoint</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Emulator.is_at_breakpoint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_at_breakpoint</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if the emulator is at a breakpoint</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Emulator.pc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the program counter of the emulated program.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Emulator.sp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sp</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the current stack pointer register value.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Emulator.sp_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sp_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the stack pointer register name for the emulated architecture.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read the register of the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_register("eax", 1337)
&gt;&gt;&gt; emulator["eax"]
1337
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reg</code></b>
              –
              <div class="doc-md-description">
                <p>the register or address to read from</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>  <span class="c1"># type: (Reg|int) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the register of the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1337)</span>
<span class="sd">        &gt;&gt;&gt; emulator[&quot;eax&quot;]</span>
<span class="sd">        1337</span>

<span class="sd">    :param reg: the register or address to read from&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_register</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new Emulator object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Emulator object.&quot;&quot;&quot;</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">EmulatorHelper</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="n">GhidraWrapper</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>

    <span class="c1"># Use max_addr/2-0x8000 as stack pointer - this is 0x7fff8000 on 32-bit CPU.</span>
    <span class="n">max_pointer</span> <span class="o">=</span> <span class="n">toAddr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAddressSpace</span><span class="p">()</span><span class="o">.</span><span class="n">getMaxAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
    <span class="n">max_pointer</span> <span class="o">=</span> <span class="n">max_pointer</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span>  <span class="c1"># Java signed ints everywhere strike again.</span>
    <span class="n">stack_off</span> <span class="o">=</span> <span class="p">((</span><span class="n">max_pointer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x8000</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStackPointerRegister</span><span class="p">(),</span> <span class="n">stack_off</span><span class="p">)</span>

    <span class="c1"># TODO: add a simple allocation manager</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: dict[int, Callable[[Emulator], bool]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.__run_with_hooks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__run_with_hooks</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run the Ghidra emulator, and transparently handle all hooks.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>true if emulator stopped at a (non-hook) breakpoint, or if a hook asked emulator to stop (by returning False).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__run_with_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the Ghidra emulator, and transparently handle all hooks.</span>

<span class="sd">    :return: true if emulator stopped at a (non-hook) breakpoint, or if</span>
<span class="sd">      a hook asked emulator to stop (by returning False).&quot;&quot;&quot;</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">getMonitor</span><span class="p">()</span><span class="o">.</span><span class="n">isCancelled</span><span class="p">():</span>
        <span class="n">is_breakpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">is_breakpoint</span>

        <span class="n">continue_execution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">continue_execution</span><span class="p">:</span>
            <span class="c1"># We return True to signal that no emulation error occured.</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.__setitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write to the register of the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator["eax"] = 1234
&gt;&gt;&gt; emulator.read_register("eax")
1337
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reg</code></b>
              –
              <div class="doc-md-description">
                <p>the register to write to</p>
              </div>
            </li>
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>the value to write</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Reg, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write to the register of the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator[&quot;eax&quot;] = 1234</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">        1337</span>

<span class="sd">    :param reg: the register to write to</span>
<span class="sd">    :param value: the value to write&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_register</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.add_hook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_hook</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">hook</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a hook at a specified address.</p>
<p>Hook is a function that gets emulator as parameter, and returns a
"should_continue" bool.</p>
<p>Note: multiple hooks at the same address are not currently supported.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_hook</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">hook</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, Callable[[Emulator], bool]) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a hook at a specified address.</span>

<span class="sd">    Hook is a function that gets emulator as parameter, and returns a</span>
<span class="sd">    &quot;should_continue&quot; bool.</span>

<span class="sd">    Note: multiple hooks at the same address are not currently supported.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multiple hooks at the same address are not supported&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">hook</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.delete_hook_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_hook_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_hook_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.emulate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">emulate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="p">[],</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop_when</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">48</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Emulate from start to end address, with callback for each executed address.</p>
<pre><code>&gt;&gt;&gt; emu = Emulator()
&gt;&gt;&gt; def callback(addr):
&gt;&gt;&gt;     print(addr)
&gt;&gt;&gt;     return True
&gt;&gt;&gt; emu.trace(Function("main").entrypoint, callback=callback, maxsteps=3)
SUB ESP,0x2d4
PUSH EBX
PUSH EBP
</code></pre>
<p>Callback should return one of:</p>
<ul>
<li>'continue' or None, to continue execution normally</li>
<li>'break' to stop execution</li>
<li>'skip' to skip the next instruction</li>
<li>'retry' like continue, but call the callback again (useful after pc change)</li>
<li>'continue_then_break' to execute one last instruction before stopping</li>
</ul>
<p>Returning another value will cause an exception</p>
<p>Callback is executed before stop_when is checked.</p>
<p>This method is very flexible, but because of that it may be slower than
pure Ghidra implementation. Consider .emulate_fast() when this method is too
slow for you.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>start</code></b>
              –
              <div class="doc-md-description">
                <p>the start address to emulate</p>
              </div>
            </li>
            <li>
              <b><code>end</code></b>
              –
              <div class="doc-md-description">
                <p>the end address to emulate</p>
              </div>
            </li>
            <li>
              <b><code>callback</code></b>
              –
              <div class="doc-md-description">
                <p>the callback to call before each executed instruction. Return one of the predefined constants here (see the docs for more info).</p>
              </div>
            </li>
            <li>
              <b><code>stop_when</code></b>
              –
              <div class="doc-md-description">
                <p>the callback to call before each executed instruction. Return True here to stop emulation.</p>
              </div>
            </li>
            <li>
              <b><code>maxsteps</code></b>
              –
              <div class="doc-md-description">
                <p>the maximum number of steps to execute</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">emulate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start</span><span class="p">,</span>
    <span class="n">ends</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stop_when</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">maxsteps</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">48</span><span class="p">,</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, Addr|list[Addr], Callable[[int], str|None], Callable[[int], bool], int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Emulate from start to end address, with callback for each executed address.</span>

<span class="sd">        &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">        &gt;&gt;&gt; def callback(addr):</span>
<span class="sd">        &gt;&gt;&gt;     print(addr)</span>
<span class="sd">        &gt;&gt;&gt;     return True</span>
<span class="sd">        &gt;&gt;&gt; emu.trace(Function(&quot;main&quot;).entrypoint, callback=callback, maxsteps=3)</span>
<span class="sd">        SUB ESP,0x2d4</span>
<span class="sd">        PUSH EBX</span>
<span class="sd">        PUSH EBP</span>

<span class="sd">    Callback should return one of:</span>

<span class="sd">    * &#39;continue&#39; or None, to continue execution normally</span>
<span class="sd">    * &#39;break&#39; to stop execution</span>
<span class="sd">    * &#39;skip&#39; to skip the next instruction</span>
<span class="sd">    * &#39;retry&#39; like continue, but call the callback again (useful after pc change)</span>
<span class="sd">    * &#39;continue_then_break&#39; to execute one last instruction before stopping</span>

<span class="sd">    Returning another value will cause an exception</span>

<span class="sd">    Callback is executed before stop_when is checked.</span>

<span class="sd">    This method is very flexible, but because of that it may be slower than</span>
<span class="sd">    pure Ghidra implementation. Consider .emulate_fast() when this method is too</span>
<span class="sd">    slow for you.</span>

<span class="sd">    :param start: the start address to emulate</span>
<span class="sd">    :param end: the end address to emulate</span>
<span class="sd">    :param callback: the callback to call before each executed instruction.</span>
<span class="sd">      Return one of the predefined constants here (see the docs for more info).</span>
<span class="sd">    :param stop_when: the callback to call before each executed instruction.</span>
<span class="sd">      Return True here to stop emulation.</span>
<span class="sd">    :param maxsteps: the maximum number of steps to execute&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_pc</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ends</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">ends</span><span class="p">]</span>
    <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">resolve</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">current</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ends</span> <span class="ow">and</span> <span class="n">maxsteps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">maxsteps</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;continue&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;break&quot;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">current</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;retry&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;continue_then_break&quot;</span><span class="p">:</span>
            <span class="n">maxsteps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown callback result: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">stop_when</span><span class="p">(</span><span class="n">current</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_step</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getExecutionAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.emulate_fast" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">emulate_fast</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">ends</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Emulate from start to end address, using Ghidra for fast emulation.</p>
<p>The main loop of this function is in Java, which makes it faster, but makes
some features (like callbacks) impossible. This function stops on error,
when PC reaches one of the ends, and will also call hooks.</p>
<p>This method will set a breakpoint at the end address, and clear it after
the emulation is done.</p>
<pre><code>&gt;&gt;&gt; emulator.write_bytes(0x2000, "1")
&gt;&gt;&gt; emulator.emulate_fast(0x1000, 0x1005)
&gt;&gt;&gt; emulator.read_bytes(0x2000, 1)
'0'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>start</code></b>
              –
              <div class="doc-md-description">
                <p>the start address to emulate</p>
              </div>
            </li>
            <li>
              <b><code>ends</code></b>
              –
              <div class="doc-md-description">
                <p>one or many end address</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">emulate_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">ends</span><span class="p">):</span>  <span class="c1"># type: (Addr, Addr|list[Addr]) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Emulate from start to end address, using Ghidra for fast emulation.</span>

<span class="sd">    The main loop of this function is in Java, which makes it faster, but makes</span>
<span class="sd">    some features (like callbacks) impossible. This function stops on error,</span>
<span class="sd">    when PC reaches one of the ends, and will also call hooks.</span>

<span class="sd">    This method will set a breakpoint at the end address, and clear it after</span>
<span class="sd">    the emulation is done.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_bytes(0x2000, &quot;1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; emulator.emulate_fast(0x1000, 0x1005)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_bytes(0x2000, 1)</span>
<span class="sd">        &#39;0&#39;</span>

<span class="sd">    :param start: the start address to emulate</span>
<span class="sd">    :param ends: one or many end address&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_pc</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ends</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">ends</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setBreakpoint</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>

    <span class="n">is_breakpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run_with_hooks</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">clearBreakpoint</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_breakpoint</span><span class="p">:</span>
        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLastError</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error when running: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.has_hook_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_hook_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_hook_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read <code>length</code> bytes at <code>address</code> from the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_bytes(0x1000, "1")
&gt;&gt;&gt; emulator.read_bytes(0x1000, 1)
'1'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to read from</p>
              </div>
            </li>
            <li>
              <b><code>length</code></b>
              –
              <div class="doc-md-description">
                <p>the length to read</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read `length` bytes at `address` from the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_bytes(0x1000, &quot;1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_bytes(0x1000, 1)</span>
<span class="sd">        &#39;1&#39;</span>

<span class="sd">    :param address: the address to read from</span>
<span class="sd">    :param length: the length to read&quot;&quot;&quot;</span>
    <span class="n">bytelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readMemory</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">length</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span><span class="n">bytelist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_cstring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_cstring</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a null-terminated string from the emulated program.</p>
<p>This function reads bytes until a nullbyte is encountered.</p>
<pre><code>&gt;&gt;&gt; emu.read_cstring(0x1000)
'Hello, world!'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to start reading.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_cstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a null-terminated string from the emulated program.</span>

<span class="sd">    This function reads bytes until a nullbyte is encountered.</span>

<span class="sd">        &gt;&gt;&gt; emu.read_cstring(0x1000)</span>
<span class="sd">        &#39;Hello, world!&#39;</span>

<span class="sd">    :param address: address from which to start reading.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_u8</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_register</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read from the register of the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_register("eax", 1337)
&gt;&gt;&gt; emulator.read_register("eax")
1337
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reg</code></b>
              –
              <div class="doc-md-description">
                <p>the register to read from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>  <span class="c1"># type: (Reg) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read from the register of the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1337)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">        1337</span>

<span class="sd">    :param reg: the register to read from.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_python_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_u16" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u16</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a 16bit unsigned integer from the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u16(0x1000, 123)
&gt;&gt;&gt; emulator.read_u16(0x1000)
123
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to read from</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 16bit unsigned integer from the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u16(0x1000, 123)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u16(0x1000)</span>
<span class="sd">        123</span>

<span class="sd">    :param address: the address to read from&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_u32" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u32</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a 32bit unsigned integer from the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u32(0x1000, 123)
&gt;&gt;&gt; emulator.read_u32(0x1000)
123
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to read from</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 32bit unsigned integer from the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u32(0x1000, 123)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u32(0x1000)</span>
<span class="sd">        123</span>

<span class="sd">    :param address: the address to read from&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_u64" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u64</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a 64bit unsigned integer from the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u64(0x1000, 123)
&gt;&gt;&gt; emulator.read_u64(0x1000)
123
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to read from</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 64bit unsigned integer from the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u64(0x1000, 123)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u64(0x1000)</span>
<span class="sd">        123</span>

<span class="sd">    :param address: the address to read from&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_u8" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u8</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a byte from the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u8(0x1000, 13)
&gt;&gt;&gt; emulator.read_u8(0x1000)
13
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to read from</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a byte from the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u8(0x1000, 13)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u8(0x1000)</span>
<span class="sd">        13</span>

<span class="sd">    :param address: the address to read from&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_unicode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_unicode</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a null-terminated utf-16 string from the emulated program.</p>
<p>This function reads bytes until a null character is encountered.</p>
<pre><code>&gt;&gt;&gt; emu.read_unicode(0x1000)
'Hello, world!'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to start reading.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a null-terminated utf-16 string from the emulated program.</span>

<span class="sd">    This function reads bytes until a null character is encountered.</span>

<span class="sd">        &gt;&gt;&gt; emu.read_unicode(0x1000)</span>
<span class="sd">        &#39;Hello, world!&#39;</span>

<span class="sd">    :param address: address from which to start reading.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_u16</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.read_varnode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read from the varnode from the emulated program.</p>
<p>This method can't read hash varnodes.</p>
<pre><code>&gt;&gt;&gt; fnc = Function("AddNumbers")
&gt;&gt;&gt; emu = Emulator()
&gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)
&gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)
&gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)
&gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)
4
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>varnode</code></b>
              –
              <div class="doc-md-description">
                <p>the varnode to read from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varnode</span><span class="p">):</span>  <span class="c1"># type: (Varnode) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read from the varnode from the emulated program.</span>

<span class="sd">    This method can&#39;t read hash varnodes.</span>

<span class="sd">        &gt;&gt;&gt; fnc = Function(&quot;AddNumbers&quot;)</span>
<span class="sd">        &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">        &gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)</span>
<span class="sd">        &gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)</span>
<span class="sd">        &gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)</span>
<span class="sd">        &gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)</span>
<span class="sd">        4</span>

<span class="sd">    :param varnode: the varnode to read from.&quot;&quot;&quot;</span>
    <span class="n">varnode</span> <span class="o">=</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">varnode</span><span class="o">.</span><span class="n">offset</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_address</span><span class="p">:</span>
        <span class="n">rawnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">rawnum</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
        <span class="n">space</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getAddressFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getUniqueSpace</span><span class="p">()</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">rawnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">rawnum</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_stack</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">readStackValue</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_register</span><span class="p">:</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_register</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unsupported varnode type&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.set_pc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_pc</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the program counter of the emulated program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_pc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the program counter of the emulated program.&quot;&quot;&quot;</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPCRegister</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.set_sp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_sp</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the current stack pointer register value.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>new stack pointer value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the current stack pointer register value.</span>

<span class="sd">    :param value: new stack pointer value.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_register</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.single_step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">single_step</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Do a single emulation step. This will step into calls.</p>
<p>Note: This method <em>will</em> call hooks.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>True if the emulation stopped at a breakpoint, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">single_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a single emulation step. This will step into calls.</span>

<span class="sd">    Note: This method *will* call hooks.</span>

<span class="sd">    :return: True if the emulation stopped at a breakpoint, False otherwise.&quot;&quot;&quot;</span>
    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLastError</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error at </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pc</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_at_breakpoint</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write to the memory of the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_bytes(0x1000, "1")
&gt;&gt;&gt; emulator.read_bytes(0x1000, 1)
'1'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to write to</p>
              </div>
            </li>
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>the value to write</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, bytes) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write to the memory of the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_bytes(0x1000, &quot;1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_bytes(0x1000, 1)</span>
<span class="sd">        &#39;1&#39;</span>

<span class="sd">    :param address: the address to write to</span>
<span class="sd">    :param value: the value to write&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeMemory</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_register</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write to the register of the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_register("eax", 1)
&gt;&gt;&gt; emulator.read_register("eax")
1
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reg</code></b>
              –
              <div class="doc-md-description">
                <p>the register to write to</p>
              </div>
            </li>
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>the value to write</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Reg, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write to the register of the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_register(&quot;eax&quot;, 1)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_register(&quot;eax&quot;)</span>
<span class="sd">        1</span>

<span class="sd">    :param reg: the register to write to</span>
<span class="sd">    :param value: the value to write&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_u16" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_u16</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a 16bit unsigned integer to the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u16(0x1000, 13)
&gt;&gt;&gt; emulator.read_u16(0x1000)
13
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to write to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_u16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a 16bit unsigned integer to the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u16(0x1000, 13)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u16(0x1000)</span>
<span class="sd">        13</span>

<span class="sd">    :param address: the address to write to&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_u32" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_u32</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a 32bit unsigned integer to the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u32(0x1000, 13)
&gt;&gt;&gt; emulator.read_u32(0x1000)
13
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to write to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_u32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a 32bit unsigned integer to the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u32(0x1000, 13)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u32(0x1000)</span>
<span class="sd">        13</span>

<span class="sd">    :param address: the address to write to&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_u64" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_u64</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a 64bit unsigned integer to the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u64(0x1000, 13)
&gt;&gt;&gt; emulator.read_u64(0x1000)
13
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to write to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_u64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a 64bit unsigned integer to the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u64(0x1000, 13)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u64(0x1000)</span>
<span class="sd">        13</span>

<span class="sd">    :param address: the address to write to&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_u8" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_u8</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a byte to the emulated program.</p>
<pre><code>&gt;&gt;&gt; emulator.write_u8(0x1000, 13)
&gt;&gt;&gt; emulator.read_u8(0x1000)
13
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to write to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_u8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a byte to the emulated program.</span>

<span class="sd">        &gt;&gt;&gt; emulator.write_u8(0x1000, 13)</span>
<span class="sd">        &gt;&gt;&gt; emulator.read_u8(0x1000)</span>
<span class="sd">        13</span>

<span class="sd">    :param address: the address to write to&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;value out of range&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Emulator.write_varnode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set a varnode value in the emulated context.</p>
<p>This method can't set hash and constant varnodes.</p>
<pre><code>&gt;&gt;&gt; fnc = Function("AddNumbers")
&gt;&gt;&gt; emu = Emulator()
&gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)
&gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)
&gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)
&gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)
4
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>varnode</code></b>
              –
              <div class="doc-md-description">
                <p>the varnode to read from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varnode</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Varnode, int) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set a varnode value in the emulated context.</span>

<span class="sd">    This method can&#39;t set hash and constant varnodes.</span>

<span class="sd">        &gt;&gt;&gt; fnc = Function(&quot;AddNumbers&quot;)</span>
<span class="sd">        &gt;&gt;&gt; emu = Emulator()</span>
<span class="sd">        &gt;&gt;&gt; emu.write_varnode(fnc.parameters[0].varnode, 2)</span>
<span class="sd">        &gt;&gt;&gt; emu.write_varnode(fnc.parameters[1].varnode, 2)</span>
<span class="sd">        &gt;&gt;&gt; emu.emulate(fnc.entrypoint, stop_when=lambda pc: pc not in fnc.body)</span>
<span class="sd">        &gt;&gt;&gt; emu.read_varnode(func.return_variable.varnode)</span>
<span class="sd">        4</span>

<span class="sd">    :param varnode: the varnode to read from.&quot;&quot;&quot;</span>
    <span class="n">varnode</span> <span class="o">=</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">varnode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set value of a constant varnodes&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_address</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
        <span class="n">space</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getAddressFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getUniqueSpace</span><span class="p">()</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_stack</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeStackValue</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">varnode</span><span class="o">.</span><span class="n">is_register</span><span class="p">:</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="n">varnode</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">writeRegister</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unsupported varnode type&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.FlowType" class="doc doc-heading">
            <code>FlowType</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra FlowType object</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FlowType</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra FlowType object&quot;&quot;&quot;</span>

    <span class="c1"># TODO is class this necessary? This is just a subclass of RefType.</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is a call.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isCall</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is a jump.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isJump</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_computed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is a computed jump.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isComputed</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_conditional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is a conditional jump.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isConditional</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unconditional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is an unconditional jump.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_conditional</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_terminal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is a terminator.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isTerminal</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_fallthrough</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow has a fallthrough.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasFallthrough</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this flow is an override.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isOverride</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.has_fallthrough" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_fallthrough</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow has a fallthrough.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_call</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is a call.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_computed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_computed</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is a computed jump.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_conditional" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_conditional</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is a conditional jump.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_jump" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_jump</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is a jump.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_override</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is an override.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_terminal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_terminal</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is a terminator.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FlowType.is_unconditional" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unconditional</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this flow is an unconditional jump.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Function" class="doc doc-heading">
            <code>Function</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code>, <code><a class="autorefs autorefs-internal" title="ghidralib.BodyTrait" href="#ghidralib.BodyTrait">BodyTrait</a></code></p>


        <p>Wraps a Ghidra Function object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Function</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">,</span> <span class="n">BodyTrait</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra Function object.&quot;&quot;&quot;</span>

    <span class="n">UNDERLYING_CLASS</span> <span class="o">=</span> <span class="n">GhFunction</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Function|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a function at the given address, or None if no function</span>
<span class="sd">        exists there.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">GhFunction</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getListing</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctionContaining</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all functions in the current program.&quot;&quot;&quot;</span>
        <span class="n">raw_functions</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctionManager</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctions</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Function</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">raw_functions</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (Addr, str) -&gt; Function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new function at the given address with the given name.&quot;&quot;&quot;</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">createFunction</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">return_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the return type of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReturnType</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">return_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Parameter</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the variable representing a return value of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReturn</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the entrypoint of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEntryPoint</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exitpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of exit points for the function.</span>

<span class="sd">        This will return a list of addresses of function terminators. For example,</span>
<span class="sd">        if a function has two RETs, this function will return their addresses.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">address</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructions</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">flow_type</span><span class="o">.</span><span class="n">is_terminal</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the comment of this function, if any.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getComment</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the comment of this function.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_thunk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this function is a thunk.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isThunk</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_external</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this function is external.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isExternal</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">repeatable_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the repeatable comment of this function, if any.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRepeatableComment</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_repeatable_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the repeatable comment of this function.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setRepeatableComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Parameter]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the parameters of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getParameters</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">add_named_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (DataT, str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a parameter with a specified name to this function.</span>

<span class="sd">        Warning: adding a register parameter will switch the function into</span>
<span class="sd">        custom storage mode. Adding named parameters in custom storage is not</span>
<span class="sd">        implemented&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasCustomVariableStorage</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, adding named parameters is not implemented &quot;</span>
                <span class="s2">&quot;for functions with custom storage&quot;</span>
            <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">ParameterImpl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_register_parameter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">name</span>
    <span class="p">):</span>  <span class="c1"># type: (DataT, Reg, str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a parameter stored in a specified register to this function.</span>

<span class="sd">        Warning: adding a register parameter will switch the function into</span>
<span class="sd">        custom storage mode. Adding named parameters in custom storage will</span>
<span class="sd">        not work anymore&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasCustomVariableStorage</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setCustomVariableStorage</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">ParameterImpl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fixup_body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fixup the function body: follow control flow and add thunks.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">CreateFunctionCmd</span><span class="o">.</span><span class="n">fixupFunctionBody</span><span class="p">(</span>
            <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Variable]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the local variables of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Variable</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLocalVariables</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Variable]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all variables defined in this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Variable</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAllVariables</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all varnodes associated with a variable in this function.&quot;&quot;&quot;</span>
        <span class="n">varnodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="n">varnodes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">varnodes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[HighVariable]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all variables defined in this function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_function</span><span class="o">.</span><span class="n">variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Variable]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the defined stack variables (both parameters and locals).&quot;&quot;&quot;</span>
        <span class="n">raw_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStackFrame</span><span class="p">()</span><span class="o">.</span><span class="n">getStackVariables</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Variable</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_vars</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Change the name of this function.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assembler instructions for this function.&quot;&quot;&quot;</span>
        <span class="n">listing</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getListing</span><span class="p">()</span>
        <span class="n">raw_instructions</span> <span class="o">=</span> <span class="n">listing</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBody</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Instruction</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_instructions</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Reference]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the references to this function.&quot;&quot;&quot;</span>
        <span class="n">raw_refs</span> <span class="o">=</span> <span class="n">getReferencesTo</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Reference</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_refs</span><span class="p">]</span>

    <span class="n">xrefs_to</span> <span class="o">=</span> <span class="n">xrefs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xref_addrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the source addresses of references to this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">xref</span><span class="o">.</span><span class="n">from_address</span> <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all functions that call this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Function</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getCallingFunctions</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">called</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all functions that are called by this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Function</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getCalledFunctions</span><span class="p">(</span><span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fixup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the fixup of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getCallFixup</span><span class="p">()</span>

    <span class="nd">@fixup</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">fixup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixup</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the fixup of this function.</span>

<span class="sd">        :param fixup: The new fixup to set.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setCallFixup</span><span class="p">(</span><span class="n">fixup</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">calls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[FunctionCall]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all function calls to this function.&quot;&quot;&quot;</span>
        <span class="n">calls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ref</span><span class="o">.</span><span class="n">is_call</span><span class="p">:</span>
                <span class="n">calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FunctionCall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">from_address</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calls</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">basicblocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the basic blocks of this function.&quot;&quot;&quot;</span>
        <span class="n">block_model</span> <span class="o">=</span> <span class="n">BasicBlockModel</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">block_model</span><span class="o">.</span><span class="n">getCodeBlocksContaining</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBody</span><span class="p">(),</span> <span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">BasicBlock</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_decompile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="s2">&quot;decompile&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; JavaObject</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decompile this function (internal helper).&quot;&quot;&quot;</span>
        <span class="n">decompiler</span> <span class="o">=</span> <span class="n">DecompInterface</span><span class="p">()</span>
        <span class="n">decompiler</span><span class="o">.</span><span class="n">openProgram</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="n">decompiler</span><span class="o">.</span><span class="n">setSimplificationStyle</span><span class="p">(</span><span class="n">simplify</span><span class="p">)</span>
        <span class="n">decompiled</span> <span class="o">=</span> <span class="n">decompiler</span><span class="o">.</span><span class="n">decompileFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">TaskMonitor</span><span class="o">.</span><span class="n">DUMMY</span><span class="p">)</span>
        <span class="n">decompiler</span><span class="o">.</span><span class="n">closeProgram</span><span class="p">()</span>
        <span class="n">decompiler</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">decompiled</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Failed to decompile function </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">decompiled</span>

    <span class="k">def</span> <span class="nf">decompile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get decompiled C code for the function as string.&quot;&quot;&quot;</span>
        <span class="n">decompiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompile</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">decompiled</span><span class="o">.</span><span class="n">getDecompiledFunction</span><span class="p">()</span><span class="o">.</span><span class="n">getC</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">clang_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; ClangTokenGroup</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get clang tokens for the decompiled function.</span>

<span class="sd">        This returns a ClangTokenGroup object. TODO: wrap the return value.&quot;&quot;&quot;</span>
        <span class="n">decompiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompile</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ClangTokenGroup</span><span class="p">(</span><span class="n">decompiled</span><span class="o">.</span><span class="n">getCCodeMarkup</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; HighFunction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decompile this function, and return a high-level function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_high_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="s2">&quot;decompile&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; HighFunction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decompile this function, and return a high-level function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">        :simplify: the simplification style to use.</span>
<span class="sd">        See DecompilerInterface.setSimplificationStyle.&quot;&quot;&quot;</span>
        <span class="n">decompiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompile</span><span class="p">(</span><span class="n">simplify</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HighFunction</span><span class="p">(</span><span class="n">decompiled</span><span class="o">.</span><span class="n">getHighFunction</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_high_pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="s2">&quot;decompile&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decompile this function, and return its high-level Pcode.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">        :simplify: the simplification style to use.</span>
<span class="sd">        See DecompilerInterface.setSimplificationStyle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">(</span><span class="n">simplify</span><span class="p">)</span><span class="o">.</span><span class="n">pcode</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; BlockGraph</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an AST-like representation of the function&#39;s Pcode.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">()</span><span class="o">.</span><span class="n">pcode_tree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the (low-level) Pcode for this function.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basicblocks</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">pcode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the (high-level) Pcode for this function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_pcode</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_basicblocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the (high-level) Pcode basic blocks for this function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_function</span><span class="o">.</span><span class="n">basicblocks</span>

    <span class="k">def</span> <span class="nf">get_high_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the high-level Pcode at the given address.</span>

<span class="sd">        Do not use this function in a loop! Better decompile the whole function first.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">        :param address: the address to get the Pcode for.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">()</span><span class="o">.</span><span class="n">get_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[HighSymbol]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the high-level symbols for this function.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">()</span><span class="o">.</span><span class="n">symbols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">primary_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Symbol]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the primary symbols for this function.&quot;&quot;&quot;</span>
        <span class="n">symtable</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span>
        <span class="n">syms</span> <span class="o">=</span> <span class="n">symtable</span><span class="o">.</span><span class="n">getPrimarySymbolIterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBody</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">syms</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Symbol]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the symbols for this function.</span>

<span class="sd">        Unfortunately, the implementation of this function has to iterate over</span>
<span class="sd">        all function addresses (because SymbolTable doesn&#39;t export the right method),</span>
<span class="sd">        so it may be quite slow when called frequently. Consider using primary_symbols</span>
<span class="sd">        if adequate.&quot;&quot;&quot;</span>
        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBody</span><span class="p">()</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">symtable</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rng</span> <span class="ow">in</span> <span class="n">body</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">rng</span><span class="p">:</span>
                <span class="n">symbols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">symtable</span><span class="o">.</span><span class="n">getSymbols</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the set of addresses of this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBody</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">control_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Graph[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the control flow graph of this function.</span>

<span class="sd">        In other words, get a graph that represents how the control flow</span>
<span class="sd">        can move between basic blocks in this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basicblocks</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">destinations</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">emulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># type: (int, Emulator) -&gt; Emulator</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emulate the function call with the given arguments.</span>

<span class="sd">        The arguments are passed using a calling convention defined in Ghidra. If</span>
<span class="sd">        you want to use a different calling convention, or do additional setup,</span>
<span class="sd">        you have to use the Emulator class directly.</span>

<span class="sd">        You can pass your own emulator using the `emulator` kwarg. You can use this</span>
<span class="sd">        to do a pre-call setup (for example, write string parameters to memory). But</span>
<span class="sd">        don&#39;t use this to change call parameters, as they are always overwriten.</span>

<span class="sd">            &gt;&gt;&gt; fnc = Function(0x004061EC)</span>
<span class="sd">            &gt;&gt;&gt; emu = fnc.emulate(-0x80000000)</span>
<span class="sd">            &gt;&gt;&gt; emu.read_unicode(emu[&quot;eax&quot;])</span>
<span class="sd">            &quot;HKEY_CLASSES_ROOT&quot;</span>

<span class="sd">        :param args: The arguments to pass to the function.</span>
<span class="sd">        :param kwargs: pass `emulator` kwarg to use the provided emulator</span>
<span class="sd">          (default: create a new one).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;emulator&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Jython doesn&#39;t support keyword arguments after args, apparently</span>
            <span class="n">emulator</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;emulator&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">emulator</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getParameters</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong number of arguments for </span><span class="si">{}</span><span class="s2"> - got </span><span class="si">{}</span><span class="s2"> expected </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getParameters</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
            <span class="n">emulator</span><span class="o">.</span><span class="n">write_varnode</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">varnode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">emulator</span><span class="o">.</span><span class="n">emulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">stop_when</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="n">pc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">emulator</span>

    <span class="k">def</span> <span class="nf">symbolic_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; SymbolicPropogator</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a SymbolicPropogator instance for this function.</span>

<span class="sd">        This can be used to get a known values of registers at various addresses.</span>

<span class="sd">            &gt;&gt;&gt; fnc = Function(0x004061EC)</span>
<span class="sd">            &gt;&gt;&gt; ctx = fnc.symbolic_context()</span>
<span class="sd">            &gt;&gt;&gt; print(ctx.register(0x004061fb, &quot;eax&quot;))</span>

<span class="sd">        TODO: This method should implement a hack described in</span>
<span class="sd">        https://github.com/NationalSecurityAgency/ghidra/issues/3581</span>
<span class="sd">        because built-in Ghidra symbolic propagator doesn&#39;t support memory accesses.</span>

<span class="sd">        :return: a SymbolicPropogator instance with this function context.&quot;&quot;&quot;</span>
        <span class="n">propagator</span> <span class="o">=</span> <span class="n">SymbolicPropogator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="n">evaluator</span> <span class="o">=</span> <span class="n">ConstantPropagationContextEvaluator</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
        <span class="n">propagator</span><span class="o">.</span><span class="n">flow_constants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">propagator</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.UNDERLYING_CLASS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">UNDERLYING_CLASS</span> <span class="o">=</span> <span class="n">GhFunction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.basicblocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basicblocks</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the basic blocks of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the set of addresses of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.called" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">called</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all functions that are called by this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.callers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callers</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all functions that call this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.calls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calls</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all function calls to this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.clang_tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clang_tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get clang tokens for the decompiled function.</p>
<p>This returns a ClangTokenGroup object. TODO: wrap the return value.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the comment of this function, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.control_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">control_flow</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the control flow graph of this function.</p>
<p>In other words, get a graph that represents how the control flow
can move between basic blocks in this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.entrypoint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">entrypoint</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the entrypoint of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.exitpoints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exitpoints</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of exit points for the function.</p>
<p>This will return a list of addresses of function terminators. For example,
if a function has two RETs, this function will return their addresses.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.fixup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fixup</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the fixup of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.high_basicblocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_basicblocks</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the (high-level) Pcode basic blocks for this function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.high_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_function</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Decompile this function, and return a high-level function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.high_pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the (high-level) Pcode for this function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.high_symbols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_symbols</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the high-level symbols for this function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.high_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_variables</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all variables defined in this function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instructions</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the assembler instructions for this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.is_external" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_external</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this function is external.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.is_thunk" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_thunk</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this function is a thunk.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.local_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">local_variables</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the local variables of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameters</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the parameters of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the (low-level) Pcode for this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.pcode_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode_tree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an AST-like representation of the function's Pcode.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.primary_symbols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">primary_symbols</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the primary symbols for this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.repeatable_comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">repeatable_comment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the repeatable comment of this function, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.return_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">return_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the return type of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.return_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">return_variable</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the variable representing a return value of this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.stack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stack</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the defined stack variables (both parameters and locals).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.symbols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbols</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the symbols for this function.</p>
<p>Unfortunately, the implementation of this function has to iterate over
all function addresses (because SymbolTable doesn't export the right method),
so it may be quite slow when called frequently. Consider using primary_symbols
if adequate.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">variables</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all variables defined in this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all varnodes associated with a variable in this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.xref_addrs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xref_addrs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the source addresses of references to this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.xrefs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the references to this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Function.xrefs_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs_to</span> <span class="o">=</span> <span class="n">xrefs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.add_named_parameter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_named_parameter</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a parameter with a specified name to this function.</p>
<p>Warning: adding a register parameter will switch the function into
custom storage mode. Adding named parameters in custom storage is not
implemented</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_named_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (DataT, str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a parameter with a specified name to this function.</span>

<span class="sd">    Warning: adding a register parameter will switch the function into</span>
<span class="sd">    custom storage mode. Adding named parameters in custom storage is not</span>
<span class="sd">    implemented&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasCustomVariableStorage</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Sorry, adding named parameters is not implemented &quot;</span>
            <span class="s2">&quot;for functions with custom storage&quot;</span>
        <span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
    <span class="n">param</span> <span class="o">=</span> <span class="n">ParameterImpl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.add_register_parameter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_register_parameter</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a parameter stored in a specified register to this function.</p>
<p>Warning: adding a register parameter will switch the function into
custom storage mode. Adding named parameters in custom storage will
not work anymore</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_register_parameter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">name</span>
<span class="p">):</span>  <span class="c1"># type: (DataT, Reg, str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a parameter stored in a specified register to this function.</span>

<span class="sd">    Warning: adding a register parameter will switch the function into</span>
<span class="sd">    custom storage mode. Adding named parameters in custom storage will</span>
<span class="sd">    not work anymore&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasCustomVariableStorage</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setCustomVariableStorage</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
    <span class="n">param</span> <span class="o">=</span> <span class="n">ParameterImpl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return all functions in the current program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return all functions in the current program.&quot;&quot;&quot;</span>
    <span class="n">raw_functions</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctionManager</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctions</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Function</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">raw_functions</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new function at the given address with the given name.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (Addr, str) -&gt; Function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new function at the given address with the given name.&quot;&quot;&quot;</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">createFunction</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.decompile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decompile</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get decompiled C code for the function as string.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decompile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get decompiled C code for the function as string.&quot;&quot;&quot;</span>
    <span class="n">decompiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompile</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">decompiled</span><span class="o">.</span><span class="n">getDecompiledFunction</span><span class="p">()</span><span class="o">.</span><span class="n">getC</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.emulate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">emulate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Emulate the function call with the given arguments.</p>
<p>The arguments are passed using a calling convention defined in Ghidra. If
you want to use a different calling convention, or do additional setup,
you have to use the Emulator class directly.</p>
<p>You can pass your own emulator using the <code>emulator</code> kwarg. You can use this
to do a pre-call setup (for example, write string parameters to memory). But
don't use this to change call parameters, as they are always overwriten.</p>
<pre><code>&gt;&gt;&gt; fnc = Function(0x004061EC)
&gt;&gt;&gt; emu = fnc.emulate(-0x80000000)
&gt;&gt;&gt; emu.read_unicode(emu["eax"])
"HKEY_CLASSES_ROOT"
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>args</code></b>
              –
              <div class="doc-md-description">
                <p>The arguments to pass to the function.</p>
              </div>
            </li>
            <li>
              <b><code>kwargs</code></b>
              –
              <div class="doc-md-description">
                <p>pass <code>emulator</code> kwarg to use the provided emulator (default: create a new one).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">emulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># type: (int, Emulator) -&gt; Emulator</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Emulate the function call with the given arguments.</span>

<span class="sd">    The arguments are passed using a calling convention defined in Ghidra. If</span>
<span class="sd">    you want to use a different calling convention, or do additional setup,</span>
<span class="sd">    you have to use the Emulator class directly.</span>

<span class="sd">    You can pass your own emulator using the `emulator` kwarg. You can use this</span>
<span class="sd">    to do a pre-call setup (for example, write string parameters to memory). But</span>
<span class="sd">    don&#39;t use this to change call parameters, as they are always overwriten.</span>

<span class="sd">        &gt;&gt;&gt; fnc = Function(0x004061EC)</span>
<span class="sd">        &gt;&gt;&gt; emu = fnc.emulate(-0x80000000)</span>
<span class="sd">        &gt;&gt;&gt; emu.read_unicode(emu[&quot;eax&quot;])</span>
<span class="sd">        &quot;HKEY_CLASSES_ROOT&quot;</span>

<span class="sd">    :param args: The arguments to pass to the function.</span>
<span class="sd">    :param kwargs: pass `emulator` kwarg to use the provided emulator</span>
<span class="sd">      (default: create a new one).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;emulator&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="c1"># Jython doesn&#39;t support keyword arguments after args, apparently</span>
        <span class="n">emulator</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;emulator&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">emulator</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getParameters</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Wrong number of arguments for </span><span class="si">{}</span><span class="s2"> - got </span><span class="si">{}</span><span class="s2"> expected </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getParameters</span><span class="p">())</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">emulator</span><span class="o">.</span><span class="n">write_varnode</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">varnode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="n">emulator</span><span class="o">.</span><span class="n">emulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">stop_when</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pc</span><span class="p">:</span> <span class="n">pc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">emulator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.fixup_body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fixup_body</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fixup the function body: follow control flow and add thunks.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fixup_body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixup the function body: follow control flow and add thunks.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">CreateFunctionCmd</span><span class="o">.</span><span class="n">fixupFunctionBody</span><span class="p">(</span>
        <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return a function at the given address, or None if no function
exists there.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Function|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a function at the given address, or None if no function</span>
<span class="sd">    exists there.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">GhFunction</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getListing</span><span class="p">()</span><span class="o">.</span><span class="n">getFunctionContaining</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.get_high_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_high_function</span><span class="p">(</span><span class="n">simplify</span><span class="o">=</span><span class="s1">&#39;decompile&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decompile this function, and return a high-level function.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
<p>:simplify: the simplification style to use.
See DecompilerInterface.setSimplificationStyle.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_high_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="s2">&quot;decompile&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; HighFunction</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decompile this function, and return a high-level function.</span>

<span class="sd">    Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">    :simplify: the simplification style to use.</span>
<span class="sd">    See DecompilerInterface.setSimplificationStyle.&quot;&quot;&quot;</span>
    <span class="n">decompiled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompile</span><span class="p">(</span><span class="n">simplify</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HighFunction</span><span class="p">(</span><span class="n">decompiled</span><span class="o">.</span><span class="n">getHighFunction</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.get_high_pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_high_pcode</span><span class="p">(</span><span class="n">simplify</span><span class="o">=</span><span class="s1">&#39;decompile&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decompile this function, and return its high-level Pcode.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
<p>:simplify: the simplification style to use.
See DecompilerInterface.setSimplificationStyle.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_high_pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="s2">&quot;decompile&quot;</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; list[PcodeOp]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decompile this function, and return its high-level Pcode.</span>

<span class="sd">    Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">    :simplify: the simplification style to use.</span>
<span class="sd">    See DecompilerInterface.setSimplificationStyle.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">(</span><span class="n">simplify</span><span class="p">)</span><span class="o">.</span><span class="n">pcode</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.get_high_pcode_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the high-level Pcode at the given address.</p>
<p>Do not use this function in a loop! Better decompile the whole function first.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to get the Pcode for.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_high_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the high-level Pcode at the given address.</span>

<span class="sd">    Do not use this function in a loop! Better decompile the whole function first.</span>

<span class="sd">    Warning: this method needs to decompile the function, and is therefore slow.</span>

<span class="sd">    :param address: the address to get the Pcode for.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_high_function</span><span class="p">()</span><span class="o">.</span><span class="n">get_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Change the name of this function.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Change the name of this function.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.set_comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the comment of this function.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the comment of this function.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.set_repeatable_comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_repeatable_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the repeatable comment of this function.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_repeatable_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the repeatable comment of this function.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setRepeatableComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Function.symbolic_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbolic_context</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a SymbolicPropogator instance for this function.</p>
<p>This can be used to get a known values of registers at various addresses.</p>
<pre><code>&gt;&gt;&gt; fnc = Function(0x004061EC)
&gt;&gt;&gt; ctx = fnc.symbolic_context()
&gt;&gt;&gt; print(ctx.register(0x004061fb, "eax"))
</code></pre>
<p>TODO: This method should implement a hack described in
https://github.com/NationalSecurityAgency/ghidra/issues/3581
because built-in Ghidra symbolic propagator doesn't support memory accesses.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>a SymbolicPropogator instance with this function context.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">symbolic_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; SymbolicPropogator</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a SymbolicPropogator instance for this function.</span>

<span class="sd">    This can be used to get a known values of registers at various addresses.</span>

<span class="sd">        &gt;&gt;&gt; fnc = Function(0x004061EC)</span>
<span class="sd">        &gt;&gt;&gt; ctx = fnc.symbolic_context()</span>
<span class="sd">        &gt;&gt;&gt; print(ctx.register(0x004061fb, &quot;eax&quot;))</span>

<span class="sd">    TODO: This method should implement a hack described in</span>
<span class="sd">    https://github.com/NationalSecurityAgency/ghidra/issues/3581</span>
<span class="sd">    because built-in Ghidra symbolic propagator doesn&#39;t support memory accesses.</span>

<span class="sd">    :return: a SymbolicPropogator instance with this function context.&quot;&quot;&quot;</span>
    <span class="n">propagator</span> <span class="o">=</span> <span class="n">SymbolicPropogator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">ConstantPropagationContextEvaluator</span><span class="p">(</span><span class="n">getMonitor</span><span class="p">())</span>
    <span class="n">propagator</span><span class="o">.</span><span class="n">flow_constants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">propagator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.FunctionCall" class="doc doc-heading">
            <code>FunctionCall</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.BodyTrait" href="#ghidralib.BodyTrait">BodyTrait</a></code></p>


        <p>Represents an abstract function call.</p>
<p>Can be used to get the function being called and the parameters passed to it.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FunctionCall</span><span class="p">(</span><span class="n">BodyTrait</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an abstract function call.</span>

<span class="sd">    Can be used to get the function being called and the parameters passed to it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Function, Addr) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">called_function</span> <span class="o">=</span> <span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">caller</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Function|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the function where this function call takes place.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>

    <span class="n">calling_function</span> <span class="o">=</span> <span class="n">caller</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instruction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Instruction</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callee</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the function being called.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">called_function</span>

    <span class="k">def</span> <span class="nf">infer_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Emulator</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emulate the code before this function call, and return the state.</span>

<span class="sd">        The goal of this function is to recover the state of the CPU</span>
<span class="sd">        before the function call, as well as possible. This will work well in case</span>
<span class="sd">        the assembly looks like, for example:</span>

<span class="sd">            mov eax, 30</span>
<span class="sd">            mov ebx, DAT_encrypted_string</span>
<span class="sd">            call decrypt_string</span>

<span class="sd">        Then recovering eax them is as simple as call.infer_context()[&quot;eax&quot;].&quot;&quot;&quot;</span>
        <span class="n">basicblock</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>
        <span class="n">emu</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">()</span>
        <span class="n">emu</span><span class="o">.</span><span class="n">emulate</span><span class="p">(</span><span class="n">basicblock</span><span class="o">.</span><span class="n">start_address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">emu</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_pcodeop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; PcodeOp|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the high-level PcodeOp for this function call.</span>

<span class="sd">        High-level Pcode `call` ops have the parameters resolved, so we</span>
<span class="sd">        can use them to read them when analysing Pcode.</span>

<span class="sd">        Warning: this works on decompiled functions only, so it will work</span>
<span class="sd">          if the call is done from a region not recognised as function.</span>
<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pcode_op</span> <span class="ow">in</span> <span class="n">PcodeOp</span><span class="o">.</span><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pcode_op</span><span class="o">.</span><span class="n">opcode</span> <span class="o">!=</span> <span class="n">pcode_op</span><span class="o">.</span><span class="n">CALL</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="n">pcode_op</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No CALL at </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of the arguments passed to this function call, as high varnodes.</span>

<span class="sd">        In other words, decompile the function, and return the varnodes associated with</span>
<span class="sd">        the function parameters, as seen by Ghidra decompiler.</span>

<span class="sd">        Warning: this works on decompiled functions only, so it will work</span>
<span class="sd">          if the call is done from a region not recognised as function.</span>
<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="n">op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_pcodeop</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># skip function addr</span>

    <span class="k">def</span> <span class="nf">infer_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int|None]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of the arguments passed to this function call, as integers.</span>

<span class="sd">        This method tries to get arguments of this function, as seen by Ghidra</span>
<span class="sd">        decompiler. A limited symbolic execution is performed to resolve the pointers.</span>
<span class="sd">        If it&#39;s not possible to get an argument, None is stored in its place.</span>

<span class="sd">        Warning: this works on decompiled functions only, so it will work</span>
<span class="sd">          if the call is done from a region not recognised as function.</span>
<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">varnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_varnodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instruction</span><span class="o">.</span><span class="n">body</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.called_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">called_function</span> <span class="o">=</span> <span class="n">function</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.callee" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callee</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the function being called.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.caller" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">caller</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the function where this function call takes place.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.calling_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calling_function</span> <span class="o">=</span> <span class="n">caller</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.high_pcodeop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_pcodeop</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the high-level PcodeOp for this function call.</p>
<p>High-level Pcode <code>call</code> ops have the parameters resolved, so we
can use them to read them when analysing Pcode.</p>
<p>Warning: this works on decompiled functions only, so it will work
  if the call is done from a region not recognised as function.
Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.high_varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of the arguments passed to this function call, as high varnodes.</p>
<p>In other words, decompile the function, and return the varnodes associated with
the function parameters, as seen by Ghidra decompiler.</p>
<p>Warning: this works on decompiled functions only, so it will work
  if the call is done from a region not recognised as function.
Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.FunctionCall.instruction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instruction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.FunctionCall.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Function, Addr) -&gt; None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">called_function</span> <span class="o">=</span> <span class="n">function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.FunctionCall.infer_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">infer_args</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of the arguments passed to this function call, as integers.</p>
<p>This method tries to get arguments of this function, as seen by Ghidra
decompiler. A limited symbolic execution is performed to resolve the pointers.
If it's not possible to get an argument, None is stored in its place.</p>
<p>Warning: this works on decompiled functions only, so it will work
  if the call is done from a region not recognised as function.
Warning: this method needs to decompile the function, and is therefore slow.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">infer_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int|None]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of the arguments passed to this function call, as integers.</span>

<span class="sd">    This method tries to get arguments of this function, as seen by Ghidra</span>
<span class="sd">    decompiler. A limited symbolic execution is performed to resolve the pointers.</span>
<span class="sd">    If it&#39;s not possible to get an argument, None is stored in its place.</span>

<span class="sd">    Warning: this works on decompiled functions only, so it will work</span>
<span class="sd">      if the call is done from a region not recognised as function.</span>
<span class="sd">    Warning: this method needs to decompile the function, and is therefore slow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">varnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_varnodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">varnode</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varnode</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.FunctionCall.infer_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">infer_context</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Emulate the code before this function call, and return the state.</p>
<p>The goal of this function is to recover the state of the CPU
before the function call, as well as possible. This will work well in case
the assembly looks like, for example:</p>
<pre><code>mov eax, 30
mov ebx, DAT_encrypted_string
call decrypt_string
</code></pre>
<p>Then recovering eax them is as simple as call.infer_context()["eax"].</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">infer_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Emulator</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Emulate the code before this function call, and return the state.</span>

<span class="sd">    The goal of this function is to recover the state of the CPU</span>
<span class="sd">    before the function call, as well as possible. This will work well in case</span>
<span class="sd">    the assembly looks like, for example:</span>

<span class="sd">        mov eax, 30</span>
<span class="sd">        mov ebx, DAT_encrypted_string</span>
<span class="sd">        call decrypt_string</span>

<span class="sd">    Then recovering eax them is as simple as call.infer_context()[&quot;eax&quot;].&quot;&quot;&quot;</span>
    <span class="n">basicblock</span> <span class="o">=</span> <span class="n">BasicBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>
    <span class="n">emu</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">()</span>
    <span class="n">emu</span><span class="o">.</span><span class="n">emulate</span><span class="p">(</span><span class="n">basicblock</span><span class="o">.</span><span class="n">start_address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">emu</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.GenericT" class="doc doc-heading">
            <code>GenericT</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GenericT</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.GhidraWrapper" class="doc doc-heading">
            <code>GhidraWrapper</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


        <p>The base class for all Ghidra wrappers.</p>
<p>This function tries to be as transparent as possible - for example, it will
not raise an error on double-wrapping, or when passed instead of a
Java type.</p>
<pre><code>&gt;&gt;&gt; instr = getInstructionAt(getAddr(0x1234))
&gt;&gt;&gt; GhidraWrapper(instr)
&lt;Instruction 0x1234&gt;
&gt;&gt;&gt; GhidraWrapper(GhidraWrapper(instr))
&lt;Instruction 0x1234&gt;
&gt;&gt;&gt; getInstructionBefore(Instruction(instr))
&lt;Instruction 0x1233&gt;
</code></pre>
<p>Similarly, equality is based on the underlying Java object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GhidraWrapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The base class for all Ghidra wrappers.</span>

<span class="sd">    This function tries to be as transparent as possible - for example, it will</span>
<span class="sd">    not raise an error on double-wrapping, or when passed instead of a</span>
<span class="sd">    Java type.</span>

<span class="sd">        &gt;&gt;&gt; instr = getInstructionAt(getAddr(0x1234))</span>
<span class="sd">        &gt;&gt;&gt; GhidraWrapper(instr)</span>
<span class="sd">        &lt;Instruction 0x1234&gt;</span>
<span class="sd">        &gt;&gt;&gt; GhidraWrapper(GhidraWrapper(instr))</span>
<span class="sd">        &lt;Instruction 0x1234&gt;</span>
<span class="sd">        &gt;&gt;&gt; getInstructionBefore(Instruction(instr))</span>
<span class="sd">        &lt;Instruction 0x1233&gt;</span>

<span class="sd">    Similarly, equality is based on the underlying Java object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|int|str|GhidraWrapper) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the wrapper.</span>

<span class="sd">        This function will try to resolve the given object to a Ghidra object.</span>
<span class="sd">        The algorithm is as follows:</span>

<span class="sd">        * If &quot;raw&quot; is a primitive type (int, long, str, unicode, Address),</span>
<span class="sd">          try to resolve it with a static &quot;get&quot; method of the subclass.</span>
<span class="sd">        * If &quot;raw&quot; is a GhidraWrapper, unwrap it (so GhidraWrapper(GhidraWrapper(x))</span>
<span class="sd">          is always the same as GhidraWrapper(x).</span>
<span class="sd">        * If &quot;raw&quot; is None at this point, raise an exception.</span>
<span class="sd">        * If the subclass has attribute UNDERLYING_CLASS, assert that the wrapped</span>
<span class="sd">          type is of the expected type.</span>
<span class="sd">        * Save the final &quot;raw&quot; value.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">,</span> <span class="n">GenericAddress</span><span class="p">)):</span>
            <span class="c1"># Someone passed a primitive type to us.</span>
            <span class="c1"># If possible, try to resolve it with a &quot;get&quot; method.</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;get&quot;</span><span class="p">):</span>
                <span class="n">new_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="k">if</span> <span class="n">new_raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Show original data for better error messages</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to wrap &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>
                <span class="n">raw</span> <span class="o">=</span> <span class="n">new_raw</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to wrap a primitive: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>

        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
            <span class="c1"># In case someone tries to Function(Function(&quot;main&quot;)) us</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">raw</span>

        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Object doesn&#39;t exist (refusing to wrap None)&quot;</span><span class="p">)</span>

        <span class="c1"># TODO - remove the conditional checks and implement this everywhere</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;UNDERLYING_CLASS&quot;</span><span class="p">):</span>
            <span class="n">wrapped_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;UNDERLYING_CLASS&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">wrapped_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;You are trying to wrap </span><span class="si">{}</span><span class="s2"> as </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">raw</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_java_cast</span><span class="p">(</span><span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (Any) -&gt; JavaObject</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;This function exists only to make type-checker happy&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">raw</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span> <span class="o">=</span> <span class="n">_java_cast</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of this object.</span>

<span class="sd">        This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of this object.</span>

<span class="sd">        This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__tojava__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">klass</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make it possible to pass this object to Java methods.</span>

<span class="sd">        This only works in Jython, I didn&#39;t find a way to do this in JPype yet.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the hash of this object.</span>

<span class="sd">        This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hashCode</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this object is equal to another.</span>

<span class="sd">        This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.GhidraWrapper.raw" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">raw</span> <span class="o">=</span> <span class="n">_java_cast</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this object is equal to another.</p>
<p>This just forwards the call to the underlying object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this object is equal to another.</span>

<span class="sd">    This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__hash__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the hash of this object.</p>
<p>This just forwards the call to the underlying object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the hash of this object.</span>

<span class="sd">    This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hashCode</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the wrapper.</p>
<p>This function will try to resolve the given object to a Ghidra object.
The algorithm is as follows:</p>
<ul>
<li>If "raw" is a primitive type (int, long, str, unicode, Address),
  try to resolve it with a static "get" method of the subclass.</li>
<li>If "raw" is a GhidraWrapper, unwrap it (so GhidraWrapper(GhidraWrapper(x))
  is always the same as GhidraWrapper(x).</li>
<li>If "raw" is None at this point, raise an exception.</li>
<li>If the subclass has attribute UNDERLYING_CLASS, assert that the wrapped
  type is of the expected type.</li>
<li>Save the final "raw" value.</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|int|str|GhidraWrapper) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the wrapper.</span>

<span class="sd">    This function will try to resolve the given object to a Ghidra object.</span>
<span class="sd">    The algorithm is as follows:</span>

<span class="sd">    * If &quot;raw&quot; is a primitive type (int, long, str, unicode, Address),</span>
<span class="sd">      try to resolve it with a static &quot;get&quot; method of the subclass.</span>
<span class="sd">    * If &quot;raw&quot; is a GhidraWrapper, unwrap it (so GhidraWrapper(GhidraWrapper(x))</span>
<span class="sd">      is always the same as GhidraWrapper(x).</span>
<span class="sd">    * If &quot;raw&quot; is None at this point, raise an exception.</span>
<span class="sd">    * If the subclass has attribute UNDERLYING_CLASS, assert that the wrapped</span>
<span class="sd">      type is of the expected type.</span>
<span class="sd">    * Save the final &quot;raw&quot; value.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">,</span> <span class="n">GenericAddress</span><span class="p">)):</span>
        <span class="c1"># Someone passed a primitive type to us.</span>
        <span class="c1"># If possible, try to resolve it with a &quot;get&quot; method.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;get&quot;</span><span class="p">):</span>
            <span class="n">new_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">new_raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Show original data for better error messages</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to wrap &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">new_raw</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to wrap a primitive: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
        <span class="c1"># In case someone tries to Function(Function(&quot;main&quot;)) us</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">raw</span>

    <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Object doesn&#39;t exist (refusing to wrap None)&quot;</span><span class="p">)</span>

    <span class="c1"># TODO - remove the conditional checks and implement this everywhere</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;UNDERLYING_CLASS&quot;</span><span class="p">):</span>
        <span class="n">wrapped_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;UNDERLYING_CLASS&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">wrapped_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;You are trying to wrap </span><span class="si">{}</span><span class="s2"> as </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">raw</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_java_cast</span><span class="p">(</span><span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (Any) -&gt; JavaObject</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function exists only to make type-checker happy&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">raw</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span> <span class="o">=</span> <span class="n">_java_cast</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of this object.</p>
<p>This just forwards the call to the underlying object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of this object.</span>

<span class="sd">    This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of this object.</p>
<p>This just forwards the call to the underlying object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of this object.</span>

<span class="sd">    This just forwards the call to the underlying object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.GhidraWrapper.__tojava__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__tojava__</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Make it possible to pass this object to Java methods.</p>
<p>This only works in Jython, I didn't find a way to do this in JPype yet.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__tojava__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">klass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make it possible to pass this object to Java methods.</span>

<span class="sd">    This only works in Jython, I didn&#39;t find a way to do this in JPype yet.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Graph" class="doc doc-heading">
            <code>Graph</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GenericT" href="#ghidralib.GenericT">GenericT</a></code>, <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra AttributedGraph object.</p>
<p>We'd like to store arbitrary object in the graph, but it only supports
strings for keys (and names). We have a way to convert objects we are
interested in to strings - see _get_unique_string() method.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Graph</span><span class="p">(</span><span class="n">GenericT</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra AttributedGraph object.</span>

<span class="sd">    We&#39;d like to store arbitrary object in the graph, but it only supports</span>
<span class="sd">    strings for keys (and names). We have a way to convert objects we are</span>
<span class="sd">    interested in to strings - see _get_unique_string() method.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: maybe this should be a GDirectedGraph, so we get some algorithms</span>
    <span class="c1"># for free, and we can just convert it for display.</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (AttributedGraph) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Graph wrapper.</span>

<span class="sd">        We have to keep track of additional data, since AttributedGraph is a bit</span>
<span class="sd">        clunky and can only store string IDs and string values.</span>

<span class="sd">        :param raw: The AttributedGraph object to wrap.&quot;&quot;&quot;</span>
        <span class="n">GhidraWrapper</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># type: (str|None, str|None) -&gt; Graph[Any]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Graph.</span>

<span class="sd">        :param name: The name of the graph. If None, a default name will be used.</span>
<span class="sd">        :param description: The description of the graph. If</span>
<span class="sd">        None, a default description will be used.</span>
<span class="sd">        :returns: a new Graph object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;Graph&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">description</span> <span class="ow">or</span> <span class="s2">&quot;Graph&quot;</span>
        <span class="n">graphtype</span> <span class="o">=</span> <span class="n">GraphType</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">ArrayList</span><span class="p">([]),</span> <span class="n">ArrayList</span><span class="p">([]))</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">AttributedGraph</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">graphtype</span><span class="p">,</span> <span class="n">description</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
        <span class="n">vertexlist</span><span class="p">,</span> <span class="n">getedges</span>
    <span class="p">):</span>  <span class="c1"># type: (list[T], Callable[[T], list[T]]) -&gt; Graph[T]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Graph from a list of vertices and a function to get edges.</span>

<span class="sd">        :param vertexlist: The list of vertices.</span>
<span class="sd">        :param getedges: A function that gets a list of destinations from a vertex.&quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertexlist</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertexlist</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">getedges</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a given vertex exists in this graph.</span>

<span class="sd">        :param vtx: The ID of the vertex to check.&quot;&quot;&quot;</span>
        <span class="n">vid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">containsVertex</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a given vertex exists in this graph.</span>

<span class="sd">        :param vtx: The ID of the vertex to check.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">vtx</span> <span class="ow">in</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># type: (T, str|None) -&gt; T</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or create a vertex in this graph.</span>

<span class="sd">        :param vtx: The ID of the new vertex, or any &quot;Vertexable&quot; object</span>
<span class="sd">        that can be used to identify the vertex.</span>
<span class="sd">        :param name: The name of the vertex. If not provided,</span>
<span class="sd">        the ID will be used as the name.</span>
<span class="sd">        :returns: vtx parameter is returned&quot;&quot;&quot;</span>
        <span class="n">vid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">vid</span><span class="p">]</span> <span class="o">=</span> <span class="n">vtx</span>
        <span class="k">return</span> <span class="n">vtx</span>

    <span class="k">def</span> <span class="nf">edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>  <span class="c1"># type: (T, T) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an edge between two vertices in this graph.</span>

<span class="sd">        :param src: The source vertex ID.</span>
<span class="sd">        :param dst: The destination vertex ID.&quot;&quot;&quot;</span>
        <span class="n">srcid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
        <span class="n">dstid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
        <span class="n">srcobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">srcid</span><span class="p">)</span>
        <span class="n">dstobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">dstid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addEdge</span><span class="p">(</span><span class="n">srcobj</span><span class="p">,</span> <span class="n">dstobj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[T]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all vertices in this graph.</span>

<span class="sd">        Warning: this constructs the list every time, so it&#39;s not a light operation.</span>
<span class="sd">        Use vertex_count for counting.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span> <span class="k">for</span> <span class="n">vid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vertex_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of vertices in this graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of vertices in this graph.</span>

<span class="sd">        To get the number of edges, use edge_count.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_count</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[tuple[T, T]]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all edges in this graph.</span>

<span class="sd">        Warning: this constructs the list every time, so it&#39;s not a light operation.</span>
<span class="sd">        Use edge_count for counting.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgeSet</span><span class="p">():</span>
            <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeSource</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">frmobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">frm</span><span class="p">)</span>
            <span class="n">toobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">frmobj</span><span class="p">,</span> <span class="n">toobj</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">edge_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of edges in this graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgeSet</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of this graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the description of this graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a DOT representation of this graph.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;digraph </span><span class="si">{}</span><span class="s2"> {{&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;    &quot;</span><span class="si">{}</span><span class="s1">&quot; [label=&quot;</span><span class="si">{}</span><span class="s1">&quot;];&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">getId</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">getName</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgeSet</span><span class="p">():</span>
            <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeSource</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;    &quot;</span><span class="si">{}</span><span class="s1">&quot; -&gt; &quot;</span><span class="si">{}</span><span class="s1">&quot;;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frm</span><span class="o">.</span><span class="n">getId</span><span class="p">(),</span> <span class="n">to</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display this graph in the Ghidra GUI.&quot;&quot;&quot;</span>
        <span class="n">graphtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getGraphType</span><span class="p">()</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">graphtype</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">GraphDisplayOptions</span><span class="p">(</span><span class="n">graphtype</span><span class="p">)</span>

        <span class="n">broker</span> <span class="o">=</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">GraphDisplayBroker</span><span class="p">)</span>
        <span class="n">display</span> <span class="o">=</span> <span class="n">broker</span><span class="o">.</span><span class="n">getDefaultGraphDisplay</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
        <span class="n">display</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">__resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vid</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; T</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve a vertex ID to a vertex object.</span>

<span class="sd">        :param vid: The ID of the vertex to resolve.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">vid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">vid</span>  <span class="c1"># type: ignore graph created outside of ghidralib?</span>

    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span>
    <span class="p">):</span>  <span class="c1"># type: (T, Callable[[T], None]) -&gt; dict[T, T|None]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a depth-first search on this graph, starting from the given vertex.</span>

<span class="sd">        The callback will be called for each vertex visited when first visited, and</span>
<span class="sd">        the returned value is a dictionary of parent vertices for each visited vertex.</span>

<span class="sd">            &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">            &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">            &gt;&gt;&gt; g.dfs(a)</span>
<span class="sd">            {&#39;a&#39;: None, &#39;b&#39;: &#39;a&#39;, &#39;c&#39;: &#39;b&#39;}</span>

<span class="sd">        Warning: This won&#39;t reach every node in the graph, if it&#39;s not connected.</span>

<span class="sd">        :param origin: The ID of the vertex to start the search from.</span>
<span class="sd">        :param callback: A callback function to call for each vertex visited.</span>
<span class="sd">        :returns: A dictionary of parent vertices for each visited vertex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tovisit</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="p">{</span><span class="n">origin</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>  <span class="c1"># type: dict[T, T|None]</span>
        <span class="k">while</span> <span class="n">tovisit</span><span class="p">:</span>
            <span class="n">parent</span><span class="p">,</span> <span class="n">vid</span> <span class="o">=</span> <span class="n">tovisit</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
            <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
            <span class="n">parents</span><span class="p">[</span><span class="n">vobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
                <span class="n">tovisit</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">parents</span>

    <span class="k">def</span> <span class="nf">toposort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; list[T]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a topological sort on this graph, starting from the given vertex.</span>
<span class="sd">        :param origin: The ID of the vertex to start the sort from.</span>

<span class="sd">        The order is such that if there is an edge from A to B, then A will come</span>
<span class="sd">        before B in the list. This means that if the graph is connected and acyclic</span>
<span class="sd">        then &quot;origin&quot; will be the last element in the list.</span>

<span class="sd">        On a practical example, for a call graph, this means that if A calls B, then</span>
<span class="sd">        B will be before A in the list - so if you want to process from the bottom up,</span>
<span class="sd">        you should use the entry point of the program as the origin. In the example</span>
<span class="sd">        below, the entry point is &quot;a&quot;, &quot;a&quot; calls &quot;b&quot;, and &quot;b&quot; calls &quot;c&quot;:</span>

<span class="sd">            &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">            &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">            &gt;&gt;&gt; g.toposort(a)</span>
<span class="sd">            [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;]</span>

<span class="sd">        :param origin: The ID of the origin vertex to start the sort from.</span>
<span class="sd">        :returns: a list of vertex IDs in topological order.&quot;&quot;&quot;</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">vid</span><span class="p">):</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                    <span class="n">dfs</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">))</span>

        <span class="n">dfs</span><span class="p">(</span><span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">vid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">vid</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">vid</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span>
    <span class="p">):</span>  <span class="c1"># type: (T, Callable[[T], None]) -&gt; dict[T, T|None]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a breadth-first search on this graph, starting from the given vertex.</span>

<span class="sd">        The callback will be called for each vertex visited when first visited, and</span>
<span class="sd">        the returned value is a dictionary of parent vertices for each visited vertex.</span>

<span class="sd">            &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">            &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">            &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">            &gt;&gt;&gt; g.bfs(a)</span>
<span class="sd">            {&#39;a&#39;: None, &#39;b&#39;: &#39;a&#39;, &#39;c&#39;: &#39;b&#39;}</span>

<span class="sd">        Warning: This won&#39;t reach every node in the graph, if it&#39;s not connected.</span>

<span class="sd">        :param origin: The ID of the vertex to start the search from.</span>
<span class="sd">        :param callback: A callback function to call for each vertex visited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tovisit</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="p">{</span><span class="n">origin</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>  <span class="c1"># type: dict[T, T|None]</span>
        <span class="k">while</span> <span class="n">tovisit</span><span class="p">:</span>
            <span class="n">parent</span><span class="p">,</span> <span class="n">vid</span> <span class="o">=</span> <span class="n">tovisit</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
            <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
            <span class="n">parents</span><span class="p">[</span><span class="n">vobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
                <span class="n">tovisit</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">parents</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.description" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">description</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the description of this graph.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.edge_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edge_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the number of edges in this graph.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all edges in this graph.</p>
<p>Warning: this constructs the list every time, so it's not a light operation.
Use edge_count for counting.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the name of this graph.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.vertex_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the number of vertices in this graph.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Graph.vertices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all vertices in this graph.</p>
<p>Warning: this constructs the list every time, so it's not a light operation.
Use vertex_count for counting.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a given vertex exists in this graph.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vtx</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to check.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a given vertex exists in this graph.</span>

<span class="sd">    :param vtx: The ID of the vertex to check.&quot;&quot;&quot;</span>
    <span class="n">vid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
    <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">containsVertex</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new Graph wrapper.</p>
<p>We have to keep track of additional data, since AttributedGraph is a bit
clunky and can only store string IDs and string values.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>raw</code></b>
              –
              <div class="doc-md-description">
                <p>The AttributedGraph object to wrap.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>  <span class="c1"># type: (AttributedGraph) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Graph wrapper.</span>

<span class="sd">    We have to keep track of additional data, since AttributedGraph is a bit</span>
<span class="sd">    clunky and can only store string IDs and string values.</span>

<span class="sd">    :param raw: The AttributedGraph object to wrap.&quot;&quot;&quot;</span>
    <span class="n">GhidraWrapper</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the number of vertices in this graph.</p>
<p>To get the number of edges, use edge_count.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of vertices in this graph.</span>

<span class="sd">    To get the number of edges, use edge_count.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_count</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.__resolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resolve a vertex ID to a vertex object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vid</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to resolve.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vid</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; T</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolve a vertex ID to a vertex object.</span>

<span class="sd">    :param vid: The ID of the vertex to resolve.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">vid</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vid</span>  <span class="c1"># type: ignore graph created outside of ghidralib?</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.bfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bfs</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform a breadth-first search on this graph, starting from the given vertex.</p>
<p>The callback will be called for each vertex visited when first visited, and
the returned value is a dictionary of parent vertices for each visited vertex.</p>
<pre><code>&gt;&gt;&gt; g = Graph.create()
&gt;&gt;&gt; a, b, c = g.vertex("a"), g.vertex("b"), g.vertex("c")
&gt;&gt;&gt; g.edge(a, b)
&gt;&gt;&gt; g.edge(b, c)
&gt;&gt;&gt; g.bfs(a)
{'a': None, 'b': 'a', 'c': 'b'}
</code></pre>
<p>Warning: This won't reach every node in the graph, if it's not connected.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>origin</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to start the search from.</p>
              </div>
            </li>
            <li>
              <b><code>callback</code></b>
              –
              <div class="doc-md-description">
                <p>A callback function to call for each vertex visited.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">):</span>  <span class="c1"># type: (T, Callable[[T], None]) -&gt; dict[T, T|None]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a breadth-first search on this graph, starting from the given vertex.</span>

<span class="sd">    The callback will be called for each vertex visited when first visited, and</span>
<span class="sd">    the returned value is a dictionary of parent vertices for each visited vertex.</span>

<span class="sd">        &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">        &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">        &gt;&gt;&gt; g.bfs(a)</span>
<span class="sd">        {&#39;a&#39;: None, &#39;b&#39;: &#39;a&#39;, &#39;c&#39;: &#39;b&#39;}</span>

<span class="sd">    Warning: This won&#39;t reach every node in the graph, if it&#39;s not connected.</span>

<span class="sd">    :param origin: The ID of the vertex to start the search from.</span>
<span class="sd">    :param callback: A callback function to call for each vertex visited.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tovisit</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">parents</span> <span class="o">=</span> <span class="p">{</span><span class="n">origin</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>  <span class="c1"># type: dict[T, T|None]</span>
    <span class="k">while</span> <span class="n">tovisit</span><span class="p">:</span>
        <span class="n">parent</span><span class="p">,</span> <span class="n">vid</span> <span class="o">=</span> <span class="n">tovisit</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="n">parents</span><span class="p">[</span><span class="n">vobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
            <span class="n">tovisit</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">parents</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.construct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">construct</span><span class="p">(</span><span class="n">vertexlist</span><span class="p">,</span> <span class="n">getedges</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new Graph from a list of vertices and a function to get edges.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vertexlist</code></b>
              –
              <div class="doc-md-description">
                <p>The list of vertices.</p>
              </div>
            </li>
            <li>
              <b><code>getedges</code></b>
              –
              <div class="doc-md-description">
                <p>A function that gets a list of destinations from a vertex.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">vertexlist</span><span class="p">,</span> <span class="n">getedges</span>
<span class="p">):</span>  <span class="c1"># type: (list[T], Callable[[T], list[T]]) -&gt; Graph[T]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Graph from a list of vertices and a function to get edges.</span>

<span class="sd">    :param vertexlist: The list of vertices.</span>
<span class="sd">    :param getedges: A function that gets a list of destinations from a vertex.&quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertexlist</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertexlist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">getedges</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new Graph.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
              –
              <div class="doc-md-description">
                <p>The name of the graph. If None, a default name will be used.</p>
              </div>
            </li>
            <li>
              <b><code>description</code></b>
              –
              <div class="doc-md-description">
                <p>The description of the graph. If None, a default description will be used.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>a new Graph object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># type: (str|None, str|None) -&gt; Graph[Any]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Graph.</span>

<span class="sd">    :param name: The name of the graph. If None, a default name will be used.</span>
<span class="sd">    :param description: The description of the graph. If</span>
<span class="sd">    None, a default description will be used.</span>
<span class="sd">    :returns: a new Graph object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;Graph&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">description</span> <span class="ow">or</span> <span class="s2">&quot;Graph&quot;</span>
    <span class="n">graphtype</span> <span class="o">=</span> <span class="n">GraphType</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">ArrayList</span><span class="p">([]),</span> <span class="n">ArrayList</span><span class="p">([]))</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">AttributedGraph</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">graphtype</span><span class="p">,</span> <span class="n">description</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dfs</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform a depth-first search on this graph, starting from the given vertex.</p>
<p>The callback will be called for each vertex visited when first visited, and
the returned value is a dictionary of parent vertices for each visited vertex.</p>
<pre><code>&gt;&gt;&gt; g = Graph.create()
&gt;&gt;&gt; a, b, c = g.vertex("a"), g.vertex("b"), g.vertex("c")
&gt;&gt;&gt; g.edge(a, b)
&gt;&gt;&gt; g.edge(b, c)
&gt;&gt;&gt; g.dfs(a)
{'a': None, 'b': 'a', 'c': 'b'}
</code></pre>
<p>Warning: This won't reach every node in the graph, if it's not connected.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>origin</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to start the search from.</p>
              </div>
            </li>
            <li>
              <b><code>callback</code></b>
              –
              <div class="doc-md-description">
                <p>A callback function to call for each vertex visited.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>A dictionary of parent vertices for each visited vertex.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">):</span>  <span class="c1"># type: (T, Callable[[T], None]) -&gt; dict[T, T|None]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a depth-first search on this graph, starting from the given vertex.</span>

<span class="sd">    The callback will be called for each vertex visited when first visited, and</span>
<span class="sd">    the returned value is a dictionary of parent vertices for each visited vertex.</span>

<span class="sd">        &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">        &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">        &gt;&gt;&gt; g.dfs(a)</span>
<span class="sd">        {&#39;a&#39;: None, &#39;b&#39;: &#39;a&#39;, &#39;c&#39;: &#39;b&#39;}</span>

<span class="sd">    Warning: This won&#39;t reach every node in the graph, if it&#39;s not connected.</span>

<span class="sd">    :param origin: The ID of the vertex to start the search from.</span>
<span class="sd">    :param callback: A callback function to call for each vertex visited.</span>
<span class="sd">    :returns: A dictionary of parent vertices for each visited vertex.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tovisit</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">parents</span> <span class="o">=</span> <span class="p">{</span><span class="n">origin</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>  <span class="c1"># type: dict[T, T|None]</span>
    <span class="k">while</span> <span class="n">tovisit</span><span class="p">:</span>
        <span class="n">parent</span><span class="p">,</span> <span class="n">vid</span> <span class="o">=</span> <span class="n">tovisit</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="n">parents</span><span class="p">[</span><span class="n">vobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">vobj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
            <span class="n">tovisit</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">parents</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edge</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create an edge between two vertices in this graph.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src</code></b>
              –
              <div class="doc-md-description">
                <p>The source vertex ID.</p>
              </div>
            </li>
            <li>
              <b><code>dst</code></b>
              –
              <div class="doc-md-description">
                <p>The destination vertex ID.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>  <span class="c1"># type: (T, T) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an edge between two vertices in this graph.</span>

<span class="sd">    :param src: The source vertex ID.</span>
<span class="sd">    :param dst: The destination vertex ID.&quot;&quot;&quot;</span>
    <span class="n">srcid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">dstid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
    <span class="n">srcobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">srcid</span><span class="p">)</span>
    <span class="n">dstobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">dstid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addEdge</span><span class="p">(</span><span class="n">srcobj</span><span class="p">,</span> <span class="n">dstobj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.has_vertex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_vertex</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a given vertex exists in this graph.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vtx</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to check.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a given vertex exists in this graph.</span>

<span class="sd">    :param vtx: The ID of the vertex to check.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vtx</span> <span class="ow">in</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Display this graph in the Ghidra GUI.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display this graph in the Ghidra GUI.&quot;&quot;&quot;</span>
    <span class="n">graphtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getGraphType</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">graphtype</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">GraphDisplayOptions</span><span class="p">(</span><span class="n">graphtype</span><span class="p">)</span>

    <span class="n">broker</span> <span class="o">=</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">GraphDisplayBroker</span><span class="p">)</span>
    <span class="n">display</span> <span class="o">=</span> <span class="n">broker</span><span class="o">.</span><span class="n">getDefaultGraphDisplay</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
    <span class="n">display</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.to_dot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dot</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a DOT representation of this graph.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a DOT representation of this graph.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;digraph </span><span class="si">{}</span><span class="s2"> {{&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">():</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;    &quot;</span><span class="si">{}</span><span class="s1">&quot; [label=&quot;</span><span class="si">{}</span><span class="s1">&quot;];&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">getId</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">getName</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgeSet</span><span class="p">():</span>
        <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeSource</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;    &quot;</span><span class="si">{}</span><span class="s1">&quot; -&gt; &quot;</span><span class="si">{}</span><span class="s1">&quot;;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frm</span><span class="o">.</span><span class="n">getId</span><span class="p">(),</span> <span class="n">to</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.toposort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">toposort</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform a topological sort on this graph, starting from the given vertex.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>origin</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the vertex to start the sort from.  The order is such that if there is an edge from A to B, then A will come before B in the list. This means that if the graph is connected and acyclic then "origin" will be the last element in the list.  On a practical example, for a call graph, this means that if A calls B, then B will be before A in the list - so if you want to process from the bottom up, you should use the entry point of the program as the origin. In the example below, the entry point is "a", "a" calls "b", and "b" calls "c":  &gt;&gt;&gt; g = Graph.create() &gt;&gt;&gt; a, b, c = g.vertex("a"), g.vertex("b"), g.vertex("c") &gt;&gt;&gt; g.edge(a, b) &gt;&gt;&gt; g.edge(b, c) &gt;&gt;&gt; g.toposort(a) ['c', 'b', 'a']</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>a list of vertex IDs in topological order.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">toposort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>  <span class="c1"># type: (T) -&gt; list[T]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a topological sort on this graph, starting from the given vertex.</span>
<span class="sd">    :param origin: The ID of the vertex to start the sort from.</span>

<span class="sd">    The order is such that if there is an edge from A to B, then A will come</span>
<span class="sd">    before B in the list. This means that if the graph is connected and acyclic</span>
<span class="sd">    then &quot;origin&quot; will be the last element in the list.</span>

<span class="sd">    On a practical example, for a call graph, this means that if A calls B, then</span>
<span class="sd">    B will be before A in the list - so if you want to process from the bottom up,</span>
<span class="sd">    you should use the entry point of the program as the origin. In the example</span>
<span class="sd">    below, the entry point is &quot;a&quot;, &quot;a&quot; calls &quot;b&quot;, and &quot;b&quot; calls &quot;c&quot;:</span>

<span class="sd">        &gt;&gt;&gt; g = Graph.create()</span>
<span class="sd">        &gt;&gt;&gt; a, b, c = g.vertex(&quot;a&quot;), g.vertex(&quot;b&quot;), g.vertex(&quot;c&quot;)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(a, b)</span>
<span class="sd">        &gt;&gt;&gt; g.edge(b, c)</span>
<span class="sd">        &gt;&gt;&gt; g.toposort(a)</span>
<span class="sd">        [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;]</span>

<span class="sd">    :param origin: The ID of the origin vertex to start the sort from.</span>
<span class="sd">    :returns: a list of vertex IDs in topological order.&quot;&quot;&quot;</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">vid</span><span class="p">):</span>
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">edgesOf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">)):</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEdgeTarget</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__resolve</span><span class="p">(</span><span class="n">vid</span><span class="p">))</span>

    <span class="n">dfs</span><span class="p">(</span><span class="n">_get_unique_string</span><span class="p">(</span><span class="n">origin</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">vid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">vertexSet</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">vid</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">vid</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Graph.vertex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex</span><span class="p">(</span><span class="n">vtx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get or create a vertex in this graph.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vtx</code></b>
              –
              <div class="doc-md-description">
                <p>The ID of the new vertex, or any "Vertexable" object that can be used to identify the vertex.</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
              –
              <div class="doc-md-description">
                <p>The name of the vertex. If not provided, the ID will be used as the name.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>vtx parameter is returned</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># type: (T, str|None) -&gt; T</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get or create a vertex in this graph.</span>

<span class="sd">    :param vtx: The ID of the new vertex, or any &quot;Vertexable&quot; object</span>
<span class="sd">    that can be used to identify the vertex.</span>
<span class="sd">    :param name: The name of the vertex. If not provided,</span>
<span class="sd">    the ID will be used as the name.</span>
<span class="sd">    :returns: vtx parameter is returned&quot;&quot;&quot;</span>
    <span class="n">vid</span> <span class="o">=</span> <span class="n">_get_unique_string</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">vtx</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addVertex</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">vid</span><span class="p">]</span> <span class="o">=</span> <span class="n">vtx</span>
    <span class="k">return</span> <span class="n">vtx</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.HighFunction" class="doc doc-heading">
            <code>HighFunction</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HighFunction</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; HighFunction|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a HighFunction at a given address, or None if there is none.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">GhHighFunction</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">HighFunction</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">Function</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="n">high_function</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying function of this high function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFunction</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of PcodeOps at a given address.</span>

<span class="sd">        This list may be empty even if there are instructions at that address.&quot;&quot;&quot;</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPcodeOps</span><span class="p">(</span><span class="n">address</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of all high PcodeOps in this function.</span>

<span class="sd">        Note: high PcodeOps are called PcodeOpAST internally.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPcodeOps</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Graph[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a data flow graph of varnodes in this function.</span>

<span class="sd">        Note: I don&#39;t think this method is currently very useful, but you can</span>
<span class="sd">        use it to easily get information about all varnodes that impact a value of</span>
<span class="sd">        another varnode</span>

<span class="sd">        :returns: A graph where vertexes are varnodes, and edges mean that</span>
<span class="sd">        target varnode is a result of operation on source varnodes.&quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcode</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">op</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">basicblocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of basic blocks in this high function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBasicBlocks</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; BlockGraph</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an AST-like representation of the function&#39;s Pcode.</span>

<span class="sd">        Warning: this method needs to decompile the function, and is therefore slow.&quot;&quot;&quot;</span>
        <span class="n">edge_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ingraph</span> <span class="o">=</span> <span class="n">GhBlockGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basicblocks</span><span class="p">:</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">BlockCopy</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">block</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStart</span><span class="p">())</span>
            <span class="n">ingraph</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">gb</span><span class="p">)</span>
            <span class="n">edge_map</span><span class="p">[</span><span class="n">block</span><span class="o">.</span><span class="n">raw</span><span class="p">]</span> <span class="o">=</span> <span class="n">gb</span>

        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basicblocks</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">outgoing_edges</span><span class="p">:</span>
                <span class="n">ingraph</span><span class="o">.</span><span class="n">addEdge</span><span class="p">(</span><span class="n">edge_map</span><span class="p">[</span><span class="n">block</span><span class="o">.</span><span class="n">raw</span><span class="p">],</span> <span class="n">edge_map</span><span class="p">[</span><span class="n">edge</span><span class="o">.</span><span class="n">raw</span><span class="p">])</span>

        <span class="n">ingraph</span><span class="o">.</span><span class="n">setIndices</span><span class="p">()</span>
        <span class="n">decompiler</span> <span class="o">=</span> <span class="n">DecompInterface</span><span class="p">()</span>
        <span class="n">decompiler</span><span class="o">.</span><span class="n">openProgram</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
        <span class="n">outgraph</span> <span class="o">=</span> <span class="n">decompiler</span><span class="o">.</span><span class="n">structureGraph</span><span class="p">(</span><span class="n">ingraph</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">BlockGraph</span><span class="p">(</span><span class="n">outgraph</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all varnodes used in this function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Varnode</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">locRange</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[HighSymbol]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get high symbols used in this function (including parameters).&quot;&quot;&quot;</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLocalSymbolMap</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">HighSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">getSymbols</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[HighVariable]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get high variables defined in this function.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">variable</span>
            <span class="k">if</span> <span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare two high functions.</span>

<span class="sd">        Fun fact - Ghidra doesn&#39;t know how to do this.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HighFunction</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">function</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.basicblocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basicblocks</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of basic blocks in this high function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.data_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_flow</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a data flow graph of varnodes in this function.</p>
<p>Note: I don't think this method is currently very useful, but you can
use it to easily get information about all varnodes that impact a value of
another varnode</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>A graph where vertexes are varnodes, and edges mean that target varnode is a result of operation on source varnodes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">function</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the underlying function of this high function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of all high PcodeOps in this function.</p>
<p>Note: high PcodeOps are called PcodeOpAST internally.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.pcode_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode_tree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an AST-like representation of the function's Pcode.</p>
<p>Warning: this method needs to decompile the function, and is therefore slow.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.symbols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbols</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get high symbols used in this function (including parameters).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">variables</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get high variables defined in this function.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighFunction.varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all varnodes used in this function.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.HighFunction.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compare two high functions.</p>
<p>Fun fact - Ghidra doesn't know how to do this.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (object) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two high functions.</span>

<span class="sd">    Fun fact - Ghidra doesn&#39;t know how to do this.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HighFunction</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">function</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.HighFunction.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a HighFunction at a given address, or None if there is none.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; HighFunction|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a HighFunction at a given address, or None if there is none.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">GhHighFunction</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HighFunction</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">Function</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="n">high_function</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.HighFunction.get_pcode_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of PcodeOps at a given address.</p>
<p>This list may be empty even if there are instructions at that address.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of PcodeOps at a given address.</span>

<span class="sd">    This list may be empty even if there are instructions at that address.&quot;&quot;&quot;</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPcodeOps</span><span class="p">(</span><span class="n">address</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.HighSymbol" class="doc doc-heading">
            <code>HighSymbol</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HighSymbol</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename this high symbol.</span>

<span class="sd">        :param new_name: The new name of the symbol</span>
<span class="sd">        :param source: The source of the symbol&quot;&quot;&quot;</span>
        <span class="n">HighFunctionDBUtil</span><span class="o">.</span><span class="n">updateDBVariable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the size of this symbol in bytes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the data type of this symbol&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDataType</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; HighVariable|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the high variable associated with this symbol, if any.</span>

<span class="sd">        The symbol may have multiple HighVariables associated with it.</span>
<span class="sd">        This method returns the biggest one.&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getHighVariable</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">HighVariable</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of this symbol&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Symbol|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the corresponding symbol, if it exists.&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_this_pointer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this symbol is a &quot;this&quot; pointer for a class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isThisPointer</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.data_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the data type of this symbol</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.is_this_pointer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_this_pointer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this symbol is a "this" pointer for a class</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the name of this symbol</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the size of this symbol in bytes</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.symbol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the corresponding symbol, if it exists.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighSymbol.variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">variable</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the high variable associated with this symbol, if any.</p>
<p>The symbol may have multiple HighVariables associated with it.
This method returns the biggest one.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.HighSymbol.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename this high symbol.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_name</code></b>
              –
              <div class="doc-md-description">
                <p>The new name of the symbol</p>
              </div>
            </li>
            <li>
              <b><code>source</code></b>
              –
              <div class="doc-md-description">
                <p>The source of the symbol</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
<span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename this high symbol.</span>

<span class="sd">    :param new_name: The new name of the symbol</span>
<span class="sd">    :param source: The source of the symbol&quot;&quot;&quot;</span>
    <span class="n">HighFunctionDBUtil</span><span class="o">.</span><span class="n">updateDBVariable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.HighVariable" class="doc doc-heading">
            <code>HighVariable</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HighVariable</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; HighSymbol</span>
        <span class="k">return</span> <span class="n">HighSymbol</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename this high variable.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the size of this variable in bytes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the data type of this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDataType</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Varnode</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Varnode that represents this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Varnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRepresentative</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all Varnodes that represent this variable at some point&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Varnode</span><span class="p">(</span><span class="n">vn</span><span class="p">)</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getInstances</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unaffected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if ALL varnodes of this variable are is unaffected.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">vn</span><span class="o">.</span><span class="n">is_unaffected</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_persistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if ALL varnodes of this variable are persistent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">vn</span><span class="o">.</span><span class="n">is_persistent</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_addr_tied</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if ALL varnodes of this variable are addr tied.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">vn</span><span class="o">.</span><span class="n">is_addr_tied</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if ALL varnodes of this variable are input.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">vn</span><span class="o">.</span><span class="n">is_input</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if ALL varnodes of this variable are free.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">vn</span><span class="o">.</span><span class="n">is_free</span> <span class="k">for</span> <span class="n">vn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnodes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.data_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the data type of this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.is_addr_tied" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_addr_tied</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if ALL varnodes of this variable are addr tied.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.is_free" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_free</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if ALL varnodes of this variable are free.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.is_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_input</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if ALL varnodes of this variable are input.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.is_persistent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_persistent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if ALL varnodes of this variable are persistent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.is_unaffected" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unaffected</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if ALL varnodes of this variable are is unaffected.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the name of this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the size of this variable in bytes</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.symbol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.varnode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the Varnode that represents this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.HighVariable.varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return all Varnodes that represent this variable at some point</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.HighVariable.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename this high variable.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename this high variable.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Instruction" class="doc doc-heading">
            <code>Instruction</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code>, <code><a class="autorefs autorefs-internal" title="ghidralib.BodyTrait" href="#ghidralib.BodyTrait">BodyTrait</a></code></p>


        <p>Wraps a Ghidra Instruction object</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Instruction</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">,</span> <span class="n">BodyTrait</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra Instruction object&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Instruction|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an instruction at the address, or None if not found.</span>

<span class="sd">        Note: This will return None if the instruction is not defined in Ghidra</span>
<span class="sd">        at the given address. If you want to disassemble an address, not necessarily</span>
<span class="sd">        defined in Ghidra, try :func:`disassemble_at` instead.</span>

<span class="sd">        :param address: The address of the instruction.</span>
<span class="sd">        :return: The instruction at the address, or None if not found.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">getInstructionAt</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">address</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all instruction defined in the current program.&quot;&quot;&quot;</span>
        <span class="n">raw_instructions</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getListing</span><span class="p">()</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Instruction</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_instructions</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; Instruction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an instruction at the given address.</span>

<span class="sd">        Note: this will force ghidra to disassemble at the given address,</span>
<span class="sd">        and return the created instruction. If you want to actually change the</span>
<span class="sd">        instruction at the given address, use `assemble_at` instead.</span>

<span class="sd">        If you want to just create an instruction object, use `assemble` method.</span>

<span class="sd">        :param address: The address where instruction should be created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="n">disassemble</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mnemonic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mnemonic of this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMnemonicString</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Instruction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the next instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getNext</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">previous</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Instruction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the previous instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPrevious</span><span class="p">())</span>

    <span class="n">prev</span> <span class="o">=</span> <span class="n">previous</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a set of possible flows (next executed addresses).</span>

<span class="sd">        Note: this DOES NOT INCLUDE a fallthrough. A strange design decision IMO,</span>
<span class="sd">        but I&#39;m being faithful to Ghidra API.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFlows</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">all_flows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a set of possible flows (next executed addresses).</span>

<span class="sd">        Note: this INCLUDES fallthrough.&quot;&quot;&quot;</span>
        <span class="n">fallthrough</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fallthrough</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flows</span> <span class="o">+</span> <span class="p">([</span><span class="n">fallthrough</span><span class="p">]</span> <span class="k">if</span> <span class="n">fallthrough</span> <span class="k">else</span> <span class="p">[])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of Pcode operations that this instruction was parsed to&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getPcode</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output_varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of output (LOW) varnodes for this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">output</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcode</span> <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">output</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">input_varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of output (LOW) varnodes for this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">inp</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcode</span> <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">output</span> <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">op</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get high Pcode for this instruction.</span>

<span class="sd">        WARNING: do not use this in a loop. Use Function.high_pcode instead.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PcodeOp</span><span class="o">.</span><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xrefs_from</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Reference]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of references from this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Reference</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReferencesFrom</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xrefs_to</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Reference]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of references to this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Reference</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReferenceIteratorTo</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bytes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bytes of this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getBytes</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this instruction in bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getLength</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of this instruction in bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>

    <span class="k">def</span> <span class="nf">__convert_operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; Operand</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert an operand to a scalar or address.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ghidra.program.model.address</span> <span class="kn">import</span> <span class="n">Address</span>  <span class="c1"># type: ignore</span>
        <span class="kn">from</span> <span class="nn">ghidra.program.model.scalar</span> <span class="kn">import</span> <span class="n">Scalar</span>  <span class="c1"># type: ignore</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">GhRegister</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">_python_str</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getName</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">Address</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">_is_array</span><span class="p">(</span><span class="n">operand</span><span class="p">):</span>
            <span class="n">operands</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__convert_operand</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">raw</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">operand</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Unwrap the operands if there is only one operand</span>
                <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operands</span><span class="p">)</span>  <span class="c1"># type: ignore (we know there are no nested lists)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Don&#39;t know how to read operand </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">operand</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndx</span><span class="p">):</span>  <span class="c1"># type: (int) -&gt; Operand</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the nth operand of this instruction as an object.&quot;&quot;&quot;</span>
        <span class="n">operand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOpObjects</span><span class="p">(</span><span class="n">ndx</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__convert_operand</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">operands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Operand]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return operands as primitive values (int or a string representation).</span>

<span class="sd">        More specifically, this will convert constants and addresses into integers,</span>
<span class="sd">        and for registers the name will be returned.</span>

<span class="sd">        If you know operand type, call .scalar(), .register() or .list() instead.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">operand</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getNumOperands</span><span class="p">())]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">operand_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int|str|list[int|str]]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return operands as primitive values (int or a string representation).</span>

<span class="sd">        This is equivalent to calling .operands() and then calling .value()</span>
<span class="sd">        on each operand.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">operand</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">operand</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operands</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flow_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; FlowType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the flow type of this instruction.</span>

<span class="sd">        For example, for x86 JMP this will return RefType.UNCONDITIONAL_JUMP&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FlowType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFlowType</span><span class="p">())</span>

    <span class="c1"># int opIndex, Address refAddr, RefType type, SourceType sourceType</span>
    <span class="k">def</span> <span class="nf">add_operand_reference</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">op_ndx</span><span class="p">,</span> <span class="n">ref_addr</span><span class="p">,</span> <span class="n">ref_type</span><span class="p">,</span> <span class="n">src_type</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (int, Addr, RefType, SourceType) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a reference to an operand of this instruction.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addOperandReference</span><span class="p">(</span><span class="n">op_ndx</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">ref_addr</span><span class="p">),</span> <span class="n">ref_type</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">src_type</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address range this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_fallthrough</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return true if this instruction has a fallthrough.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasFallthrough</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fallthrough</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the fallthrough address (next address executed), if any.</span>

<span class="sd">        For normal instruction, this is the next instruction address. For jumps,</span>
<span class="sd">        this is None. Can be overriden by fallthrough override.&quot;&quot;&quot;</span>
        <span class="n">fall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFallThrough</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fall</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">fall</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_fallthrough_override</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Override the fallthrough address for this instruction.</span>

<span class="sd">        This sets the next instruction that will be executed after this</span>
<span class="sd">        instruction, assuming the current instruction doesn&#39;t jump anywhere.</span>
<span class="sd">        You can clear this with clear_fallthrough_override</span>

<span class="sd">        :param value: new fallthrough address&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setFallThrough</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">clear_fallthrough_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This clears the fallthrough override for this instruction.</span>

<span class="sd">        Alias for del self.fallthrough_override&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">clearFallThroughOverride</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_fallthrough_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return true if this instruction fallthrough was overriden.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isFallThroughOverridden</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">write_jumptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>  <span class="c1"># type: (list[Addr]) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provide a list of addresses where this instruction may jump.</span>

<span class="sd">        Warning: For this to work, the instruction must be a part of a function.</span>

<span class="sd">        This is useful for fixing unrecognised switches, for example.</span>

<span class="sd">        Note: the new switch instruction will use all references of type</span>
<span class="sd">        COMPUTED_JUMP already defined for the instruction</span>
<span class="sd">        (maybe we should clear them first?).&quot;&quot;&quot;</span>

        <span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
            <span class="n">disassemble</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_operand_reference</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">RefType</span><span class="o">.</span><span class="n">COMPUTED_JUMP</span><span class="p">)</span>

        <span class="n">func</span> <span class="o">=</span> <span class="n">Function</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Instruction is not part of a function&quot;</span><span class="p">)</span>

        <span class="n">targetlist</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="p">([</span><span class="n">dest</span> <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">])</span>
        <span class="n">jumpTab</span> <span class="o">=</span> <span class="n">JumpTable</span><span class="p">(</span><span class="n">toAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span> <span class="n">targetlist</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">jumpTab</span><span class="o">.</span><span class="n">writeOverride</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">CreateFunctionCmd</span><span class="o">.</span><span class="n">fixupFunctionBody</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">(),</span> <span class="n">func</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.all_flows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_flows</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a set of possible flows (next executed addresses).</p>
<p>Note: this INCLUDES fallthrough.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address range this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">bytes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the bytes of this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.fallthrough" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fallthrough</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the fallthrough address (next address executed), if any.</p>
<p>For normal instruction, this is the next instruction address. For jumps,
this is None. Can be overriden by fallthrough override.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.flow_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flow_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the flow type of this instruction.</p>
<p>For example, for x86 JMP this will return RefType.UNCONDITIONAL_JUMP</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.flows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flows</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a set of possible flows (next executed addresses).</p>
<p>Note: this DOES NOT INCLUDE a fallthrough. A strange design decision IMO,
but I'm being faithful to Ghidra API.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.has_fallthrough" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_fallthrough</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return true if this instruction has a fallthrough.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.has_fallthrough_override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_fallthrough_override</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return true if this instruction fallthrough was overriden.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.high_pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high_pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get high Pcode for this instruction.</p>
<p>WARNING: do not use this in a loop. Use Function.high_pcode instead.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.input_varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of output (LOW) varnodes for this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this instruction in bytes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.mnemonic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mnemonic</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the mnemonic of this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.next" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">next</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the next instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.operand_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operand_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return operands as primitive values (int or a string representation).</p>
<p>This is equivalent to calling .operands() and then calling .value()
on each operand.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.operands" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operands</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return operands as primitive values (int or a string representation).</p>
<p>More specifically, this will convert constants and addresses into integers,
and for registers the name will be returned.</p>
<p>If you know operand type, call .scalar(), .register() or .list() instead.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.output_varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of output (LOW) varnodes for this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of Pcode operations that this instruction was parsed to</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.prev" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prev</span> <span class="o">=</span> <span class="n">previous</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.previous" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">previous</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the previous instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.xrefs_from" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs_from</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of references from this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Instruction.xrefs_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs_to</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of references to this instruction.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.__convert_operand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__convert_operand</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert an operand to a scalar or address.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__convert_operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; Operand</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an operand to a scalar or address.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ghidra.program.model.address</span> <span class="kn">import</span> <span class="n">Address</span>  <span class="c1"># type: ignore</span>
    <span class="kn">from</span> <span class="nn">ghidra.program.model.scalar</span> <span class="kn">import</span> <span class="n">Scalar</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">GhRegister</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">_python_str</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getName</span><span class="p">()))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">Address</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operand</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">_is_array</span><span class="p">(</span><span class="n">operand</span><span class="p">):</span>
        <span class="n">operands</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__convert_operand</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">raw</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">operand</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Unwrap the operands if there is only one operand</span>
            <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Operand</span><span class="p">(</span><span class="n">operands</span><span class="p">)</span>  <span class="c1"># type: ignore (we know there are no nested lists)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Don&#39;t know how to read operand </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">operand</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the length of this instruction in bytes.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the length of this instruction in bytes.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.add_operand_reference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_operand_reference</span><span class="p">(</span><span class="n">op_ndx</span><span class="p">,</span> <span class="n">ref_addr</span><span class="p">,</span> <span class="n">ref_type</span><span class="p">,</span> <span class="n">src_type</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a reference to an operand of this instruction.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_operand_reference</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">op_ndx</span><span class="p">,</span> <span class="n">ref_addr</span><span class="p">,</span> <span class="n">ref_type</span><span class="p">,</span> <span class="n">src_type</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
<span class="p">):</span>  <span class="c1"># type: (int, Addr, RefType, SourceType) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a reference to an operand of this instruction.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">addOperandReference</span><span class="p">(</span><span class="n">op_ndx</span><span class="p">,</span> <span class="n">resolve</span><span class="p">(</span><span class="n">ref_addr</span><span class="p">),</span> <span class="n">ref_type</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">src_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all instruction defined in the current program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all instruction defined in the current program.&quot;&quot;&quot;</span>
    <span class="n">raw_instructions</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getListing</span><span class="p">()</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Instruction</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_instructions</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.clear_fallthrough_override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear_fallthrough_override</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This clears the fallthrough override for this instruction.</p>
<p>Alias for del self.fallthrough_override</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear_fallthrough_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This clears the fallthrough override for this instruction.</span>

<span class="sd">    Alias for del self.fallthrough_override&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">clearFallThroughOverride</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create an instruction at the given address.</p>
<p>Note: this will force ghidra to disassemble at the given address,
and return the created instruction. If you want to actually change the
instruction at the given address, use <code>assemble_at</code> instead.</p>
<p>If you want to just create an instruction object, use <code>assemble</code> method.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>The address where instruction should be created.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; Instruction</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an instruction at the given address.</span>

<span class="sd">    Note: this will force ghidra to disassemble at the given address,</span>
<span class="sd">    and return the created instruction. If you want to actually change the</span>
<span class="sd">    instruction at the given address, use `assemble_at` instead.</span>

<span class="sd">    If you want to just create an instruction object, use `assemble` method.</span>

<span class="sd">    :param address: The address where instruction should be created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">disassemble</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an instruction at the address, or None if not found.</p>
<p>Note: This will return None if the instruction is not defined in Ghidra
at the given address. If you want to disassemble an address, not necessarily
defined in Ghidra, try :func:<code>disassemble_at</code> instead.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>The address of the instruction.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The instruction at the address, or None if not found.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Instruction|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an instruction at the address, or None if not found.</span>

<span class="sd">    Note: This will return None if the instruction is not defined in Ghidra</span>
<span class="sd">    at the given address. If you want to disassemble an address, not necessarily</span>
<span class="sd">    defined in Ghidra, try :func:`disassemble_at` instead.</span>

<span class="sd">    :param address: The address of the instruction.</span>
<span class="sd">    :return: The instruction at the address, or None if not found.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">getInstructionAt</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">address</span>
    <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.operand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operand</span><span class="p">(</span><span class="n">ndx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the nth operand of this instruction as an object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndx</span><span class="p">):</span>  <span class="c1"># type: (int) -&gt; Operand</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the nth operand of this instruction as an object.&quot;&quot;&quot;</span>
    <span class="n">operand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOpObjects</span><span class="p">(</span><span class="n">ndx</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__convert_operand</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.set_fallthrough_override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_fallthrough_override</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Override the fallthrough address for this instruction.</p>
<p>This sets the next instruction that will be executed after this
instruction, assuming the current instruction doesn't jump anywhere.
You can clear this with clear_fallthrough_override</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>new fallthrough address</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_fallthrough_override</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Override the fallthrough address for this instruction.</span>

<span class="sd">    This sets the next instruction that will be executed after this</span>
<span class="sd">    instruction, assuming the current instruction doesn&#39;t jump anywhere.</span>
<span class="sd">    You can clear this with clear_fallthrough_override</span>

<span class="sd">    :param value: new fallthrough address&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setFallThrough</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Instruction.write_jumptable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_jumptable</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Provide a list of addresses where this instruction may jump.</p>
<p>Warning: For this to work, the instruction must be a part of a function.</p>
<p>This is useful for fixing unrecognised switches, for example.</p>
<p>Note: the new switch instruction will use all references of type
COMPUTED_JUMP already defined for the instruction
(maybe we should clear them first?).</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_jumptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>  <span class="c1"># type: (list[Addr]) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide a list of addresses where this instruction may jump.</span>

<span class="sd">    Warning: For this to work, the instruction must be a part of a function.</span>

<span class="sd">    This is useful for fixing unrecognised switches, for example.</span>

<span class="sd">    Note: the new switch instruction will use all references of type</span>
<span class="sd">    COMPUTED_JUMP already defined for the instruction</span>
<span class="sd">    (maybe we should clear them first?).&quot;&quot;&quot;</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
        <span class="n">disassemble</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_operand_reference</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">RefType</span><span class="o">.</span><span class="n">COMPUTED_JUMP</span><span class="p">)</span>

    <span class="n">func</span> <span class="o">=</span> <span class="n">Function</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Instruction is not part of a function&quot;</span><span class="p">)</span>

    <span class="n">targetlist</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="p">([</span><span class="n">dest</span> <span class="k">for</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">])</span>
    <span class="n">jumpTab</span> <span class="o">=</span> <span class="n">JumpTable</span><span class="p">(</span><span class="n">toAddr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span> <span class="n">targetlist</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">jumpTab</span><span class="o">.</span><span class="n">writeOverride</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
    <span class="n">CreateFunctionCmd</span><span class="o">.</span><span class="n">fixupFunctionBody</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">(),</span> <span class="n">func</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.JavaObject" class="doc doc-heading">
            <code>JavaObject</code>


</h2>


    <div class="doc doc-contents ">


        <p>A fake class, used for static type hints.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">JavaObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A fake class, used for static type hints.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; Any</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This attribute exists to make mypy happy.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ghidralib.JavaObject.__getattribute__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This attribute exists to make mypy happy.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; Any</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This attribute exists to make mypy happy.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.MemoryBlock" class="doc doc-heading">
            <code>MemoryBlock</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code>, <code><a class="autorefs autorefs-internal" title="ghidralib.BodyTrait" href="#ghidralib.BodyTrait">BodyTrait</a></code></p>


        <p>A Ghidra wrapper for a Ghidra MemoryBlock</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MemoryBlock</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">,</span> <span class="n">BodyTrait</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Ghidra wrapper for a Ghidra MemoryBlock&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; MemoryBlock|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a MemoryBlock by name or containing the given address.</span>

<span class="sd">        Note: for a string argument, this will try to get memoryblock by name, and</span>
<span class="sd">        if it fails, it will fall back to the regular behaviour of &quot;resolve the symbol</span>
<span class="sd">        to the address, and get element by address</span>

<span class="sd">        :param raw_or_name: name or address of MemoryBlock to get</span>
<span class="sd">        :return: the MemoryBlock, or None if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getMemory</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">getBlock</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">MemoryBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">MemoryBlock</span><span class="p">(</span><span class="n">memory</span><span class="o">.</span><span class="n">getBlock</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[MemoryBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all MemoryBlocks in the current program&quot;&quot;&quot;</span>
        <span class="n">raw_blocks</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getMemory</span><span class="p">()</span><span class="o">.</span><span class="n">getBlocks</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">MemoryBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_blocks</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the comment associated with this MemoryBlock&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getComment</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first address of this MemoryBlock&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getStart</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of this MemoryBlock&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="n">address</span> <span class="o">=</span> <span class="n">start</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getEnd</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the size of this MemoryBlock&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>

    <span class="n">length</span> <span class="o">=</span> <span class="n">size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address range this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bytes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bytes of this instruction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">read_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span> <span class="o">=</span> <span class="n">start</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address range this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">bytes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the bytes of this instruction.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the comment associated with this MemoryBlock</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span> <span class="o">=</span> <span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of this MemoryBlock</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the size of this MemoryBlock</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.MemoryBlock.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the first address of this MemoryBlock</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.MemoryBlock.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all MemoryBlocks in the current program</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[MemoryBlock]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all MemoryBlocks in the current program&quot;&quot;&quot;</span>
    <span class="n">raw_blocks</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getMemory</span><span class="p">()</span><span class="o">.</span><span class="n">getBlocks</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">MemoryBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_blocks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.MemoryBlock.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets a MemoryBlock by name or containing the given address.</p>
<p>Note: for a string argument, this will try to get memoryblock by name, and
if it fails, it will fall back to the regular behaviour of "resolve the symbol
to the address, and get element by address</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>raw_or_name</code></b>
              –
              <div class="doc-md-description">
                <p>name or address of MemoryBlock to get</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the MemoryBlock, or None if not found</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; MemoryBlock|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets a MemoryBlock by name or containing the given address.</span>

<span class="sd">    Note: for a string argument, this will try to get memoryblock by name, and</span>
<span class="sd">    if it fails, it will fall back to the regular behaviour of &quot;resolve the symbol</span>
<span class="sd">    to the address, and get element by address</span>

<span class="sd">    :param raw_or_name: name or address of MemoryBlock to get</span>
<span class="sd">    :return: the MemoryBlock, or None if not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getMemory</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">getBlock</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MemoryBlock</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">try_resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">MemoryBlock</span><span class="p">(</span><span class="n">memory</span><span class="o">.</span><span class="n">getBlock</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Operand" class="doc doc-heading">
            <code>Operand</code>


</h2>


    <div class="doc doc-contents ">


        <p>Operand helper for instruction, may be a register, const or a list</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Operand</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Operand helper for instruction, may be a register, const or a list&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">):</span>  <span class="c1"># type: (str|int|list[int|str]) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span> <span class="o">=</span> <span class="n">operand</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this operand is a register.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this operand is a scalar.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this operand is a list.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets this operand value as a register name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Operand </span><span class="si">{}</span><span class="s2"> is not a register&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets this operand value as a scalar&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Operand </span><span class="si">{}</span><span class="s2"> is not a scalar&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets this operand value as a list&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Operand </span><span class="si">{}</span><span class="s2"> is not a list&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str|int|list[int|str]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return internal representation of this operand - string, int or a list&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.is_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_list</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this operand is a list.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.is_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this operand is a register.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.is_scalar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_scalar</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this operand is a scalar.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.list" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">list</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets this operand value as a list</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.raw" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">raw</span> <span class="o">=</span> <span class="n">operand</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets this operand value as a register name</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.scalar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scalar</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets this operand value as a scalar</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Operand.value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return internal representation of this operand - string, int or a list</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Operand.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1531</span>
<span class="normal">1532</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">):</span>  <span class="c1"># type: (str|int|list[int|str]) -&gt; None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span> <span class="o">=</span> <span class="n">operand</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Parameter" class="doc doc-heading">
            <code>Parameter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.Variable" href="#ghidralib.Variable">Variable</a></code></p>


        <p>Wraps a Ghidra Parameter object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Parameter</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra Parameter object.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ordinal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the ordinal of this parameter.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOrdinal</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formal_data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the formal data type of this parameter.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFormalDataType</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Parameter.formal_data_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">formal_data_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the formal data type of this parameter.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Parameter.ordinal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ordinal</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the ordinal of this parameter.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.PcodeBlock" class="doc doc-heading">
            <code>PcodeBlock</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PcodeBlock</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outgoing_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeBlock]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">_pcode_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOut</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOutSize</span><span class="p">())]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">incoming_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeBlock]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">_pcode_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getIn</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getInSize</span><span class="p">())]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this block has any children and can be iterated over.</span>

<span class="sd">        This function is necessary because Ghidra&#39;s code uses isinstance()</span>
<span class="sd">        checks to dispatch types. We return true for instances of Java BlockGraph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">GhBlockGraph</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
        <span class="n">raw_pcode</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRef</span><span class="p">()</span><span class="o">.</span><span class="n">getIterator</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raw_pcode</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeBlock.has_children" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_children</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this block has any children and can be iterated over.</p>
<p>This function is necessary because Ghidra's code uses isinstance()
checks to dispatch types. We return true for instances of Java BlockGraph.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeBlock.incoming_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">incoming_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeBlock.outgoing_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">outgoing_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeBlock.pcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.PcodeOp" class="doc doc-heading">
            <code>PcodeOp</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Pcode is a Ghidra's low-level intermediate language.
Instructions from any processor are transformed into PCode
before any analysis takes place. There is a finite number of
possible operations.</p>
<p>While Ghidra doesn't define "High Pcode", this library refers
to analysed Pcode as "High Pcode". While theoretically still
the same object, Pcode is transformed significantly, for example
before function parameter analysis "CALL" opcodes have no inputs.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PcodeOp</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pcode is a Ghidra&#39;s low-level intermediate language.</span>
<span class="sd">    Instructions from any processor are transformed into PCode</span>
<span class="sd">    before any analysis takes place. There is a finite number of</span>
<span class="sd">    possible operations.</span>

<span class="sd">    While Ghidra doesn&#39;t define &quot;High Pcode&quot;, this library refers</span>
<span class="sd">    to analysed Pcode as &quot;High Pcode&quot;. While theoretically still</span>
<span class="sd">    the same object, Pcode is transformed significantly, for example</span>
<span class="sd">    before function parameter analysis &quot;CALL&quot; opcodes have no inputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">UNIMPLEMENTED</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">COPY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">LOAD</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">STORE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">BRANCH</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">CBRANCH</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">BRANCHIND</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">CALL</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">CALLIND</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">CALLOTHER</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">RETURN</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">INT_EQUAL</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">INT_NOTEQUAL</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">INT_SLESS</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">INT_SLESSEQUAL</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">INT_LESS</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">INT_LESSEQUAL</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">INT_ZEXT</span> <span class="o">=</span> <span class="mi">17</span>
    <span class="n">INT_SEXT</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">INT_ADD</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="n">INT_SUB</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">INT_CARRY</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="n">INT_SCARRY</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="n">INT_SBORROW</span> <span class="o">=</span> <span class="mi">23</span>
    <span class="n">INT_2COMP</span> <span class="o">=</span> <span class="mi">24</span>
    <span class="n">INT_NEGATE</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">INT_XOR</span> <span class="o">=</span> <span class="mi">26</span>
    <span class="n">INT_AND</span> <span class="o">=</span> <span class="mi">27</span>
    <span class="n">INT_OR</span> <span class="o">=</span> <span class="mi">28</span>
    <span class="n">INT_LEFT</span> <span class="o">=</span> <span class="mi">29</span>
    <span class="n">INT_RIGHT</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">INT_SRIGHT</span> <span class="o">=</span> <span class="mi">31</span>
    <span class="n">INT_MULT</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">INT_DIV</span> <span class="o">=</span> <span class="mi">33</span>
    <span class="n">INT_SDIV</span> <span class="o">=</span> <span class="mi">34</span>
    <span class="n">INT_REM</span> <span class="o">=</span> <span class="mi">35</span>
    <span class="n">INT_SREM</span> <span class="o">=</span> <span class="mi">36</span>
    <span class="n">BOOL_NEGATE</span> <span class="o">=</span> <span class="mi">37</span>
    <span class="n">BOOL_XOR</span> <span class="o">=</span> <span class="mi">38</span>
    <span class="n">BOOL_AND</span> <span class="o">=</span> <span class="mi">39</span>
    <span class="n">BOOL_OR</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">FLOAT_EQUAL</span> <span class="o">=</span> <span class="mi">41</span>
    <span class="n">FLOAT_NOTEQUAL</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="n">FLOAT_LESS</span> <span class="o">=</span> <span class="mi">43</span>
    <span class="n">FLOAT_LESSEQUAL</span> <span class="o">=</span> <span class="mi">44</span>
    <span class="c1"># Slot 45 is unused</span>
    <span class="n">FLOAT_NAN</span> <span class="o">=</span> <span class="mi">46</span>
    <span class="n">FLOAT_ADD</span> <span class="o">=</span> <span class="mi">47</span>
    <span class="n">FLOAT_DIV</span> <span class="o">=</span> <span class="mi">48</span>
    <span class="n">FLOAT_MULT</span> <span class="o">=</span> <span class="mi">49</span>
    <span class="n">FLOAT_SUB</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">FLOAT_NEG</span> <span class="o">=</span> <span class="mi">51</span>
    <span class="n">FLOAT_ABS</span> <span class="o">=</span> <span class="mi">52</span>
    <span class="n">FLOAT_SQRT</span> <span class="o">=</span> <span class="mi">53</span>
    <span class="n">FLOAT_INT2FLOAT</span> <span class="o">=</span> <span class="mi">54</span>
    <span class="n">FLOAT_FLOAT2FLOAT</span> <span class="o">=</span> <span class="mi">55</span>
    <span class="n">FLOAT_TRUNC</span> <span class="o">=</span> <span class="mi">56</span>
    <span class="n">FLOAT_CEIL</span> <span class="o">=</span> <span class="mi">57</span>
    <span class="n">FLOAT_FLOOR</span> <span class="o">=</span> <span class="mi">58</span>
    <span class="n">FLOAT_ROUND</span> <span class="o">=</span> <span class="mi">59</span>
    <span class="n">MULTIEQUAL</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">INDIRECT</span> <span class="o">=</span> <span class="mi">61</span>
    <span class="n">PIECE</span> <span class="o">=</span> <span class="mi">62</span>
    <span class="n">SUBPIECE</span> <span class="o">=</span> <span class="mi">63</span>
    <span class="n">CAST</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">PTRADD</span> <span class="o">=</span> <span class="mi">65</span>
    <span class="n">PTRSUB</span> <span class="o">=</span> <span class="mi">66</span>
    <span class="n">SEGMENTOP</span> <span class="o">=</span> <span class="mi">67</span>
    <span class="n">CPOOLREF</span> <span class="o">=</span> <span class="mi">68</span>
    <span class="n">NEW</span> <span class="o">=</span> <span class="mi">69</span>
    <span class="n">INSERT</span> <span class="o">=</span> <span class="mi">70</span>
    <span class="n">EXTRACT</span> <span class="o">=</span> <span class="mi">71</span>
    <span class="n">POPCOUNT</span> <span class="o">=</span> <span class="mi">72</span>
    <span class="n">LZCOUNT</span> <span class="o">=</span> <span class="mi">73</span>
    <span class="n">PCODE_MAX</span> <span class="o">=</span> <span class="mi">74</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a high pcode for the instruction at a specified address</span>

<span class="sd">        Convenience wrapper for Function(address).get_high_pcode_at(address).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an address in the program where this instruction is located&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSeqnum</span><span class="p">()</span><span class="o">.</span><span class="n">getTarget</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">opcode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOpcode</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mnemonic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a string representation of the operation, for example &quot;COPY&quot; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getMnemonic</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Varnode</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getInputs</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inputs_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int|str]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return inputs as primitive values (int or a string representation).</span>

<span class="sd">        More specifically, this will convert constants and addresses into integers,</span>
<span class="sd">        for registers names are returned, and for unique and hash varnodes ad-hoc</span>
<span class="sd">        string encoding is used (hash:ID or uniq:ID where ID is varnode identifier).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">varnode</span><span class="o">.</span><span class="n">simple</span> <span class="k">for</span> <span class="n">varnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Varnode|None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOutput</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Varnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOutput</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to evaluate the pcode operation to a constant value.</span>

<span class="sd">        Right now this is very poor and doesn&#39;t try to implement most of the opcodes.</span>
<span class="sd">        Mostly because I suspect I&#39;m reinventing the wheel, and there is code to do</span>
<span class="sd">        this already in Ghidra.</span>

<span class="sd">        :return: Result of this operation, or None if can&#39;t be evaluated as const.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span> <span class="o">==</span> <span class="n">PcodeOp</span><span class="o">.</span><span class="n">COPY</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BOOL_AND" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BOOL_AND</span> <span class="o">=</span> <span class="mi">39</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BOOL_NEGATE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BOOL_NEGATE</span> <span class="o">=</span> <span class="mi">37</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BOOL_OR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BOOL_OR</span> <span class="o">=</span> <span class="mi">40</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BOOL_XOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BOOL_XOR</span> <span class="o">=</span> <span class="mi">38</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BRANCH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BRANCH</span> <span class="o">=</span> <span class="mi">4</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.BRANCHIND" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BRANCHIND</span> <span class="o">=</span> <span class="mi">6</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALL</span> <span class="o">=</span> <span class="mi">7</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CALLIND" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALLIND</span> <span class="o">=</span> <span class="mi">8</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CALLOTHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALLOTHER</span> <span class="o">=</span> <span class="mi">9</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CAST" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CAST</span> <span class="o">=</span> <span class="mi">64</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CBRANCH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CBRANCH</span> <span class="o">=</span> <span class="mi">5</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.COPY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COPY</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.CPOOLREF" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CPOOLREF</span> <span class="o">=</span> <span class="mi">68</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.EXTRACT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EXTRACT</span> <span class="o">=</span> <span class="mi">71</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_ABS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_ABS</span> <span class="o">=</span> <span class="mi">52</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_ADD" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_ADD</span> <span class="o">=</span> <span class="mi">47</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_CEIL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_CEIL</span> <span class="o">=</span> <span class="mi">57</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_DIV" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_DIV</span> <span class="o">=</span> <span class="mi">48</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_EQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_EQUAL</span> <span class="o">=</span> <span class="mi">41</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_FLOAT2FLOAT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_FLOAT2FLOAT</span> <span class="o">=</span> <span class="mi">55</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_FLOOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_FLOOR</span> <span class="o">=</span> <span class="mi">58</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_INT2FLOAT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_INT2FLOAT</span> <span class="o">=</span> <span class="mi">54</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_LESS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_LESS</span> <span class="o">=</span> <span class="mi">43</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_LESSEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_LESSEQUAL</span> <span class="o">=</span> <span class="mi">44</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_MULT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_MULT</span> <span class="o">=</span> <span class="mi">49</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_NAN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_NAN</span> <span class="o">=</span> <span class="mi">46</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_NEG" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_NEG</span> <span class="o">=</span> <span class="mi">51</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_NOTEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_NOTEQUAL</span> <span class="o">=</span> <span class="mi">42</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_ROUND" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_ROUND</span> <span class="o">=</span> <span class="mi">59</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_SQRT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_SQRT</span> <span class="o">=</span> <span class="mi">53</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_SUB" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_SUB</span> <span class="o">=</span> <span class="mi">50</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.FLOAT_TRUNC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOAT_TRUNC</span> <span class="o">=</span> <span class="mi">56</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INDIRECT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INDIRECT</span> <span class="o">=</span> <span class="mi">61</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INSERT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INSERT</span> <span class="o">=</span> <span class="mi">70</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_2COMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_2COMP</span> <span class="o">=</span> <span class="mi">24</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_ADD" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_ADD</span> <span class="o">=</span> <span class="mi">19</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_AND" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_AND</span> <span class="o">=</span> <span class="mi">27</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_CARRY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_CARRY</span> <span class="o">=</span> <span class="mi">21</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_DIV" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_DIV</span> <span class="o">=</span> <span class="mi">33</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_EQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_EQUAL</span> <span class="o">=</span> <span class="mi">11</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_LEFT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_LEFT</span> <span class="o">=</span> <span class="mi">29</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_LESS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_LESS</span> <span class="o">=</span> <span class="mi">15</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_LESSEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_LESSEQUAL</span> <span class="o">=</span> <span class="mi">16</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_MULT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_MULT</span> <span class="o">=</span> <span class="mi">32</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_NEGATE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_NEGATE</span> <span class="o">=</span> <span class="mi">25</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_NOTEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_NOTEQUAL</span> <span class="o">=</span> <span class="mi">12</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_OR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_OR</span> <span class="o">=</span> <span class="mi">28</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_REM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_REM</span> <span class="o">=</span> <span class="mi">35</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_RIGHT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_RIGHT</span> <span class="o">=</span> <span class="mi">30</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SBORROW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SBORROW</span> <span class="o">=</span> <span class="mi">23</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SCARRY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SCARRY</span> <span class="o">=</span> <span class="mi">22</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SDIV" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SDIV</span> <span class="o">=</span> <span class="mi">34</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SEXT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SEXT</span> <span class="o">=</span> <span class="mi">18</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SLESS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SLESS</span> <span class="o">=</span> <span class="mi">13</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SLESSEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SLESSEQUAL</span> <span class="o">=</span> <span class="mi">14</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SREM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SREM</span> <span class="o">=</span> <span class="mi">36</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SRIGHT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SRIGHT</span> <span class="o">=</span> <span class="mi">31</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_SUB" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_SUB</span> <span class="o">=</span> <span class="mi">20</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_XOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_XOR</span> <span class="o">=</span> <span class="mi">26</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.INT_ZEXT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INT_ZEXT</span> <span class="o">=</span> <span class="mi">17</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.LOAD" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">LOAD</span> <span class="o">=</span> <span class="mi">2</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.LZCOUNT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">LZCOUNT</span> <span class="o">=</span> <span class="mi">73</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.MULTIEQUAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">MULTIEQUAL</span> <span class="o">=</span> <span class="mi">60</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.NEW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">NEW</span> <span class="o">=</span> <span class="mi">69</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.PCODE_MAX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PCODE_MAX</span> <span class="o">=</span> <span class="mi">74</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.PIECE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PIECE</span> <span class="o">=</span> <span class="mi">62</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.POPCOUNT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">POPCOUNT</span> <span class="o">=</span> <span class="mi">72</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.PTRADD" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PTRADD</span> <span class="o">=</span> <span class="mi">65</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.PTRSUB" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PTRSUB</span> <span class="o">=</span> <span class="mi">66</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.RETURN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">RETURN</span> <span class="o">=</span> <span class="mi">10</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.SEGMENTOP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SEGMENTOP</span> <span class="o">=</span> <span class="mi">67</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.STORE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">STORE</span> <span class="o">=</span> <span class="mi">3</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.SUBPIECE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SUBPIECE</span> <span class="o">=</span> <span class="mi">63</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.UNIMPLEMENTED" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">UNIMPLEMENTED</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an address in the program where this instruction is located</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.inputs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inputs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.inputs_simple" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inputs_simple</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return inputs as primitive values (int or a string representation).</p>
<p>More specifically, this will convert constants and addresses into integers,
for registers names are returned, and for unique and hash varnodes ad-hoc
string encoding is used (hash:ID or uniq:ID where ID is varnode identifier).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.mnemonic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mnemonic</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a string representation of the operation, for example "COPY"</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.opcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.output" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.PcodeOp.result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">result</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Try to evaluate the pcode operation to a constant value.</p>
<p>Right now this is very poor and doesn't try to implement most of the opcodes.
Mostly because I suspect I'm reinventing the wheel, and there is code to do
this already in Ghidra.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>Result of this operation, or None if can't be evaluated as const.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.PcodeOp.get_high_pcode_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a high pcode for the instruction at a specified address</p>
<p>Convenience wrapper for Function(address).get_high_pcode_at(address).</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; list[PcodeOp]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a high pcode for the instruction at a specified address</span>

<span class="sd">    Convenience wrapper for Function(address).get_high_pcode_at(address).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">get_high_pcode_at</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Program" class="doc doc-heading">
            <code>Program</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>A static class that represents the current program</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Program</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A static class that represents the current program&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_data</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>  <span class="c1"># type: (Addr, DataT) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Force the type of the data defined at the given address to `datatype`.</span>

<span class="sd">        This function will clear the old type if it already has one</span>

<span class="sd">        :param address: address of the data.</span>
<span class="sd">        :param datatype: datatype to use for the data at `address`.&quot;&quot;&quot;</span>
        <span class="n">typeobj</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">createData</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">unwrap</span><span class="p">(</span><span class="n">typeobj</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">clearListing</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">))</span>
            <span class="n">createData</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">unwrap</span><span class="p">(</span><span class="n">typeobj</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">():</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current location in the program.</span>

<span class="sd">            &gt;&gt;&gt; current_location()</span>
<span class="sd">            0x1000</span>

<span class="sd">        :return: the current location in the program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">getCurrentLocation</span><span class="p">()</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">call_graph</span><span class="p">():</span>  <span class="c1"># type: () -&gt; Graph[Function]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the call graph for this program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">Function</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">called</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">control_flow</span><span class="p">():</span>  <span class="c1"># type: () -&gt; Graph[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a graph representing the whole program control flow.</span>

<span class="sd">        Warning: This graph may be big, so don&#39;t try to display it.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">BasicBlock</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">destinations</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">basicblocks</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[BasicBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the basic blocks defined in the program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">memory_blocks</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[MemoryBlock]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get memory blocks defined for the current program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">MemoryBlock</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">functions</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the functions defined in the program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">instructions</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the instructions defined in the program.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Instruction</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">():</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the set of all addresses of the program.&quot;&quot;&quot;</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getNamespaceManager</span><span class="p">()</span><span class="o">.</span><span class="n">getGlobalNamespace</span><span class="p">()</span><span class="o">.</span><span class="n">getBody</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">current</span><span class="p">():</span>  <span class="c1"># type: () -&gt; JavaObject</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current program. Equivalent to getCurrentProgram()</span>

<span class="sd">        This method must be used instead of currentProgram, because the latter</span>
<span class="sd">        won&#39;t work well if user is using multiple programs at the same time</span>
<span class="sd">        (for example, many tabs in the same tool).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">getCurrentProgram</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">analyze</span><span class="p">():</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze changes. This will block when autoanalysis changes place.</span>

<span class="sd">        Run this when you did changes that you will need to proceed with the rest</span>
<span class="sd">        of the script.&quot;&quot;&quot;</span>
        <span class="n">analyzeChanges</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.analyze" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">analyze</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Analyze changes. This will block when autoanalysis changes place.</p>
<p>Run this when you did changes that you will need to proceed with the rest
of the script.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">analyze</span><span class="p">():</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze changes. This will block when autoanalysis changes place.</span>

<span class="sd">    Run this when you did changes that you will need to proceed with the rest</span>
<span class="sd">    of the script.&quot;&quot;&quot;</span>
    <span class="n">analyzeChanges</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.basicblocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basicblocks</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all the basic blocks defined in the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">basicblocks</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[BasicBlock]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all the basic blocks defined in the program.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">BasicBlock</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the set of all addresses of the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">body</span><span class="p">():</span>  <span class="c1"># type: () -&gt; AddressSet</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the set of all addresses of the program.&quot;&quot;&quot;</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getNamespaceManager</span><span class="p">()</span><span class="o">.</span><span class="n">getGlobalNamespace</span><span class="p">()</span><span class="o">.</span><span class="n">getBody</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">AddressSet</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.call_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_graph</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the call graph for this program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">call_graph</span><span class="p">():</span>  <span class="c1"># type: () -&gt; Graph[Function]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the call graph for this program.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">Function</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">called</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.control_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">control_flow</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a graph representing the whole program control flow.</p>
<p>Warning: This graph may be big, so don't try to display it.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">control_flow</span><span class="p">():</span>  <span class="c1"># type: () -&gt; Graph[BasicBlock]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a graph representing the whole program control flow.</span>

<span class="sd">    Warning: This graph may be big, so don&#39;t try to display it.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">BasicBlock</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">destinations</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.create_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_data</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Force the type of the data defined at the given address to <code>datatype</code>.</p>
<p>This function will clear the old type if it already has one</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address of the data.</p>
              </div>
            </li>
            <li>
              <b><code>datatype</code></b>
              –
              <div class="doc-md-description">
                <p>datatype to use for the data at <code>address</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_data</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>  <span class="c1"># type: (Addr, DataT) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Force the type of the data defined at the given address to `datatype`.</span>

<span class="sd">    This function will clear the old type if it already has one</span>

<span class="sd">    :param address: address of the data.</span>
<span class="sd">    :param datatype: datatype to use for the data at `address`.&quot;&quot;&quot;</span>
    <span class="n">typeobj</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">createData</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">unwrap</span><span class="p">(</span><span class="n">typeobj</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">clearListing</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">))</span>
        <span class="n">createData</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">unwrap</span><span class="p">(</span><span class="n">typeobj</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.current" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">current</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the current program. Equivalent to getCurrentProgram()</p>
<p>This method must be used instead of currentProgram, because the latter
won't work well if user is using multiple programs at the same time
(for example, many tabs in the same tool).</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">current</span><span class="p">():</span>  <span class="c1"># type: () -&gt; JavaObject</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current program. Equivalent to getCurrentProgram()</span>

<span class="sd">    This method must be used instead of currentProgram, because the latter</span>
<span class="sd">    won&#39;t work well if user is using multiple programs at the same time</span>
<span class="sd">    (for example, many tabs in the same tool).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">getCurrentProgram</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">functions</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all the functions defined in the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">functions</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Function]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all the functions defined in the program.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instructions</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all the instructions defined in the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">instructions</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all the instructions defined in the program.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Instruction</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">location</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the current location in the program.</p>
<pre><code>&gt;&gt;&gt; current_location()
0x1000
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the current location in the program</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">location</span><span class="p">():</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current location in the program.</span>

<span class="sd">        &gt;&gt;&gt; current_location()</span>
<span class="sd">        0x1000</span>

<span class="sd">    :return: the current location in the program</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">getCurrentLocation</span><span class="p">()</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Program.memory_blocks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">memory_blocks</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get memory blocks defined for the current program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">memory_blocks</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[MemoryBlock]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get memory blocks defined for the current program.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MemoryBlock</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.RefType" class="doc doc-heading">
            <code>RefType</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RefType</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_fallthrough</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">hasFallthrough</span><span class="p">()</span>

    <span class="nd">@has_fallthrough</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">has_fallthrough</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setHasFall</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isCall</span><span class="p">()</span>

    <span class="nd">@is_call</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setIsCall</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isJump</span><span class="p">()</span>

    <span class="nd">@is_jump</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setIsJump</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_computed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isComputed</span><span class="p">()</span>

    <span class="nd">@is_computed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_computed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setIsComputed</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_conditional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isConditional</span><span class="p">()</span>

    <span class="nd">@is_conditional</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_conditional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># type: (bool) -&gt; None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setIsConditional</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unconditional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_conditional</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_terminal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isTerminal</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isData</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isRead</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isWrite</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isFlow</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isOverride</span><span class="p">()</span>

    <span class="n">INVALID</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">FLOW</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">FALL_THROUGH</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">UNCONDITIONAL_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">UNCONDITIONAL_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">COMPUTED_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">COMPUTED_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">COMPUTED_CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_COMPUTED_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CONDITIONAL_COMPUTED_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">JUMP_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">INDIRECTION</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CALL_OVERRIDE_UNCONDITIONAL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">JUMP_OVERRIDE_UNCONDITIONAL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CALLOTHER_OVERRIDE_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
    <span class="n">CALLOTHER_OVERRIDE_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CALLOTHER_OVERRIDE_CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALLOTHER_OVERRIDE_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CALLOTHER_OVERRIDE_JUMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALLOTHER_OVERRIDE_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CALL_OVERRIDE_UNCONDITIONAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALL_OVERRIDE_UNCONDITIONAL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CALL_TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.COMPUTED_CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COMPUTED_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.COMPUTED_CALL_TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COMPUTED_CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.COMPUTED_JUMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COMPUTED_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_CALL_TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_CALL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_COMPUTED_CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_COMPUTED_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_COMPUTED_JUMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_COMPUTED_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_JUMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.CONDITIONAL_TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CONDITIONAL_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.FALL_THROUGH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FALL_THROUGH</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.FLOW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLOW</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.INDIRECTION" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INDIRECTION</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.INVALID" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">INVALID</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.JUMP_OVERRIDE_UNCONDITIONAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">JUMP_OVERRIDE_UNCONDITIONAL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.JUMP_TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">JUMP_TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.TERMINATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TERMINATOR</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.UNCONDITIONAL_CALL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">UNCONDITIONAL_CALL</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.UNCONDITIONAL_JUMP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">UNCONDITIONAL_JUMP</span> <span class="o">=</span> <span class="n">_reftype_placeholder</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.has_fallthrough" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_fallthrough</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_call</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_computed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_computed</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_conditional" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_conditional</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_data</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_flow</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_jump" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_jump</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_override</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_read" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_read</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_terminal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_terminal</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_unconditional" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unconditional</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.RefType.is_write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_write</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Reference" class="doc doc-heading">
            <code>Reference</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Reference</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the reference is a call.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reftype</span><span class="o">.</span><span class="n">is_call</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the reference is a jump.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reftype</span><span class="o">.</span><span class="n">is_jump</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reftype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; RefType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the type of reference.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RefType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReferenceType</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">from_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the address of the source of the reference.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFromAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">to_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the address of the target of the reference.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getToAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; SourceType</span>
        <span class="k">return</span> <span class="n">SourceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSource</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.from_address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the address of the source of the reference.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.is_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_call</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the reference is a call.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.is_jump" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_jump</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the reference is a jump.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.reftype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reftype</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the type of reference.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.source" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Reference.to_address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the address of the target of the reference.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Register" class="doc doc-heading">
            <code>Register</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Register</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (str|JavaObject) -&gt; Register|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a register by name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
            <span class="n">raw_or_name</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">raw_or_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Register</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of this register&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the size of this register in bytes</span>

<span class="sd">        This will tell the total number of bytes this register contains -</span>
<span class="sd">        because register values don&#39;t have to be byte-aligned&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getNumBytes</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Varnode</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the varnode associated with this register</span>

<span class="sd">        Warning: this doesn&#39;t support registers that are not byte-aligned</span>
<span class="sd">        (for example, flag registers). It will round the address down to byte.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">GhVarnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getNumBytes</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Register.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the name of this register</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Register.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the size of this register in bytes</p>
<p>This will tell the total number of bytes this register contains -
because register values don't have to be byte-aligned</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Register.varnode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the varnode associated with this register</p>
<p>Warning: this doesn't support registers that are not byte-aligned
(for example, flag registers). It will round the address down to byte.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Register.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a register by name</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (str|JavaObject) -&gt; Register|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a register by name&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
        <span class="n">raw_or_name</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw_or_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Register</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Symbol" class="doc doc-heading">
            <code>Symbol</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra Symbol object.</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Symbol</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra Symbol object.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">resolve_thunk_if_exists</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; JavaObject</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a function thunk leading to a passed external symbol, if it exists.</span>

<span class="sd">        If there is no function thunk, original symbol is returned.</span>

<span class="sd">        Why is this ugly thing here? Well, we want to support external symbols,</span>
<span class="sd">        especially external functions. Thunks are much more useful for us when</span>
<span class="sd">        thinking in context of the analysed program - when Linux program calls</span>
<span class="sd">        `printf` it jumps to the appropriate `printf` thunk, not to libc</span>
<span class="sd">        directly. So this is the location that we want to patch/hook/trace/etc when</span>
<span class="sd">        thinking about printf. But the thing is that Ghidra SymbolTable API will</span>
<span class="sd">        not even return thunks! So we trace the external function references, and</span>
<span class="sd">        return the first (almost certainly only) Thunk reference.</span>

<span class="sd">        :param external_symbol: Symbol to find thunk for (if it exists).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xrefs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">external_symbol</span><span class="o">.</span><span class="n">getReferences</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="n">xrefs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xref</span><span class="o">.</span><span class="n">getReferenceType</span><span class="p">()</span> <span class="o">==</span> <span class="n">GhRefType</span><span class="o">.</span><span class="n">THUNK</span><span class="p">:</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">getFromAddress</span><span class="p">()</span>
                <span class="n">thunk</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getPrimarySymbol</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thunk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">thunk</span>
        <span class="k">return</span> <span class="n">external_symbol</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">resolve_external</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolves an external address to a RAM location, if possible.</span>

<span class="sd">        If the symbol has no RAM location, just return its offset.</span>

<span class="sd">        Why is this ugly thing here? Again, we want to support external symbols, and</span>
<span class="sd">        we are interested in their RAM address in the program address space. In some</span>
<span class="sd">        cases, Ghidra will give an external address a &quot;location&quot; in the RAM space.</span>
<span class="sd">        So, for example, if current program jumps to that external function (or read</span>
<span class="sd">        that external variable etc), it will read that location as far as Ghidra is</span>
<span class="sd">        concerned (for example, Emulator will use it for calls). This is important</span>
<span class="sd">        for emulating Windows binaries, that use address tables for imports.</span>

<span class="sd">        :param external_symbol: External symbol to resolve.&quot;&quot;&quot;</span>
        <span class="n">external_manager</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getExternalManager</span><span class="p">()</span>
        <span class="n">ram_addr</span> <span class="o">=</span> <span class="n">external_manager</span><span class="o">.</span><span class="n">getExternalLocation</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">)</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ram_addr</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ram_addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">external_symbol</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Symbol|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a symbol with the provided name or at the provided address.</span>

<span class="sd">        Return None if the symbol was not found.</span>

<span class="sd">        Note: when resolving by name, local symbols take precedence over external ones</span>
<span class="sd">        (in particular for function thunks - in contrast to Ghidra default behaviour).</span>

<span class="sd">        :param raw_or_name: a Ghidra Java object, a string, or an address.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">symbol_iterator</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbols</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
            <span class="n">symbols</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="n">symbol_iterator</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">symbols</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">raw</span><span class="o">.</span><span class="n">isExternal</span><span class="p">():</span>
                <span class="n">raw</span> <span class="o">=</span> <span class="n">Symbol</span><span class="o">.</span><span class="n">resolve_thunk_if_exists</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
                <span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span>
                <span class="o">.</span><span class="n">getPrimarySymbol</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">raw</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">raw_or_name</span>
        <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Symbol]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all symbols defined in the program.&quot;&quot;&quot;</span>
        <span class="n">symbol_iterator</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getAllSymbols</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="n">symbol_iterator</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
        <span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (Addr, str, SourceType) -&gt; Symbol</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new symbol (also called label) at the given address.</span>

<span class="sd">        :param address: the address where to create the symbol.</span>
<span class="sd">        :param name: the name of the symbol.</span>
<span class="sd">        :param source: the source type for the new symbol.&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">createLabel</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (Addr, str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the symbol with the given name at the given address.</span>

<span class="sd">        :param address: the address of the symbol to remove.</span>
<span class="sd">        :param name: the name of the symbol to remove.&quot;&quot;&quot;</span>
        <span class="n">removeSymbol</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the address of this symbol.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_external</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Symbol</span><span class="o">.</span><span class="n">resolve_external</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of this symbol.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name_with_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the fully qualified name of this symbol.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Reference]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of references to this symbol.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Reference</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getReferences</span><span class="p">()]</span>

    <span class="n">xrefs_to</span> <span class="o">=</span> <span class="n">xrefs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xref_addrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[int]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the addresses of all references to this symbol.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">xref</span><span class="o">.</span><span class="n">from_address</span> <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>  <span class="c1"># type: (DataT) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the data type of this symbol.&quot;&quot;&quot;</span>
        <span class="n">Program</span><span class="o">.</span><span class="n">create_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete this symbol.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename this symbol.</span>

<span class="sd">            &gt;&gt;&gt; main = Symbol.get(&quot;main&quot;)</span>
<span class="sd">            &gt;&gt;&gt; main.rename(&quot;main_renamed&quot;)</span>
<span class="sd">            &gt;&gt;&gt; main.name</span>
<span class="sd">            &#39;main_renamed&#39;</span>

<span class="sd">        :param new_name: the new name of the symbol.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_external</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return true if this symbol is external, otherwise false.</span>

<span class="sd">        Note: when resolving by name, local symbols take precedence over external ones</span>
<span class="sd">        (in particular for function thunks - in contrast to Ghidra default behaviour).</span>

<span class="sd">        :return: true if the symbol is external&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isExternal</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the address of this symbol.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.is_external" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_external</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return true if this symbol is external, otherwise false.</p>
<p>Note: when resolving by name, local symbols take precedence over external ones
(in particular for function thunks - in contrast to Ghidra default behaviour).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>true if the symbol is external</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of this symbol.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.name_with_namespace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name_with_namespace</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the fully qualified name of this symbol.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.xref_addrs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xref_addrs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the addresses of all references to this symbol.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.xrefs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of references to this symbol.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Symbol.xrefs_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xrefs_to</span> <span class="o">=</span> <span class="n">xrefs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.all" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">all</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all symbols defined in the program.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">():</span>  <span class="c1"># type: () -&gt; list[Symbol]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all symbols defined in the program.&quot;&quot;&quot;</span>
    <span class="n">symbol_iterator</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getAllSymbols</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="n">symbol_iterator</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new symbol (also called label) at the given address.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address where to create the symbol.</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
              –
              <div class="doc-md-description">
                <p>the name of the symbol.</p>
              </div>
            </li>
            <li>
              <b><code>source</code></b>
              –
              <div class="doc-md-description">
                <p>the source type for the new symbol.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
    <span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, str, SourceType) -&gt; Symbol</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new symbol (also called label) at the given address.</span>

<span class="sd">    :param address: the address where to create the symbol.</span>
<span class="sd">    :param name: the name of the symbol.</span>
<span class="sd">    :param source: the source type for the new symbol.&quot;&quot;&quot;</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">createLabel</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.delete" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete this symbol.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete this symbol.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a symbol with the provided name or at the provided address.</p>
<p>Return None if the symbol was not found.</p>
<p>Note: when resolving by name, local symbols take precedence over external ones
(in particular for function thunks - in contrast to Ghidra default behaviour).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>raw_or_name</code></b>
              –
              <div class="doc-md-description">
                <p>a Ghidra Java object, a string, or an address.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|str|Addr) -&gt; Symbol|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a symbol with the provided name or at the provided address.</span>

<span class="sd">    Return None if the symbol was not found.</span>

<span class="sd">    Note: when resolving by name, local symbols take precedence over external ones</span>
<span class="sd">    (in particular for function thunks - in contrast to Ghidra default behaviour).</span>

<span class="sd">    :param raw_or_name: a Ghidra Java object, a string, or an address.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">symbol_iterator</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbols</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">)</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="n">collect_iterator</span><span class="p">(</span><span class="n">symbol_iterator</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">raw</span><span class="o">.</span><span class="n">isExternal</span><span class="p">():</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">Symbol</span><span class="o">.</span><span class="n">resolve_thunk_if_exists</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">can_resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
            <span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">getPrimarySymbol</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">raw_or_name</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">raw</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">raw_or_name</span>
    <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the symbol with the given name at the given address.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address of the symbol to remove.</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
              –
              <div class="doc-md-description">
                <p>the name of the symbol to remove.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (Addr, str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove the symbol with the given name at the given address.</span>

<span class="sd">    :param address: the address of the symbol to remove.</span>
<span class="sd">    :param name: the name of the symbol to remove.&quot;&quot;&quot;</span>
    <span class="n">removeSymbol</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename this symbol.</p>
<pre><code>&gt;&gt;&gt; main = Symbol.get("main")
&gt;&gt;&gt; main.rename("main_renamed")
&gt;&gt;&gt; main.name
'main_renamed'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_name</code></b>
              –
              <div class="doc-md-description">
                <p>the new name of the symbol.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
<span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename this symbol.</span>

<span class="sd">        &gt;&gt;&gt; main = Symbol.get(&quot;main&quot;)</span>
<span class="sd">        &gt;&gt;&gt; main.rename(&quot;main_renamed&quot;)</span>
<span class="sd">        &gt;&gt;&gt; main.name</span>
<span class="sd">        &#39;main_renamed&#39;</span>

<span class="sd">    :param new_name: the new name of the symbol.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.resolve_external" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_external</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Resolves an external address to a RAM location, if possible.</p>
<p>If the symbol has no RAM location, just return its offset.</p>
<p>Why is this ugly thing here? Again, we want to support external symbols, and
we are interested in their RAM address in the program address space. In some
cases, Ghidra will give an external address a "location" in the RAM space.
So, for example, if current program jumps to that external function (or read
that external variable etc), it will read that location as far as Ghidra is
concerned (for example, Emulator will use it for calls). This is important
for emulating Windows binaries, that use address tables for imports.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>external_symbol</code></b>
              –
              <div class="doc-md-description">
                <p>External symbol to resolve.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">resolve_external</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves an external address to a RAM location, if possible.</span>

<span class="sd">    If the symbol has no RAM location, just return its offset.</span>

<span class="sd">    Why is this ugly thing here? Again, we want to support external symbols, and</span>
<span class="sd">    we are interested in their RAM address in the program address space. In some</span>
<span class="sd">    cases, Ghidra will give an external address a &quot;location&quot; in the RAM space.</span>
<span class="sd">    So, for example, if current program jumps to that external function (or read</span>
<span class="sd">    that external variable etc), it will read that location as far as Ghidra is</span>
<span class="sd">    concerned (for example, Emulator will use it for calls). This is important</span>
<span class="sd">    for emulating Windows binaries, that use address tables for imports.</span>

<span class="sd">    :param external_symbol: External symbol to resolve.&quot;&quot;&quot;</span>
    <span class="n">external_manager</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getExternalManager</span><span class="p">()</span>
    <span class="n">ram_addr</span> <span class="o">=</span> <span class="n">external_manager</span><span class="o">.</span><span class="n">getExternalLocation</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">)</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ram_addr</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ram_addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">external_symbol</span><span class="o">.</span><span class="n">getAddress</span><span class="p">()</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.resolve_thunk_if_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_thunk_if_exists</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a function thunk leading to a passed external symbol, if it exists.</p>
<p>If there is no function thunk, original symbol is returned.</p>
<p>Why is this ugly thing here? Well, we want to support external symbols,
especially external functions. Thunks are much more useful for us when
thinking in context of the analysed program - when Linux program calls
<code>printf</code> it jumps to the appropriate <code>printf</code> thunk, not to libc
directly. So this is the location that we want to patch/hook/trace/etc when
thinking about printf. But the thing is that Ghidra SymbolTable API will
not even return thunks! So we trace the external function references, and
return the first (almost certainly only) Thunk reference.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>external_symbol</code></b>
              –
              <div class="doc-md-description">
                <p>Symbol to find thunk for (if it exists).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">resolve_thunk_if_exists</span><span class="p">(</span><span class="n">external_symbol</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; JavaObject</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a function thunk leading to a passed external symbol, if it exists.</span>

<span class="sd">    If there is no function thunk, original symbol is returned.</span>

<span class="sd">    Why is this ugly thing here? Well, we want to support external symbols,</span>
<span class="sd">    especially external functions. Thunks are much more useful for us when</span>
<span class="sd">    thinking in context of the analysed program - when Linux program calls</span>
<span class="sd">    `printf` it jumps to the appropriate `printf` thunk, not to libc</span>
<span class="sd">    directly. So this is the location that we want to patch/hook/trace/etc when</span>
<span class="sd">    thinking about printf. But the thing is that Ghidra SymbolTable API will</span>
<span class="sd">    not even return thunks! So we trace the external function references, and</span>
<span class="sd">    return the first (almost certainly only) Thunk reference.</span>

<span class="sd">    :param external_symbol: Symbol to find thunk for (if it exists).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xrefs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">external_symbol</span><span class="o">.</span><span class="n">getReferences</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="n">xrefs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xref</span><span class="o">.</span><span class="n">getReferenceType</span><span class="p">()</span> <span class="o">==</span> <span class="n">GhRefType</span><span class="o">.</span><span class="n">THUNK</span><span class="p">:</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">getFromAddress</span><span class="p">()</span>
            <span class="n">thunk</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getSymbolTable</span><span class="p">()</span><span class="o">.</span><span class="n">getPrimarySymbol</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thunk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">thunk</span>
    <span class="k">return</span> <span class="n">external_symbol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Symbol.set_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_type</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the data type of this symbol.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>  <span class="c1"># type: (DataT) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the data type of this symbol.&quot;&quot;&quot;</span>
    <span class="n">Program</span><span class="o">.</span><span class="n">create_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.SymbolicPropogator" class="doc doc-heading">
            <code>SymbolicPropogator</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps SymbolicPropogator. Can be used to get known values at various
locations in a given function (or outside of a function)</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SymbolicPropogator</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps SymbolicPropogator. Can be used to get known values at various</span>
<span class="sd">    locations in a given function (or outside of a function)&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">SymbolicPropogator</span><span class="p">(</span><span class="n">GhSymbolicPropogator</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">flow_constants</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">evaluator</span>
    <span class="p">):</span>  <span class="c1"># type: (Addr, AddressSet, JavaObject) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flow constants from the given address in the given body</span>

<span class="sd">        :param addr: The address to start from</span>
<span class="sd">        :param body: The body where constants should be propagated</span>
<span class="sd">        :param evaluator: The evaluator to use for the propagation&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">flowConstants</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">body</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">register_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">register</span><span class="p">):</span>  <span class="c1"># type: (Addr, Reg) -&gt; int|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a known register value at the given address (or None)</span>

<span class="sd">        Warning: this value is signed.</span>

<span class="sd">        :param addr: The address to get a register value at</span>
<span class="sd">        :param register: The register to get a value for</span>
<span class="sd">        :return: The value of the register at the given address, or None if the</span>
<span class="sd">        register is not known at that address&quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRegisterValue</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">isRegisterRelativeValue</span><span class="p">():</span>
            <span class="c1"># This never happens in my tests, so I just won&#39;t handle register-relative</span>
            <span class="c1"># values. I don&#39;t know when this can ever happen.</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ghidralib.SymbolicPropogator.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">SymbolicPropogator</span><span class="p">(</span><span class="n">GhSymbolicPropogator</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.SymbolicPropogator.flow_constants" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flow_constants</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Flow constants from the given address in the given body</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>The address to start from</p>
              </div>
            </li>
            <li>
              <b><code>body</code></b>
              –
              <div class="doc-md-description">
                <p>The body where constants should be propagated</p>
              </div>
            </li>
            <li>
              <b><code>evaluator</code></b>
              –
              <div class="doc-md-description">
                <p>The evaluator to use for the propagation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flow_constants</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">evaluator</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, AddressSet, JavaObject) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flow constants from the given address in the given body</span>

<span class="sd">    :param addr: The address to start from</span>
<span class="sd">    :param body: The body where constants should be propagated</span>
<span class="sd">    :param evaluator: The evaluator to use for the propagation&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">flowConstants</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">body</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.SymbolicPropogator.register_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_at</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">register</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a known register value at the given address (or None)</p>
<p>Warning: this value is signed.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>The address to get a register value at</p>
              </div>
            </li>
            <li>
              <b><code>register</code></b>
              –
              <div class="doc-md-description">
                <p>The register to get a value for</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The value of the register at the given address, or None if the register is not known at that address</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">register</span><span class="p">):</span>  <span class="c1"># type: (Addr, Reg) -&gt; int|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a known register value at the given address (or None)</span>

<span class="sd">    Warning: this value is signed.</span>

<span class="sd">    :param addr: The address to get a register value at</span>
<span class="sd">    :param register: The register to get a value for</span>
<span class="sd">    :return: The value of the register at the given address, or None if the</span>
<span class="sd">    register is not known at that address&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRegisterValue</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">isRegisterRelativeValue</span><span class="p">():</span>
        <span class="c1"># This never happens in my tests, so I just won&#39;t handle register-relative</span>
        <span class="c1"># values. I don&#39;t know when this can ever happen.</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Variable" class="doc doc-heading">
            <code>Variable</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>


        <p>Wraps a Ghidra Variable object</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Variable</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a Ghidra Variable object&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename this variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename this variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; DataType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the data type of this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDataType</span><span class="p">())</span>

    <span class="nd">@data_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
    <span class="p">):</span>  <span class="c1"># type: (DataType, SourceType) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the data type of this variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setDataType</span><span class="p">(</span><span class="n">data_type</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is valid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;Get the comment for this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getComment</span><span class="p">()</span>

    <span class="nd">@comment</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the comment for this variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_comment</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the comment for this variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_auto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is an automatic parameter.</span>

<span class="sd">        Some parameters are &quot;hidden parameters&quot; dictated by the calling</span>
<span class="sd">        convention. This method returns true for such paramteters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isAutoStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_forced_indirect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable was forced to be a pointer by calling convention&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isForcedIndirect</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_bad_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable has bad storage (could not be resolved)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isBadStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unassigned_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable has no assigned storage (varnodes)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isUnassignedStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_void</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is of type void&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isVoidStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stack_offfset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the stack offset of this variable.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">getStackOffset</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable consists of a single constant-space varnode&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isConstantStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable consists of a single hash-space varnode.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span><span class="o">.</span><span class="n">isHashStorage</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is a stack variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isStackVariable</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is stored in memory&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isMemoryVariable</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is of type unique&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isUniqueVariable</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_compound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable is a compound variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isCompoundVariable</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Symbol</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the symbol for this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Symbol</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; SourceType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the source type of this variable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SourceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSource</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Varnode</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first varnode associated with this variable.</span>

<span class="sd">        Warning: there may be more than one varnode associated with a variable.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Varnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFirstStorageVarnode</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">varnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[Varnode]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all varnodes associated with this variable.&quot;&quot;&quot;</span>
        <span class="n">storage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getVariableStorage</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Varnode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">storage</span><span class="o">.</span><span class="n">getVarnodes</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this variable consists of a single register.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isRegisterVariable</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the register associated with this variable.</span>

<span class="sd">        Raises an exception if this variable is not a register variable.&quot;&quot;&quot;</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getRegister</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Variable is not a register variable&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reg</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the function associated with this variable.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getFunction</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>"Get the comment for this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.data_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the data type of this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">function</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the function associated with this variable.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.has_bad_storage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_bad_storage</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable has bad storage (could not be resolved)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_auto" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_auto</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is an automatic parameter.</p>
<p>Some parameters are "hidden parameters" dictated by the calling
convention. This method returns true for such paramteters.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_compound" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_compound</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is a compound variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_constant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_constant</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable consists of a single constant-space varnode</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_forced_indirect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_forced_indirect</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable was forced to be a pointer by calling convention</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_hash</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable consists of a single hash-space varnode.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_memory</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is stored in memory</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable consists of a single register.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_stack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_stack</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is a stack variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_unassigned_storage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unassigned_storage</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable has no assigned storage (varnodes)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_unique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unique</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is of type unique</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_valid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_valid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is valid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.is_void" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_void</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this variable is of type void</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the register associated with this variable.</p>
<p>Raises an exception if this variable is not a register variable.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.source" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the source type of this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.stack_offfset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stack_offfset</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the stack offset of this variable.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.symbol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the symbol for this variable</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.varnode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnode</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the first varnode associated with this variable.</p>
<p>Warning: there may be more than one varnode associated with a variable.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Variable.varnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">varnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all varnodes associated with this variable.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Variable.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename this variable</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SourceType</span><span class="o">.</span><span class="n">USER_DEFINED</span>
<span class="p">):</span>  <span class="c1"># type: (str, SourceType) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename this variable&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Variable.set_comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the comment for this variable</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>  <span class="c1"># type: (str|None) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the comment for this variable&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">setComment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.Varnode" class="doc doc-heading">
            <code>Varnode</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ghidralib.GhidraWrapper" href="#ghidralib.GhidraWrapper">GhidraWrapper</a></code></p>







              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Varnode</span><span class="p">(</span><span class="n">GhidraWrapper</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return true if this varnode can be converted to a integer value.</span>

<span class="sd">        In particular, this will return true for Address and Constant varnodes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value of this varnode. Traverse defining pcodeops if necessary.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_address</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constant</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defining_pcodeop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">defining_pcodeop</span><span class="o">.</span><span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getOffset</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; HighVariable</span>
        <span class="k">return</span> <span class="n">HighVariable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getHigh</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; HighSymbol</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">high</span><span class="o">.</span><span class="n">symbol</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Note: addresses are not constants in Ghidra-speak.</span>
<span class="sd">        Use has_value to check if the varnode has a predictable value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isConstant</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this varnode is stored entirely in a register.</span>

<span class="sd">        Warning: this does not mean that it can be cast to a register! This may</span>
<span class="sd">        be, for example, upper 32 bits of RAX. Use is_named_register instead.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isRegister</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_named_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;Return True if this varnode is stored entirely in a named register.</span>

<span class="sd">        &quot;Named&quot; in this context means that it has a conventional name, like RAX.</span>
<span class="sd">        Not all register varnodes are named, for example, the upper 32 bits of RAX</span>
<span class="sd">        have no commonly used name.&quot;&quot;&quot;</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">raw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">as_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of the register this varnode is stored in.</span>

<span class="sd">        Warning: even if is_register returns true, this does not mean you can use</span>
<span class="sd">        this method safely. Use is_named_register to make sure.&quot;&quot;&quot;</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getLanguage</span><span class="p">()</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">language</span><span class="o">.</span><span class="n">getRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">raw</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isAddress</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isUnique</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isHash</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="n">spaceid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSpace</span><span class="p">()</span>
        <span class="n">spacetype</span> <span class="o">=</span> <span class="n">AddressSpace</span><span class="o">.</span><span class="n">ID_TYPE_MASK</span> <span class="o">&amp;</span> <span class="n">spaceid</span>
        <span class="k">return</span> <span class="n">spacetype</span> <span class="o">==</span> <span class="n">AddressSpace</span><span class="o">.</span><span class="n">TYPE_STACK</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to rename the current varnode. This only makes sense for variables.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; Varnode</span>
        <span class="k">return</span> <span class="n">Varnode</span><span class="p">(</span><span class="n">GhVarnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getAddress</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getSize</span><span class="p">()))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; int|str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert Varnode to a primitive value (int or a string representation)</span>

<span class="sd">        More specifically, this will convert constants and addresses into integers,</span>
<span class="sd">        for registers names are returned, and for unique and hash varnodes ad-hoc</span>
<span class="sd">        string encoding is used (hash:ID or uniq:ID where ID is varnode identifier).</span>

<span class="sd">        This is useful for simple analyses when programmer already knows what</span>
<span class="sd">        type of value is expected at the given position.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_register</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_named_register</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_register</span>
            <span class="k">return</span> <span class="s2">&quot;reg:</span><span class="si">{:x}</span><span class="s2">:</span><span class="si">{:x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;uniq:</span><span class="si">{:x}</span><span class="s2">:</span><span class="si">{:x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hash</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;hash:</span><span class="si">{:x}</span><span class="s2">:</span><span class="si">{:x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_stack</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;stack:</span><span class="si">{:x}</span><span class="s2">:</span><span class="si">{:x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown varnode type&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unaffected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isUnaffected</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_persistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isPersistent</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_addr_tied</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isAddrTied</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isInput</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; bool</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">isFree</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defining_pcodeop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; PcodeOp|None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a PcodeOp that defined this varnode&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDef</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">PcodeOp</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of all descendants of this varnode&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDescendants</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">PcodeOp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getDescendants</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (Varnode) -&gt; list[PcodeOp]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return true if this varnode intersects other&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.as_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the name of the register this varnode is stored in.</p>
<p>Warning: even if is_register returns true, this does not mean you can use
this method safely. Use is_named_register to make sure.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.defining_pcodeop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">defining_pcodeop</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return a PcodeOp that defined this varnode</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.descendants" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">descendants</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return a list of all descendants of this varnode</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.free" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">free</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.has_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return true if this varnode can be converted to a integer value.</p>
<p>In particular, this will return true for Address and Constant varnodes</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.high" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">high</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_addr_tied" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_addr_tied</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_address" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_constant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_constant</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Note: addresses are not constants in Ghidra-speak.
Use has_value to check if the varnode has a predictable value.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_free" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_free</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_hash</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_input</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_named_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_named_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>"Return True if this varnode is stored entirely in a named register.</p>
<p>"Named" in this context means that it has a conventional name, like RAX.
Not all register varnodes are named, for example, the upper 32 bits of RAX
have no commonly used name.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_persistent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_persistent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_register</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if this varnode is stored entirely in a register.</p>
<p>Warning: this does not mean that it can be cast to a register! This may
be, for example, upper 32 bits of RAX. Use is_named_register instead.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_stack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_stack</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_unaffected" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unaffected</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.is_unique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_unique</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.offset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">offset</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.simple" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">simple</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Convert Varnode to a primitive value (int or a string representation)</p>
<p>More specifically, this will convert constants and addresses into integers,
for registers names are returned, and for unique and hash varnodes ad-hoc
string encoding is used (hash:ID or uniq:ID where ID is varnode identifier).</p>
<p>This is useful for simple analyses when programmer already knows what
type of value is expected at the given position.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.symbol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ghidralib.Varnode.value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the value of this varnode. Traverse defining pcodeops if necessary.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ghidralib.Varnode.intersects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">intersects</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return true if this varnode intersects other</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># type: (Varnode) -&gt; list[PcodeOp]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if this varnode intersects other&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ghidralib.Varnode.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Try to rename the current varnode. This only makes sense for variables.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to rename the current varnode. This only makes sense for variables.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ghidralib.unicode" class="doc doc-heading">
            <code>unicode</code>


</h2>


    <div class="doc doc-contents ">


        <p>A fake stub class, to keep type-checker relatively happy</p>






              <details class="quote">
                <summary>Source code in <code>ghidralib.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">unicode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A fake stub class, to keep type-checker relatively happy&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A fake method, to keep type-checker relatively happy&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method should never be called&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ghidralib.unicode.encode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">encode</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A fake method, to keep type-checker relatively happy</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: () -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A fake method, to keep type-checker relatively happy&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method should never be called&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="ghidralib.assemble" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assemble</span><span class="p">(</span><span class="n">instructions</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Assemble the given instructions and return them as a list of instructions.</p>
<p>Note: Address is important, because instruction meaning may depend on the location.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address where the instructious would be written</p>
              </div>
            </li>
            <li>
              <b><code>instructions</code></b>
              –
              <div class="doc-md-description">
                <p>a list of instructions, or a single instruction to assemble</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the newly assembled instructions</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3918</span>
<span class="normal">3919</span>
<span class="normal">3920</span>
<span class="normal">3921</span>
<span class="normal">3922</span>
<span class="normal">3923</span>
<span class="normal">3924</span>
<span class="normal">3925</span>
<span class="normal">3926</span>
<span class="normal">3927</span>
<span class="normal">3928</span>
<span class="normal">3929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span>
    <span class="n">instructions</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>  <span class="c1"># type: (str|list[str], Addr) -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble the given instructions and return them as a list of instructions.</span>

<span class="sd">    Note: Address is important, because instruction meaning may depend on the location.</span>

<span class="sd">    :param address: the address where the instructious would be written</span>
<span class="sd">    :param instructions: a list of instructions, or a single instruction to assemble</span>
<span class="sd">    :return: the newly assembled instructions&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">assemble_to_bytes</span><span class="p">(</span><span class="n">instructions</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">disassemble_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.assemble_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assemble_at</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">instructions</span><span class="p">,</span> <span class="n">pad_to</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Assemble the given instructions and write them at the given address.</p>
<p>Note: Ghidra is a bit picky, and case-sensitive when it comes to opcodes.
For example, use "MOV EAX, EBX" instead of "mov eax, ebx".</p>
<pre><code>&gt;&gt;&gt; assemble_at(Function("exit").entrypoint, "RET")
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address where to write the instructions</p>
              </div>
            </li>
            <li>
              <b><code>instructions</code></b>
              –
              <div class="doc-md-description">
                <p>a list of instructions, or a single instruction to assemble</p>
              </div>
            </li>
            <li>
              <b><code>pad_to</code></b>
              –
              <div class="doc-md-description">
                <p>optionally, pad the code with NOPs to reach this size</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the newly assembled instructions</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3850</span>
<span class="normal">3851</span>
<span class="normal">3852</span>
<span class="normal">3853</span>
<span class="normal">3854</span>
<span class="normal">3855</span>
<span class="normal">3856</span>
<span class="normal">3857</span>
<span class="normal">3858</span>
<span class="normal">3859</span>
<span class="normal">3860</span>
<span class="normal">3861</span>
<span class="normal">3862</span>
<span class="normal">3863</span>
<span class="normal">3864</span>
<span class="normal">3865</span>
<span class="normal">3866</span>
<span class="normal">3867</span>
<span class="normal">3868</span>
<span class="normal">3869</span>
<span class="normal">3870</span>
<span class="normal">3871</span>
<span class="normal">3872</span>
<span class="normal">3873</span>
<span class="normal">3874</span>
<span class="normal">3875</span>
<span class="normal">3876</span>
<span class="normal">3877</span>
<span class="normal">3878</span>
<span class="normal">3879</span>
<span class="normal">3880</span>
<span class="normal">3881</span>
<span class="normal">3882</span>
<span class="normal">3883</span>
<span class="normal">3884</span>
<span class="normal">3885</span>
<span class="normal">3886</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assemble_at</span><span class="p">(</span>
    <span class="n">address</span><span class="p">,</span> <span class="n">instructions</span><span class="p">,</span> <span class="n">pad_to</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, str|list[str], int) -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble the given instructions and write them at the given address.</span>

<span class="sd">    Note: Ghidra is a bit picky, and case-sensitive when it comes to opcodes.</span>
<span class="sd">    For example, use &quot;MOV EAX, EBX&quot; instead of &quot;mov eax, ebx&quot;.</span>

<span class="sd">        &gt;&gt;&gt; assemble_at(Function(&quot;exit&quot;).entrypoint, &quot;RET&quot;)</span>

<span class="sd">    :param address: the address where to write the instructions</span>
<span class="sd">    :param instructions: a list of instructions, or a single instruction to assemble</span>
<span class="sd">    :param pad_to: optionally, pad the code with NOPs to reach this size</span>
<span class="sd">    :return: the newly assembled instructions&quot;&quot;&quot;</span>
    <span class="c1"># Note: Assembler API is actually quite user-friendly and doesn&#39;t require</span>
    <span class="c1"># wrapping. But let&#39;s wrap it for consistency.</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">asm</span> <span class="o">=</span> <span class="n">Assemblers</span><span class="o">.</span><span class="n">getAssembler</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">Instruction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">asm</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">instructions</span><span class="p">)]</span>

    <span class="c1"># Append NOPs at the end, if length is shorter than pad_to.</span>
    <span class="c1"># This is purely to make the assembled code look nicer.</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">end_addr</span> <span class="o">=</span> <span class="n">last</span><span class="o">.</span><span class="n">address</span> <span class="o">+</span> <span class="n">last</span><span class="o">.</span><span class="n">length</span>
        <span class="n">code_size</span> <span class="o">=</span> <span class="n">end_addr</span> <span class="o">-</span> <span class="n">addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pad_to</span> <span class="o">&gt;</span> <span class="n">code_size</span><span class="p">:</span>
            <span class="n">asm</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">code_size</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;NOP&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pad_to</span> <span class="o">-</span> <span class="n">code_size</span><span class="p">))</span>

    <span class="c1"># Do what Ghidra should do automaticaly, and automatically try to disassemble</span>
    <span class="c1"># jump targets from the newly assembled instructions</span>
    <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="n">instr</span><span class="o">.</span><span class="n">xrefs_from</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xref</span><span class="o">.</span><span class="n">is_call</span> <span class="ow">or</span> <span class="n">xref</span><span class="o">.</span><span class="n">is_jump</span><span class="p">:</span>
                <span class="n">disassemble</span><span class="p">(</span><span class="n">toAddr</span><span class="p">(</span><span class="n">xref</span><span class="o">.</span><span class="n">to_address</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.assemble_to_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assemble_to_bytes</span><span class="p">(</span><span class="n">instructions</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Assemble the given instructions and return them as an array of bytes.</p>
<p>Note: Ghidra is a bit picky, and case-sensitive when it comes to opcodes.
For example, use "MOV EAX, EBX" instead of "mov eax, ebx".</p>
<p>Note: Address is important, because instruction bytes may depend on the location.</p>
<pre><code>&gt;&gt;&gt; assemble_to_bytes("ADD EAX, EAX")
"À"
&gt;&gt;&gt; assemble_to_bytes(["ADD EAX, EAX", "ADD EAX, EAX"])
"ÀÀ"
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address to use as a base for instructions</p>
              </div>
            </li>
            <li>
              <b><code>instructions</code></b>
              –
              <div class="doc-md-description">
                <p>a list of instructions, or a single instruction to assemble</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3889</span>
<span class="normal">3890</span>
<span class="normal">3891</span>
<span class="normal">3892</span>
<span class="normal">3893</span>
<span class="normal">3894</span>
<span class="normal">3895</span>
<span class="normal">3896</span>
<span class="normal">3897</span>
<span class="normal">3898</span>
<span class="normal">3899</span>
<span class="normal">3900</span>
<span class="normal">3901</span>
<span class="normal">3902</span>
<span class="normal">3903</span>
<span class="normal">3904</span>
<span class="normal">3905</span>
<span class="normal">3906</span>
<span class="normal">3907</span>
<span class="normal">3908</span>
<span class="normal">3909</span>
<span class="normal">3910</span>
<span class="normal">3911</span>
<span class="normal">3912</span>
<span class="normal">3913</span>
<span class="normal">3914</span>
<span class="normal">3915</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assemble_to_bytes</span><span class="p">(</span><span class="n">instructions</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>  <span class="c1"># type: (str|list[str], Addr) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble the given instructions and return them as an array of bytes.</span>

<span class="sd">    Note: Ghidra is a bit picky, and case-sensitive when it comes to opcodes.</span>
<span class="sd">    For example, use &quot;MOV EAX, EBX&quot; instead of &quot;mov eax, ebx&quot;.</span>

<span class="sd">    Note: Address is important, because instruction bytes may depend on the location.</span>

<span class="sd">        &gt;&gt;&gt; assemble_to_bytes(&quot;ADD EAX, EAX&quot;)</span>
<span class="sd">        &quot;\x01\xc0&quot;</span>
<span class="sd">        &gt;&gt;&gt; assemble_to_bytes([&quot;ADD EAX, EAX&quot;, &quot;ADD EAX, EAX&quot;])</span>
<span class="sd">        &quot;\x01\xc0\x01\xc0&quot;</span>

<span class="sd">    :param address: the address to use as a base for instructions</span>
<span class="sd">    :param instructions: a list of instructions, or a single instruction to assemble&quot;&quot;&quot;</span>
    <span class="c1"># Note: Assembler API is actually quite user-friendly and doesn&#39;t require</span>
    <span class="c1"># wrapping. But let&#39;s wrap it for consistency.</span>
    <span class="n">addr_obj</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">asm</span> <span class="o">=</span> <span class="n">Assemblers</span><span class="o">.</span><span class="n">getAssembler</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instructions</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span><span class="n">asm</span><span class="o">.</span><span class="n">assembleLine</span><span class="p">(</span><span class="n">addr_obj</span><span class="p">,</span> <span class="n">instructions</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_asbytes</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">instructions</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span>
            <span class="n">asm</span><span class="o">.</span><span class="n">assembleLine</span><span class="p">(</span><span class="n">addr_obj</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)),</span> <span class="n">instr</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.can_resolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check if a passed value address can be resolved.</p>
<p>This is useful for checking if <code>resolve()</code> will succeed.
See <code>resolve</code> documentation for more details.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">can_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a passed value address can be resolved.</span>

<span class="sd">    This is useful for checking if `resolve()` will succeed.</span>
<span class="sd">    See `resolve` documentation for more details.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="p">(</span><span class="n">GenericAddress</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">unicode</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.collect_iterator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collect_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Collect a Java iterator to a Python list.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">collect_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>  <span class="c1"># type: (JavaObject) -&gt; list</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collect a Java iterator to a Python list.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">iterator</span><span class="o">.</span><span class="n">hasNext</span><span class="p">():</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iterator</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.disassemble_at" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">disassemble_at</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">max_instr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_bytes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Disassemble the bytes from the program memory at the given address.</p>
<p>If neither <code>max_bytes</code> nor <code>max_instr</code> are specified, this function will
disassemble one instruction. If at least one of them is specified,
this function will disassemble until one of the conditions occurs.</p>
<pre><code>&gt;&gt;&gt; disassemble_at(0x0403ED0)
[INC ESI]
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>the address where to start disassembling</p>
              </div>
            </li>
            <li>
              <b><code>max_bytes</code></b>
              –
              <div class="doc-md-description">
                <p>maximum number of bytes to disassemble (None for no limit)</p>
              </div>
            </li>
            <li>
              <b><code>max_instr</code></b>
              –
              <div class="doc-md-description">
                <p>maximum number of instructions to disassemble (None for no limit)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>a list of Instruction objects</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span>
<span class="normal">3844</span>
<span class="normal">3845</span>
<span class="normal">3846</span>
<span class="normal">3847</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">disassemble_at</span><span class="p">(</span>
    <span class="n">address</span><span class="p">,</span> <span class="n">max_instr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_bytes</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>  <span class="c1"># type: (Addr, int|None, int|None) -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Disassemble the bytes from the program memory at the given address.</span>

<span class="sd">    If neither `max_bytes` nor `max_instr` are specified, this function will</span>
<span class="sd">    disassemble one instruction. If at least one of them is specified,</span>
<span class="sd">    this function will disassemble until one of the conditions occurs.</span>

<span class="sd">        &gt;&gt;&gt; disassemble_at(0x0403ED0)</span>
<span class="sd">        [INC ESI]</span>

<span class="sd">    :param address: the address where to start disassembling</span>
<span class="sd">    :param max_bytes: maximum number of bytes to disassemble (None for no limit)</span>
<span class="sd">    :param max_instr: maximum number of instructions to disassemble (None for no limit)</span>
<span class="sd">    :return: a list of Instruction objects&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max_instr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_max_instr</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">max_bytes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_bytes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_max_instr</span> <span class="o">=</span> <span class="n">max_instr</span>

    <span class="k">if</span> <span class="n">max_bytes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_block_end</span> <span class="o">=</span> <span class="n">MemoryBlock</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
        <span class="c1"># Hacky and inefficient, but good enough for now (and correct)</span>
        <span class="n">_max_bytes</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">to_block_end</span><span class="p">,</span> <span class="n">_max_instr</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_max_bytes</span> <span class="o">=</span> <span class="n">max_bytes</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_bytes</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">_max_bytes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">disassemble_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">_max_instr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.disassemble_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">disassemble_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_instr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Disassemble the given bytes and return a list of Instructions.</p>
<p>This function will return early if an exception during disassembly occurs.</p>
<pre><code>&gt;&gt;&gt; disassemble_bytes('F')
[INC ESI]
</code></pre>
<p>Note: Address is important, because instruction meaning may depend on the location.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data</code></b>
              –
              <div class="doc-md-description">
                <p>the bytes to disassemble</p>
              </div>
            </li>
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>the (virtual) address of the first instruction</p>
              </div>
            </li>
            <li>
              <b><code>max_instr</code></b>
              –
              <div class="doc-md-description">
                <p>the maximum number of instructions to disassemble, or to disassemble until the end of the data</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>a list of Instruction objects</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">disassemble_bytes</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_instr</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>  <span class="c1"># type: (bytes, Addr, int|None) -&gt; list[Instruction]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Disassemble the given bytes and return a list of Instructions.</span>

<span class="sd">    This function will return early if an exception during disassembly occurs.</span>

<span class="sd">        &gt;&gt;&gt; disassemble_bytes(&#39;F&#39;)</span>
<span class="sd">        [INC ESI]</span>

<span class="sd">    Note: Address is important, because instruction meaning may depend on the location.</span>

<span class="sd">    :param data: the bytes to disassemble</span>
<span class="sd">    :param addr: the (virtual) address of the first instruction</span>
<span class="sd">    :param max_instr: the maximum number of instructions to disassemble, or</span>
<span class="sd">    to disassemble until the end of the data</span>
<span class="sd">    :return: a list of Instruction objects&quot;&quot;&quot;</span>
    <span class="n">dis</span> <span class="o">=</span> <span class="n">PseudoDisassembler</span><span class="p">(</span><span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_instr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_instr</span> <span class="o">=</span> <span class="mi">100000000</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_instr</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span>
            <span class="n">rawinstr</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="n">disassemble</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">offset</span><span class="p">),</span> <span class="n">arr</span><span class="p">)</span>
            <span class="n">instr</span> <span class="o">=</span> <span class="n">Instruction</span><span class="p">(</span><span class="n">rawinstr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">instr</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instr</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">instr</span><span class="o">.</span><span class="n">length</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">instr</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">break</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.enhex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enhex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert raw bytes to a hex string.</p>
<pre><code>&gt;&gt;&gt; enhex([0x01, 0x02])
'0102'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>s</code></b>
              –
              <div class="doc-md-description">
                <p>raw bytes to encode.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4097</span>
<span class="normal">4098</span>
<span class="normal">4099</span>
<span class="normal">4100</span>
<span class="normal">4101</span>
<span class="normal">4102</span>
<span class="normal">4103</span>
<span class="normal">4104</span>
<span class="normal">4105</span>
<span class="normal">4106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enhex</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>  <span class="c1"># type: (bytes | list[int]) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert raw bytes to a hex string.</span>

<span class="sd">        &gt;&gt;&gt; enhex([0x01, 0x02])</span>
<span class="sd">        &#39;0102&#39;</span>

<span class="sd">    :param s: raw bytes to encode.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_enhex</span><span class="p">(</span><span class="n">_asbytes</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_enhex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.findall_pattern" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">findall_pattern</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find all occurrences of a byte pattern in the program.</p>
<pre><code>&gt;&gt;&gt; findall_pattern("01 02 ?? 04")
[0x1000, 0x1004]
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>byte_pattern</code></b>
              –
              <div class="doc-md-description">
                <p>the pattern string.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>iterator over all addresses of all occurrences.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4196</span>
<span class="normal">4197</span>
<span class="normal">4198</span>
<span class="normal">4199</span>
<span class="normal">4200</span>
<span class="normal">4201</span>
<span class="normal">4202</span>
<span class="normal">4203</span>
<span class="normal">4204</span>
<span class="normal">4205</span>
<span class="normal">4206</span>
<span class="normal">4207</span>
<span class="normal">4208</span>
<span class="normal">4209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">findall_pattern</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; Iterator[int]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all occurrences of a byte pattern in the program.</span>

<span class="sd">        &gt;&gt;&gt; findall_pattern(&quot;01 02 ?? 04&quot;)</span>
<span class="sd">        [0x1000, 0x1004]</span>

<span class="sd">    :param byte_pattern: the pattern string.</span>
<span class="sd">    :return: iterator over all addresses of all occurrences.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">findone_pattern</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">addr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">yield</span> <span class="n">addr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.findone_pattern" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">findone_pattern</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find the first occurrence of a byte pattern in the program (or None).</p>
<pre><code>&gt;&gt;&gt; findone_pattern("01 02 ?? 04")
0x1000
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>byte_pattern</code></b>
              –
              <div class="doc-md-description">
                <p>the pattern string.</p>
              </div>
            </li>
            <li>
              <b><code>start</code></b>
              –
              <div class="doc-md-description">
                <p>the address to start searching from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>address of the first occurrence, or None if not found.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4176</span>
<span class="normal">4177</span>
<span class="normal">4178</span>
<span class="normal">4179</span>
<span class="normal">4180</span>
<span class="normal">4181</span>
<span class="normal">4182</span>
<span class="normal">4183</span>
<span class="normal">4184</span>
<span class="normal">4185</span>
<span class="normal">4186</span>
<span class="normal">4187</span>
<span class="normal">4188</span>
<span class="normal">4189</span>
<span class="normal">4190</span>
<span class="normal">4191</span>
<span class="normal">4192</span>
<span class="normal">4193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">findone_pattern</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>  <span class="c1"># type: (str, Addr) -&gt; int|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the first occurrence of a byte pattern in the program (or None).</span>

<span class="sd">        &gt;&gt;&gt; findone_pattern(&quot;01 02 ?? 04&quot;)</span>
<span class="sd">        0x1000</span>

<span class="sd">    :param byte_pattern: the pattern string.</span>
<span class="sd">    :param start: the address to start searching from.</span>
<span class="sd">    :return: address of the first occurrence, or None if not found.&quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="n">_pattern_to_bytes</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">_pattern_to_mask</span><span class="p">(</span><span class="n">byte_pattern</span><span class="p">)</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Program</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">getMemory</span><span class="p">()</span><span class="o">.</span><span class="n">findBytes</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">getMonitor</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">addr</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">addr</span><span class="o">.</span><span class="n">getOffset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.from_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_bytes</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decode a bytes as a little-endian integer.</p>
<pre><code>&gt;&gt;&gt; from_bytes('ab')
25185
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>b</code></b>
              –
              <div class="doc-md-description">
                <p>byte stream to decode.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4044</span>
<span class="normal">4045</span>
<span class="normal">4046</span>
<span class="normal">4047</span>
<span class="normal">4048</span>
<span class="normal">4049</span>
<span class="normal">4050</span>
<span class="normal">4051</span>
<span class="normal">4052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_bytes</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>  <span class="c1"># type: (bytes) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decode a bytes as a little-endian integer.</span>

<span class="sd">        &gt;&gt;&gt; from_bytes(&#39;ab&#39;)</span>
<span class="sd">        25185</span>

<span class="sd">    :param b: byte stream to decode.&quot;&quot;&quot;</span>
    <span class="n">bl</span> <span class="o">=</span> <span class="n">_bytes_as_list</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bl</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.get_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_string</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the string defined at the given address.</p>
<p>This function will return None if the data defined in Ghidra at the
given address is not a string. This function will also return None
if the string at <code>adress</code> was not defined in Ghidra. To read a
null-terminated string from Ghidra memory, use <code>read_cstring</code> instead.</p>
<pre><code>&gt;&gt;&gt; get_string(0x1000)
'Hello, world!'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address where string should be located.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3932</span>
<span class="normal">3933</span>
<span class="normal">3934</span>
<span class="normal">3935</span>
<span class="normal">3936</span>
<span class="normal">3937</span>
<span class="normal">3938</span>
<span class="normal">3939</span>
<span class="normal">3940</span>
<span class="normal">3941</span>
<span class="normal">3942</span>
<span class="normal">3943</span>
<span class="normal">3944</span>
<span class="normal">3945</span>
<span class="normal">3946</span>
<span class="normal">3947</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str|None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the string defined at the given address.</span>

<span class="sd">    This function will return None if the data defined in Ghidra at the</span>
<span class="sd">    given address is not a string. This function will also return None</span>
<span class="sd">    if the string at `adress` was not defined in Ghidra. To read a</span>
<span class="sd">    null-terminated string from Ghidra memory, use `read_cstring` instead.</span>

<span class="sd">        &gt;&gt;&gt; get_string(0x1000)</span>
<span class="sd">        &#39;Hello, world!&#39;</span>

<span class="sd">    :param address: address where string should be located.&quot;&quot;&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">getDataAt</span><span class="p">(</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">string</span> <span class="ow">and</span> <span class="n">string</span><span class="o">.</span><span class="n">hasStringValue</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a byte stream from program at address.</p>
<pre><code>&gt;&gt;&gt; read_bytes(0x1000, 4)
'test'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to read.</p>
              </div>
            </li>
            <li>
              <b><code>length</code></b>
              –
              <div class="doc-md-description">
                <p>number of bytes to read.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4032</span>
<span class="normal">4033</span>
<span class="normal">4034</span>
<span class="normal">4035</span>
<span class="normal">4036</span>
<span class="normal">4037</span>
<span class="normal">4038</span>
<span class="normal">4039</span>
<span class="normal">4040</span>
<span class="normal">4041</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (Addr, int) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a byte stream from program at address.</span>

<span class="sd">        &gt;&gt;&gt; read_bytes(0x1000, 4)</span>
<span class="sd">        &#39;test&#39;</span>

<span class="sd">    :param address: address from which to read.</span>
<span class="sd">    :param length: number of bytes to read.&quot;&quot;&quot;</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_bytes_from_bytelist</span><span class="p">(</span><span class="n">getBytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_cstring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_cstring</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a null-terminated string from Ghidra memory.</p>
<p>This function ignores metadata available to Ghidra and just reads
the bytes until a nullbyte is encountered.</p>
<pre><code>&gt;&gt;&gt; read_cstring(0x1000)
'Hello, world!'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to start reading.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3950</span>
<span class="normal">3951</span>
<span class="normal">3952</span>
<span class="normal">3953</span>
<span class="normal">3954</span>
<span class="normal">3955</span>
<span class="normal">3956</span>
<span class="normal">3957</span>
<span class="normal">3958</span>
<span class="normal">3959</span>
<span class="normal">3960</span>
<span class="normal">3961</span>
<span class="normal">3962</span>
<span class="normal">3963</span>
<span class="normal">3964</span>
<span class="normal">3965</span>
<span class="normal">3966</span>
<span class="normal">3967</span>
<span class="normal">3968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_cstring</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a null-terminated string from Ghidra memory.</span>

<span class="sd">    This function ignores metadata available to Ghidra and just reads</span>
<span class="sd">    the bytes until a nullbyte is encountered.</span>

<span class="sd">        &gt;&gt;&gt; read_cstring(0x1000)</span>
<span class="sd">        &#39;Hello, world!&#39;</span>

<span class="sd">    :param address: address from which to start reading.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">read_u8</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_u16" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u16</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a 16bit integer from program at address.</p>
<pre><code>&gt;&gt;&gt; read_u16(0x1000)
0x0102
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to read.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4002</span>
<span class="normal">4003</span>
<span class="normal">4004</span>
<span class="normal">4005</span>
<span class="normal">4006</span>
<span class="normal">4007</span>
<span class="normal">4008</span>
<span class="normal">4009</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u16</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 16bit integer from program at address.</span>

<span class="sd">        &gt;&gt;&gt; read_u16(0x1000)</span>
<span class="sd">        0x0102</span>

<span class="sd">    :param address: address from which to read.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_u32" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u32</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a 32bit integer from program at address.</p>
<pre><code>&gt;&gt;&gt; read_u32(0x1000)
0x01020304
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to read.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4012</span>
<span class="normal">4013</span>
<span class="normal">4014</span>
<span class="normal">4015</span>
<span class="normal">4016</span>
<span class="normal">4017</span>
<span class="normal">4018</span>
<span class="normal">4019</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u32</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 32bit integer from program at address.</span>

<span class="sd">        &gt;&gt;&gt; read_u32(0x1000)</span>
<span class="sd">        0x01020304</span>

<span class="sd">    :param address: address from which to read.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_u64" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u64</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a 64bit integer from program at address.</p>
<pre><code>&gt;&gt;&gt; read_u32(0x1000)
0x0102030405060708
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to read.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4022</span>
<span class="normal">4023</span>
<span class="normal">4024</span>
<span class="normal">4025</span>
<span class="normal">4026</span>
<span class="normal">4027</span>
<span class="normal">4028</span>
<span class="normal">4029</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u64</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a 64bit integer from program at address.</span>

<span class="sd">        &gt;&gt;&gt; read_u32(0x1000)</span>
<span class="sd">        0x0102030405060708</span>

<span class="sd">    :param address: address from which to read.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_u8" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_u8</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a byte from program at address.</p>
<pre><code>&gt;&gt;&gt; read_u8(0x1000)
0x01
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to read.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3992</span>
<span class="normal">3993</span>
<span class="normal">3994</span>
<span class="normal">3995</span>
<span class="normal">3996</span>
<span class="normal">3997</span>
<span class="normal">3998</span>
<span class="normal">3999</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_u8</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a byte from program at address.</span>

<span class="sd">        &gt;&gt;&gt; read_u8(0x1000)</span>
<span class="sd">        0x01</span>

<span class="sd">    :param address: address from which to read.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">read_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.read_unicode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_unicode</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read a null-terminated utf-16 string from Ghidra memory.</p>
<p>This function ignores metadata available to Ghidra and just reads
the bytes until a null character is encountered.</p>
<pre><code>&gt;&gt;&gt; read_unicode(0x1000)
'Hello, world!'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address from which to start reading.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3971</span>
<span class="normal">3972</span>
<span class="normal">3973</span>
<span class="normal">3974</span>
<span class="normal">3975</span>
<span class="normal">3976</span>
<span class="normal">3977</span>
<span class="normal">3978</span>
<span class="normal">3979</span>
<span class="normal">3980</span>
<span class="normal">3981</span>
<span class="normal">3982</span>
<span class="normal">3983</span>
<span class="normal">3984</span>
<span class="normal">3985</span>
<span class="normal">3986</span>
<span class="normal">3987</span>
<span class="normal">3988</span>
<span class="normal">3989</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_unicode</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a null-terminated utf-16 string from Ghidra memory.</span>

<span class="sd">    This function ignores metadata available to Ghidra and just reads</span>
<span class="sd">    the bytes until a null character is encountered.</span>

<span class="sd">        &gt;&gt;&gt; read_unicode(0x1000)</span>
<span class="sd">        &#39;Hello, world!&#39;</span>

<span class="sd">    :param address: address from which to start reading.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">read_u16</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.resolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert an arbitrary addressable value to a Ghidra Address object.</p>
<p>This library accepts one of three things as addressses:</p>
<ol>
<li>A Ghidra Address object</li>
<li>An integer representing an address</li>
<li>A string representing a symbol name</li>
</ol>
<p>This function is responsible from converting the addressable values (<code>Addr</code>)
to Ghidra addresses (<code>GenericAddress</code>).</p>
<pre><code>&gt;&gt;&gt; resolve(0x1234)
0x1234
&gt;&gt;&gt; resolve(Symbol("main"))
0x1234
&gt;&gt;&gt; resolve(toAddr(0x1234))
0x1234
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>An addressable value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>A GenericAddress object representing the passed address.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; GenericAddress</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an arbitrary addressable value to a Ghidra Address object.</span>

<span class="sd">    This library accepts one of three things as addressses:</span>

<span class="sd">    1. A Ghidra Address object</span>
<span class="sd">    2. An integer representing an address</span>
<span class="sd">    3. A string representing a symbol name</span>

<span class="sd">    This function is responsible from converting the addressable values (`Addr`)</span>
<span class="sd">    to Ghidra addresses (`GenericAddress`).</span>

<span class="sd">        &gt;&gt;&gt; resolve(0x1234)</span>
<span class="sd">        0x1234</span>
<span class="sd">        &gt;&gt;&gt; resolve(Symbol(&quot;main&quot;))</span>
<span class="sd">        0x1234</span>
<span class="sd">        &gt;&gt;&gt; resolve(toAddr(0x1234))</span>
<span class="sd">        0x1234</span>

<span class="sd">    :param addr: An addressable value.</span>
<span class="sd">    :return: A GenericAddress object representing the passed address.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">unicode</span><span class="p">):</span>  <span class="c1"># Why, Ghidra?</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">GenericAddress</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">addr</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">)):</span>
        <span class="c1"># Why convert to string? Java cannot handle large (unsigned) integers :/</span>
        <span class="k">return</span> <span class="n">toAddr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">toAddr</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Address must be a ghidra Address, int, or str&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.to_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Encode an integer as a little-endian byte stream.</p>
<pre><code>&gt;&gt;&gt; to_bytes(0x0102, 2)
'\x01\x02'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>value</code></b>
              –
              <div class="doc-md-description">
                <p>integer to encode.</p>
              </div>
            </li>
            <li>
              <b><code>length</code></b>
              –
              <div class="doc-md-description">
                <p>number of bytes of the result.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4055</span>
<span class="normal">4056</span>
<span class="normal">4057</span>
<span class="normal">4058</span>
<span class="normal">4059</span>
<span class="normal">4060</span>
<span class="normal">4061</span>
<span class="normal">4062</span>
<span class="normal">4063</span>
<span class="normal">4064</span>
<span class="normal">4065</span>
<span class="normal">4066</span>
<span class="normal">4067</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>  <span class="c1"># type: (int, int) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encode an integer as a little-endian byte stream.</span>

<span class="sd">        &gt;&gt;&gt; to_bytes(0x0102, 2)</span>
<span class="sd">        &#39;\\x01\\x02&#39;</span>

<span class="sd">    :param value: integer to encode.</span>
<span class="sd">    :param length: number of bytes of the result.&quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">&gt;&gt;=</span> <span class="mi">8</span>
    <span class="k">return</span> <span class="n">_asbytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.try_resolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">try_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert an arbitrary addressable value to a Ghidra Address object.</p>
<p>See <code>resolve</code> documentation for more details.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>addr</code></b>
              –
              <div class="doc-md-description">
                <p>An addressable value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>A GenericAddress representing the value, or None resolving failed.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">try_resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>  <span class="c1"># type: (Addr) -&gt; GenericAddress | None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an arbitrary addressable value to a Ghidra Address object.</span>

<span class="sd">    See `resolve` documentation for more details.</span>

<span class="sd">    :param addr: An addressable value.</span>
<span class="sd">    :return: A GenericAddress representing the value, or None resolving failed.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.unhex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unhex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decode a hex string.</p>
<pre><code>&gt;&gt;&gt; unhex("01 02")
'0102'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>s</code></b>
              –
              <div class="doc-md-description">
                <p>hex string to decode.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4087</span>
<span class="normal">4088</span>
<span class="normal">4089</span>
<span class="normal">4090</span>
<span class="normal">4091</span>
<span class="normal">4092</span>
<span class="normal">4093</span>
<span class="normal">4094</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unhex</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>  <span class="c1"># type: (str) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decode a hex string.</span>

<span class="sd">        &gt;&gt;&gt; unhex(&quot;01 02&quot;)</span>
<span class="sd">        &#39;0102&#39;</span>

<span class="sd">    :param s: hex string to decode.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_unhex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.unwrap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unwrap</span><span class="p">(</span><span class="n">wrapper_or_java_type</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>If the argument is a GhidraWrapper, return the underlying Java object.</p>

            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unwrap</span><span class="p">(</span><span class="n">wrapper_or_java_type</span><span class="p">):</span>  <span class="c1"># type: (JavaObject|GhidraWrapper) -&gt; JavaObject</span>
    <span class="s2">&quot;If the argument is a GhidraWrapper, return the underlying Java object.&quot;</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wrapper_or_java_type</span><span class="p">,</span> <span class="n">GhidraWrapper</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">wrapper_or_java_type</span><span class="o">.</span><span class="n">raw</span>
    <span class="k">return</span> <span class="n">wrapper_or_java_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.write_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Write the provided bytes at a given address.</p>
<pre><code>&gt;&gt;&gt; write_bytes(0x1000, "test)
&gt;&gt;&gt; read_bytes(0x1000, 4)
'test'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>address</code></b>
              –
              <div class="doc-md-description">
                <p>address where bytes should be written.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
              –
              <div class="doc-md-description">
                <p>bytes to write.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4070</span>
<span class="normal">4071</span>
<span class="normal">4072</span>
<span class="normal">4073</span>
<span class="normal">4074</span>
<span class="normal">4075</span>
<span class="normal">4076</span>
<span class="normal">4077</span>
<span class="normal">4078</span>
<span class="normal">4079</span>
<span class="normal">4080</span>
<span class="normal">4081</span>
<span class="normal">4082</span>
<span class="normal">4083</span>
<span class="normal">4084</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>  <span class="c1"># type: (Addr, bytes) -&gt; None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write the provided bytes at a given address.</span>

<span class="sd">        &gt;&gt;&gt; write_bytes(0x1000, &quot;test)</span>
<span class="sd">        &gt;&gt;&gt; read_bytes(0x1000, 4)</span>
<span class="sd">        &#39;test&#39;</span>

<span class="sd">    :param address: address where bytes should be written.</span>
<span class="sd">    :param data: bytes to write.&quot;&quot;&quot;</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">setBytes</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">clearListing</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">addr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">setBytes</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ghidralib.xor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>XOR two bytestrings together.</p>
<p>If two bytestrings are not the same length, the result will be
truncated to the length of the shorter string.</p>
<pre><code>&gt;&gt;&gt; xor("\x01\x02", "\x03\x04")
'\x02\x06'
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>a</code></b>
              –
              <div class="doc-md-description">
                <p>the first bytestring.</p>
              </div>
            </li>
            <li>
              <b><code>b</code></b>
              –
              <div class="doc-md-description">
                <p>the second bytestring.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ghidralib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4109</span>
<span class="normal">4110</span>
<span class="normal">4111</span>
<span class="normal">4112</span>
<span class="normal">4113</span>
<span class="normal">4114</span>
<span class="normal">4115</span>
<span class="normal">4116</span>
<span class="normal">4117</span>
<span class="normal">4118</span>
<span class="normal">4119</span>
<span class="normal">4120</span>
<span class="normal">4121</span>
<span class="normal">4122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>  <span class="c1"># type: (bytes, bytes) -&gt; bytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;XOR two bytestrings together.</span>

<span class="sd">    If two bytestrings are not the same length, the result will be</span>
<span class="sd">    truncated to the length of the shorter string.</span>

<span class="sd">        &gt;&gt;&gt; xor(&quot;\\x01\\x02&quot;, &quot;\\x03\\x04&quot;)</span>
<span class="sd">        &#39;\\x02\\x06&#39;</span>

<span class="sd">    :param a: the first bytestring.</span>
<span class="sd">    :param b: the second bytestring.&quot;&quot;&quot;</span>
    <span class="n">al</span> <span class="o">=</span> <span class="n">_bytes_as_list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">bl</span> <span class="o">=</span> <span class="n">_bytes_as_list</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_asbytes</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">al</span><span class="p">,</span> <span class="n">bl</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting_started/" class="btn btn-neutral float-left" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../getting_started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
